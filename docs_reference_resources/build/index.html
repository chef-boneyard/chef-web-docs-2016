

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Resources and Providers Reference &mdash; Resources and Providers Reference</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Resources and Providers Reference" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">Resources and Providers Reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="#">
              <img class="logo" src="_static/opscode_html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Resources and Providers Reference</a><ul>
<li><a class="reference internal" href="#common-functionality-for-all-resources">Common Functionality for all Resources</a><ul>
<li><a class="reference internal" href="#actions">Actions</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#attributes">Attributes</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conditional-execution">Conditional Execution</a><ul>
<li><a class="reference internal" href="#id2">Attributes</a></li>
<li><a class="reference internal" href="#arguments">Arguments</a></li>
<li><a class="reference internal" href="#not-if-examples"><tt class="docutils literal"><span class="pre">not_if</span></tt> Examples</a></li>
<li><a class="reference internal" href="#only-if-examples"><tt class="docutils literal"><span class="pre">only_if</span></tt> Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notifications">Notifications</a><ul>
<li><a class="reference internal" href="#notifications-timers">Notifications Timers</a></li>
<li><a class="reference internal" href="#notifies-syntax">Notifies Syntax</a><ul>
<li><a class="reference internal" href="#id3">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#subscribes-syntax">Subscribes Syntax</a><ul>
<li><a class="reference internal" href="#id4">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#relative-paths">Relative Paths</a><ul>
<li><a class="reference internal" href="#id5">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#resources">Resources</a><ul>
<li><a class="reference internal" href="#cookbook-file">cookbook_file</a><ul>
<li><a class="reference internal" href="#id6">Actions</a></li>
<li><a class="reference internal" href="#id7">Attributes</a></li>
<li><a class="reference internal" href="#providers">Providers</a></li>
<li><a class="reference internal" href="#id8">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cron">cron</a><ul>
<li><a class="reference internal" href="#id9">Actions</a></li>
<li><a class="reference internal" href="#id10">Attributes</a></li>
<li><a class="reference internal" href="#id11">Providers</a></li>
<li><a class="reference internal" href="#id12">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deploy">deploy</a><ul>
<li><a class="reference internal" href="#deployment-strategies">Deployment Strategies</a><ul>
<li><a class="reference internal" href="#deployment-phases">Deployment Phases</a></li>
<li><a class="reference internal" href="#callbacks">Callbacks</a></li>
<li><a class="reference internal" href="#custom-application-layouts">Custom Application Layouts</a></li>
<li><a class="reference internal" href="#starting-over">Starting Over</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13">Actions</a></li>
<li><a class="reference internal" href="#id14">Attributes</a></li>
<li><a class="reference internal" href="#id15">Providers</a><ul>
<li><a class="reference internal" href="#timestamped-deploy"><tt class="docutils literal"><span class="pre">timestamped_deploy</span></tt></a></li>
<li><a class="reference internal" href="#deploy-revision-and-deploy-branch"><tt class="docutils literal"><span class="pre">deploy_revision</span></tt> and <tt class="docutils literal"><span class="pre">deploy_branch</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id16">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#directory">directory</a><ul>
<li><a class="reference internal" href="#id17">Actions</a></li>
<li><a class="reference internal" href="#id18">Attributes</a></li>
<li><a class="reference internal" href="#id19">Providers</a></li>
<li><a class="reference internal" href="#id20">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#env">env</a><ul>
<li><a class="reference internal" href="#id21">Actions</a></li>
<li><a class="reference internal" href="#id22">Attributes</a></li>
<li><a class="reference internal" href="#id23">Providers</a></li>
<li><a class="reference internal" href="#id24">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#erlang-call">erlang_call</a><ul>
<li><a class="reference internal" href="#id25">Actions</a></li>
<li><a class="reference internal" href="#id26">Attributes</a></li>
<li><a class="reference internal" href="#id27">Providers</a></li>
<li><a class="reference internal" href="#id28">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#execute">execute</a><ul>
<li><a class="reference internal" href="#id29">Actions</a></li>
<li><a class="reference internal" href="#id30">Attributes</a></li>
<li><a class="reference internal" href="#id31">Providers</a></li>
<li><a class="reference internal" href="#id32">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#file">file</a><ul>
<li><a class="reference internal" href="#id33">Actions</a></li>
<li><a class="reference internal" href="#id34">Attributes</a></li>
<li><a class="reference internal" href="#id35">Providers</a></li>
<li><a class="reference internal" href="#id36">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#group">group</a><ul>
<li><a class="reference internal" href="#id37">Actions</a></li>
<li><a class="reference internal" href="#id38">Attributes</a></li>
<li><a class="reference internal" href="#id39">Providers</a></li>
<li><a class="reference internal" href="#id40">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-request">http_request</a><ul>
<li><a class="reference internal" href="#id41">Actions</a></li>
<li><a class="reference internal" href="#id42">Attributes</a></li>
<li><a class="reference internal" href="#id43">Providers</a></li>
<li><a class="reference internal" href="#id44">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ifconfig">ifconfig</a><ul>
<li><a class="reference internal" href="#id45">Actions</a></li>
<li><a class="reference internal" href="#id46">Attributes</a></li>
<li><a class="reference internal" href="#id47">Providers</a></li>
<li><a class="reference internal" href="#id48">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#link">link</a><ul>
<li><a class="reference internal" href="#id49">Actions</a></li>
<li><a class="reference internal" href="#id50">Attributes</a></li>
<li><a class="reference internal" href="#id51">Providers</a></li>
<li><a class="reference internal" href="#id52">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#log">log</a><ul>
<li><a class="reference internal" href="#id53">Actions</a></li>
<li><a class="reference internal" href="#id54">Attributes</a></li>
<li><a class="reference internal" href="#id55">Providers</a></li>
<li><a class="reference internal" href="#id56">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mdadm">mdadm</a><ul>
<li><a class="reference internal" href="#id57">Actions</a></li>
<li><a class="reference internal" href="#id58">Attributes</a></li>
<li><a class="reference internal" href="#id59">Providers</a></li>
<li><a class="reference internal" href="#id60">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mount">mount</a><ul>
<li><a class="reference internal" href="#id61">Actions</a></li>
<li><a class="reference internal" href="#id62">Attributes</a></li>
<li><a class="reference internal" href="#id63">Providers</a></li>
<li><a class="reference internal" href="#id64">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ohai">ohai</a><ul>
<li><a class="reference internal" href="#id65">Actions</a></li>
<li><a class="reference internal" href="#id66">Attributes</a></li>
<li><a class="reference internal" href="#id67">Providers</a></li>
<li><a class="reference internal" href="#id68">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#package">package</a><ul>
<li><a class="reference internal" href="#gem-package-options">Gem Package Options</a><ul>
<li><a class="reference internal" href="#specify-options-with-a-hash">Specify Options with a Hash</a></li>
<li><a class="reference internal" href="#specify-options-with-a-string">Specify Options with a String</a></li>
<li><a class="reference internal" href="#specify-options-with-a-gemrc-file">Specify Options with a .gemrc File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id69">Actions</a></li>
<li><a class="reference internal" href="#id70">Attributes</a></li>
<li><a class="reference internal" href="#id71">Providers</a></li>
<li><a class="reference internal" href="#id72">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#powershell-script">powershell_script</a><ul>
<li><a class="reference internal" href="#id73">Actions</a></li>
<li><a class="reference internal" href="#id74">Attributes</a></li>
<li><a class="reference internal" href="#id75">Providers</a></li>
<li><a class="reference internal" href="#id76">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#remote-directory">remote_directory</a><ul>
<li><a class="reference internal" href="#id77">Actions</a></li>
<li><a class="reference internal" href="#id78">Attributes</a></li>
<li><a class="reference internal" href="#id79">Providers</a></li>
<li><a class="reference internal" href="#id80">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#remote-file">remote_file</a><ul>
<li><a class="reference internal" href="#id81">Actions</a></li>
<li><a class="reference internal" href="#id82">Attributes</a></li>
<li><a class="reference internal" href="#id83">Providers</a></li>
<li><a class="reference internal" href="#id84">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#route">route</a><ul>
<li><a class="reference internal" href="#id85">Actions</a></li>
<li><a class="reference internal" href="#id86">Attributes</a></li>
<li><a class="reference internal" href="#id87">Providers</a></li>
<li><a class="reference internal" href="#id88">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ruby-block">ruby_block</a><ul>
<li><a class="reference internal" href="#id89">Actions</a></li>
<li><a class="reference internal" href="#id90">Attributes</a></li>
<li><a class="reference internal" href="#id91">Providers</a></li>
<li><a class="reference internal" href="#id92">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scm">scm</a><ul>
<li><a class="reference internal" href="#id93">Actions</a></li>
<li><a class="reference internal" href="#id94">Attributes</a></li>
<li><a class="reference internal" href="#id95">Providers</a></li>
<li><a class="reference internal" href="#id96">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#script">script</a><ul>
<li><a class="reference internal" href="#id97">Actions</a></li>
<li><a class="reference internal" href="#id98">Attributes</a></li>
<li><a class="reference internal" href="#id99">Providers</a></li>
<li><a class="reference internal" href="#id100">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#service">service</a><ul>
<li><a class="reference internal" href="#id101">Actions</a></li>
<li><a class="reference internal" href="#id102">Attributes</a></li>
<li><a class="reference internal" href="#id103">Providers</a></li>
<li><a class="reference internal" href="#id104">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#template">template</a><ul>
<li><a class="reference internal" href="#id105">Actions</a></li>
<li><a class="reference internal" href="#id106">Attributes</a></li>
<li><a class="reference internal" href="#id107">Providers</a></li>
<li><a class="reference internal" href="#id108">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user">user</a><ul>
<li><a class="reference internal" href="#id109">Actions</a></li>
<li><a class="reference internal" href="#id110">Attributes</a></li>
<li><a class="reference internal" href="#supported-features">Supported Features</a></li>
<li><a class="reference internal" href="#password-shadow-hash">Password Shadow Hash</a></li>
<li><a class="reference internal" href="#id111">Providers</a></li>
<li><a class="reference internal" href="#id112">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#yum">yum</a><ul>
<li><a class="reference internal" href="#id113">Actions</a></li>
<li><a class="reference internal" href="#id114">Attributes</a></li>
<li><a class="reference internal" href="#id115">Providers</a></li>
<li><a class="reference internal" href="#id116">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#lightweight-resources-and-providers">Lightweight Resources and Providers</a><ul>
<li><a class="reference internal" href="#apt-repository">apt_repository</a><ul>
<li><a class="reference internal" href="#id117">Actions</a></li>
<li><a class="reference internal" href="#id118">Attributes</a></li>
<li><a class="reference internal" href="#id119">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aws-ebs-volume">aws_ebs_volume</a><ul>
<li><a class="reference internal" href="#amazon-aws-credentials">Amazon Web Services Credentials</a></li>
<li><a class="reference internal" href="#id120">Actions</a></li>
<li><a class="reference internal" href="#id121">Attributes</a></li>
<li><a class="reference internal" href="#id122">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aws-elastic-ip">aws_elastic_ip</a><ul>
<li><a class="reference internal" href="#id123">Amazon Web Services Credentials</a></li>
<li><a class="reference internal" href="#id124">Actions</a></li>
<li><a class="reference internal" href="#id125">Attributes</a></li>
<li><a class="reference internal" href="#id126">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bluepill-service">bluepill_service</a><ul>
<li><a class="reference internal" href="#id127">Actions</a></li>
<li><a class="reference internal" href="#id128">Attributes</a></li>
<li><a class="reference internal" href="#id129">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chef-handler">chef_handler</a><ul>
<li><a class="reference internal" href="#id130">Actions</a></li>
<li><a class="reference internal" href="#id131">Attributes</a></li>
<li><a class="reference internal" href="#id132">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#daemontools-service">daemontools_service</a><ul>
<li><a class="reference internal" href="#id133">Actions</a></li>
<li><a class="reference internal" href="#id134">Attributes</a></li>
<li><a class="reference internal" href="#id135">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#djbdns-rr">djbdns_rr</a><ul>
<li><a class="reference internal" href="#id136">Actions</a></li>
<li><a class="reference internal" href="#id137">Attributes</a></li>
<li><a class="reference internal" href="#id138">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dmg-package">dmg_package</a><ul>
<li><a class="reference internal" href="#id139">Actions</a></li>
<li><a class="reference internal" href="#id140">Attributes</a></li>
<li><a class="reference internal" href="#id141">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dynect-rr">dynect_rr</a><ul>
<li><a class="reference internal" href="#id142">Actions</a></li>
<li><a class="reference internal" href="#id143">Attributes</a></li>
<li><a class="reference internal" href="#id144">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#firewall">firewall</a><ul>
<li><a class="reference internal" href="#id145">Actions</a></li>
<li><a class="reference internal" href="#id146">Attributes</a></li>
<li><a class="reference internal" href="#id147">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#firewall-rule">firewall_rule</a><ul>
<li><a class="reference internal" href="#id148">Actions</a></li>
<li><a class="reference internal" href="#id149">Attributes</a></li>
<li><a class="reference internal" href="#id150">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gunicorn-config-needs-review">gunicorn_config &#8211; NEEDS REVIEW</a><ul>
<li><a class="reference internal" href="#id151">Actions</a></li>
<li><a class="reference internal" href="#id152">Attributes</a></li>
<li><a class="reference internal" href="#id153">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gunicorn-install-needs-review">gunicorn_install &#8211; NEEDS REVIEW</a><ul>
<li><a class="reference internal" href="#id154">Actions</a></li>
<li><a class="reference internal" href="#id155">Attributes</a></li>
<li><a class="reference internal" href="#id156">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#homebrew-needs-review">homebrew &#8211; NEEDS REVIEW</a><ul>
<li><a class="reference internal" href="#id157">Actions</a></li>
<li><a class="reference internal" href="#id158">Attributes</a></li>
<li><a class="reference internal" href="#id159">Providers</a></li>
<li><a class="reference internal" href="#id160">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mysql-database">mysql_database</a><ul>
<li><a class="reference internal" href="#id161">Actions</a></li>
<li><a class="reference internal" href="#id162">Attributes</a></li>
<li><a class="reference internal" href="#id163">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pacman-aur">pacman_aur</a><ul>
<li><a class="reference internal" href="#id164">Actions</a></li>
<li><a class="reference internal" href="#id165">Attributes</a></li>
<li><a class="reference internal" href="#id166">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pacman-group">pacman_group</a><ul>
<li><a class="reference internal" href="#id167">Actions</a></li>
<li><a class="reference internal" href="#id168">Attributes</a></li>
<li><a class="reference internal" href="#id169">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#php-pear">php_pear</a><ul>
<li><a class="reference internal" href="#id170">Actions</a></li>
<li><a class="reference internal" href="#id171">Attributes</a></li>
<li><a class="reference internal" href="#id172">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#php-pear-channel">php_pear_channel</a><ul>
<li><a class="reference internal" href="#id173">Actions</a></li>
<li><a class="reference internal" href="#id174">Attributes</a></li>
<li><a class="reference internal" href="#id175">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python-pip">python_pip</a><ul>
<li><a class="reference internal" href="#id176">Actions</a></li>
<li><a class="reference internal" href="#id177">Attributes</a></li>
<li><a class="reference internal" href="#id178">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python-virtualenv">python_virtualenv</a><ul>
<li><a class="reference internal" href="#id179">Actions</a></li>
<li><a class="reference internal" href="#id180">Attributes</a></li>
<li><a class="reference internal" href="#id181">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#riak-cluster">riak_cluster</a><ul>
<li><a class="reference internal" href="#id182">Actions</a></li>
<li><a class="reference internal" href="#id183">Attributes</a></li>
<li><a class="reference internal" href="#id184">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#samba-user">samba_user</a><ul>
<li><a class="reference internal" href="#id185">Actions</a></li>
<li><a class="reference internal" href="#id186">Attributes</a></li>
<li><a class="reference internal" href="#id187">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transmission-torrent-file">transmission_torrent_file</a><ul>
<li><a class="reference internal" href="#id188">Actions</a></li>
<li><a class="reference internal" href="#id189">Attributes</a></li>
<li><a class="reference internal" href="#id190">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#windows-package">windows_package</a><ul>
<li><a class="reference internal" href="#id191">Actions</a></li>
<li><a class="reference internal" href="#id192">Attributes</a></li>
<li><a class="reference internal" href="#id193">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#windows-registry">windows_registry</a><ul>
<li><a class="reference internal" href="#id194">Actions</a></li>
<li><a class="reference internal" href="#id195">Attributes</a></li>
<li><a class="reference internal" href="#id196">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#windows-zipfile">windows_zipfile</a><ul>
<li><a class="reference internal" href="#id197">Actions</a></li>
<li><a class="reference internal" href="#id198">Attributes</a></li>
<li><a class="reference internal" href="#id199">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="resources-and-providers-reference">
<h1>Resources and Providers Reference<a class="headerlink" href="#resources-and-providers-reference" title="Permalink to this headline">¶</a></h1>
<p>A resource is a key part of a recipe. A resource defines the actions that can be taken, such as when a package should be installed, whether a service should be enabled or restarted, which groups, users, or groups of users should be created, where to put a collection of files, what the name of a new directory should be, and so on. During a Chef run, each resource is identified and then associated with a provider. The provider then does the work to complete the action defined by the resource. Chef ensures that the same actions are taken the same way everywhere and that actions are idempotent. A resource is implemented within a recipe using Ruby.</p>
<p>A resource represents a piece of the system, its current state, and the action that is needed to move it to a desired state. A provider defines the path required to bring that piece of the system from its current to the desired state. An action is de-coupled from the steps required to complete that action, which means that a provider exists for each of the paths that are required to complete the action. This is important because a single action may require different steps, depending on the platform of the system on which the action is being taken.</p>
<p>For example, &#8220;install a package&#8221; is a single action. To install a package onto various platforms, the steps required steps for each of those platforms may be different. This requires  different providers. On a Red Hat or CentOS machine a provider will use the Yum package provider to get the package installed and on a Debian or an Ubuntu machine a provider will use the APT package installer. One action, two providers, each taking only the steps required to complete that action.</p>
<p>The <tt class="docutils literal"><span class="pre">Chef::Platform</span></tt> class maps providers to platforms (and platform versions). Ohai, as part of every Chef run, verifies the <tt class="docutils literal"><span class="pre">platform</span></tt> and <tt class="docutils literal"><span class="pre">platform_version</span></tt> attributes on each node, and then Chef uses those values to identify the correct provider, build an instance of that provider, identify the current state of the resource, do the specified action, and then mark the resource as updated (if changes were made). For example, given the following resource:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">directory</span> <span class="s2">&quot;/tmp/folder&quot;</span> <span class="k">do</span>
  <span class="n">owner</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">group</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">mode</span> <span class="mo">0755</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Chef will look up the provider for the <tt class="docutils literal"><span class="pre">directory</span></tt> resource, which happens to be <tt class="docutils literal"><span class="pre">Chef::Provider::Directory</span></tt>, call <tt class="docutils literal"><span class="pre">load_current_resource</span></tt> to create a new resource called <tt class="docutils literal"><span class="pre">directory[&quot;/tmp/folder&quot;]</span></tt>, and then based on the current state of the directory, do the specified action, which in this case is to create a directory called <tt class="docutils literal"><span class="pre">/tmp/folder</span></tt>. If the directory already exists, nothing will happen. If the directory was changed in any way, the resource is marked as updated.</p>
<p>This reference describes each of the resources available in the Chef library, including the list of actions available for the resource, the attributes that can be used, the providers that will do the work (and the provider&#8217;s shortcut resource name), and examples of using each resource.</p>
<div class="section" id="common-functionality-for-all-resources">
<h2>Common Functionality for all Resources<a class="headerlink" href="#common-functionality-for-all-resources" title="Permalink to this headline">¶</a></h2>
<p>The attributes and actions in this section apply to all resources.</p>
<div class="section" id="actions">
<h3>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h3>
<p>The following actions are common to every resource:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">nothing</span></tt></td>
<td>Use to do nothing. In the absence of another default action, <tt class="docutils literal"><span class="pre">nothing</span></tt> is the default. This action can be useful to specify a resource so that it can be notified of other actions.</td>
</tr>
</tbody>
</table>
<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;memcached&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
  <span class="n">supports</span> <span class="ss">:status</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:start</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:stop</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<p>The following attributes are common to every resource:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ignore_failure</span></tt></td>
<td>Use to continue running a recipe if a resource fails for any reason. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">provider</span></tt></td>
<td>Use to specify the class name of a provider for use with a resource.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">retries</span></tt></td>
<td>Use to specify the number of times to catch exceptions and retry the resource. Default value: <tt class="docutils literal"><span class="pre">0</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">retry_delay</span></tt></td>
<td>Use to specify the retry delay (in seconds). Default value: <tt class="docutils literal"><span class="pre">2</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">supports</span></tt></td>
<td>Use to specify a hash of options that contains hints about the capabilities of a resource. Chef may use these hints to help identify the correct provider. This attribute is only utilized by a small number of providers, including <tt class="docutils literal"><span class="pre">User</span></tt> and <tt class="docutils literal"><span class="pre">Service</span></tt>.</td>
</tr>
</tbody>
</table>
<div class="section" id="id1">
<h4>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Using <tt class="docutils literal"><span class="pre">ignore_failure</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span> <span class="s2">&quot;syntax&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">ignore_failure</span> <span class="kp">true</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Using <tt class="docutils literal"><span class="pre">provider</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;some_package&quot;</span> <span class="k">do</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rubygems</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Using <tt class="docutils literal"><span class="pre">supports</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;apache&quot;</span> <span class="k">do</span>
  <span class="n">supports</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:reload</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="ss">:enable</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Using <tt class="docutils literal"><span class="pre">provider</span></tt> and <tt class="docutils literal"><span class="pre">supports</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;some_service&quot;</span> <span class="k">do</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Service</span><span class="o">::</span><span class="no">Upstart</span>
  <span class="n">supports</span> <span class="ss">:status</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:reload</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="o">[</span> <span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span> <span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conditional-execution">
<h3>Conditional Execution<a class="headerlink" href="#conditional-execution" title="Permalink to this headline">¶</a></h3>
<p>A conditional execution can be used to put additional guards around certain resources so that they are only run when the condition is met. The most common reason for using a conditional execution is to ensure that the <tt class="docutils literal"><span class="pre">execute</span></tt> resource is idempotent, but conditional executions can be used with any resource. A conditional execution can be passed as a string or as a block. A strings is executed as a shell command and a block is Ruby code. In both cases, the attribute is <tt class="docutils literal"><span class="pre">true</span></tt> when the command returns <tt class="docutils literal"><span class="pre">0</span></tt>).</p>
<div class="section" id="id2">
<h4>Attributes<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>The following attributes can be used to define a conditional execution for a resource:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">not_if</span></tt></td>
<td>Indicates whether this resource should not be applied. If <tt class="docutils literal"><span class="pre">true</span></tt>, this action should not be performed. If <tt class="docutils literal"><span class="pre">false</span></tt> this action should always be performed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">only_if</span></tt></td>
<td>Indicates whether only this resource is applied. If <tt class="docutils literal"><span class="pre">true</span></tt>, this action should always be performed. If <tt class="docutils literal"><span class="pre">false</span></tt> this action should never be performed.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="arguments">
<h4>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h4>
<p>The following arguments can be used with the <tt class="docutils literal"><span class="pre">not_if</span></tt> or <tt class="docutils literal"><span class="pre">only_if</span></tt> attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:user</span></tt></td>
<td><p class="first">Use to specify the user that a command will run as. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span class="n">not_if</span> <span class="s2">&quot;grep adam /etc/passwd&quot;</span><span class="p">,</span> <span class="ss">:user</span> <span class="o">=&gt;</span> <span class="s1">&#39;adam&#39;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:group</span></tt></td>
<td><p class="first">Use to specify the group that a command will run as. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span class="n">not_if</span> <span class="s2">&quot;grep adam /etc/passwd&quot;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="s1">&#39;adam&#39;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:environment</span></tt></td>
<td><p class="first">Use to specify a hash of environment variables to be set. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span class="n">not_if</span> <span class="s2">&quot;grep adam /etc/passwd&quot;</span><span class="p">,</span> <span class="ss">:environment</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;HOME&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;/home/adam&quot;</span> <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:cwd</span></tt></td>
<td><p class="first">Use to set the current working directory before running a command. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span class="n">not_if</span> <span class="s2">&quot;grep adam passwd&quot;</span><span class="p">,</span> <span class="ss">:cwd</span> <span class="o">=&gt;</span> <span class="s1">&#39;/etc&#39;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:timeout</span></tt></td>
<td><p class="first">Use to set a timeout for a command. For example:</p>
<div class="last highlight-ruby"><div class="highlight"><pre><span class="n">not_if</span> <span class="s2">&quot;sleep 10000&quot;</span><span class="p">,</span> <span class="ss">:timeout</span> <span class="o">=&gt;</span> <span class="mi">10</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="not-if-examples">
<h4><tt class="docutils literal"><span class="pre">not_if</span></tt> Examples<a class="headerlink" href="#not-if-examples" title="Permalink to this headline">¶</a></h4>
<p>The following three examples show how to use a string or a Ruby block to create <tt class="docutils literal"><span class="pre">/tmp/somefile</span></tt>, but not if the <tt class="docutils literal"><span class="pre">/etc/passwd</span></tt> already exists.</p>
<p>To execute a string:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">not_if</span> <span class="s2">&quot;test -f /etc/passwd&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To execute a Ruby block:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">not_if</span> <span class="k">do</span>
    <span class="no">File</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To execute a Ruby block using curly braces:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">not_if</span> <span class="p">{</span><span class="no">File</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">)}</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The next example shows how to create <tt class="docutils literal"><span class="pre">/tmp/somefile</span></tt>, but not if the node has the attribute <tt class="docutils literal"><span class="pre">some_value</span></tt> using Ruby and curly braces (that specify the node attribute):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">not_if</span> <span class="p">{</span> <span class="n">node</span><span class="o">[</span><span class="ss">:some_value</span><span class="o">]</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="only-if-examples">
<h4><tt class="docutils literal"><span class="pre">only_if</span></tt> Examples<a class="headerlink" href="#only-if-examples" title="Permalink to this headline">¶</a></h4>
<p>The following two examples will create <tt class="docutils literal"><span class="pre">/tmp/somefile</span></tt> only if <tt class="docutils literal"><span class="pre">/etc/passwd</span></tt> exists using a string or a Ruby block.</p>
<p>To execute a string:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">only_if</span> <span class="s2">&quot;test -f /etc/passwd&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To execute a Ruby block:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">not_if</span> <span class="k">do</span> <span class="o">!</span> <span class="no">File</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">)</span> <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The following example will create <tt class="docutils literal"><span class="pre">tmp/somefile</span></tt>, but only if the node has the attribute <tt class="docutils literal"><span class="pre">some_value</span></tt> using Ruby and curly braces (that specify the node attribute):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">only_if</span> <span class="p">{</span> <span class="n">node</span><span class="o">[</span><span class="ss">:some_value</span><span class="o">]</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="notifications">
<h3>Notifications<a class="headerlink" href="#notifications" title="Permalink to this headline">¶</a></h3>
<p>The following notifications can be used with any resource:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Notification</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">notifies</span></tt></td>
<td>Use to notify another resource to take an action if this resource&#8217;s state changes for any reason.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">subscribes</span></tt></td>
<td>Use to take action on this resource if another resource&#8217;s state changes. This is similar to <tt class="docutils literal"><span class="pre">notifies</span></tt>, but reversed.</td>
</tr>
</tbody>
</table>
<div class="section" id="notifications-timers">
<h4>Notifications Timers<a class="headerlink" href="#notifications-timers" title="Permalink to this headline">¶</a></h4>
<p>The following timers can be used to define when a notification is triggered:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Timer</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:restart</span></tt></td>
<td>Use to restart a service or application.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delayed</span></tt></td>
<td>Use to specify that a notification should be queued up and then executed at the very end of a Chef run.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:immediately</span></tt></td>
<td>Use to specify that a notification be run immediately.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="notifies-syntax">
<h4>Notifies Syntax<a class="headerlink" href="#notifies-syntax" title="Permalink to this headline">¶</a></h4>
<p>The basic syntax of a <tt class="docutils literal"><span class="pre">notifies</span></tt> notification is:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">resource</span> <span class="s2">&quot;name&quot;</span> <span class="k">do</span>
  <span class="n">notifies</span> <span class="ss">:action</span><span class="p">,</span> <span class="s2">&quot;resource_type[resource_name]&quot;</span><span class="p">,</span> <span class="ss">:notification_timing</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For example, if you need to restart the Apache service when you modify a template that configures Apache, use <tt class="docutils literal"><span class="pre">:restart</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/etc/www/configures-apache.conf&quot;</span> <span class="k">do</span>
  <span class="n">notifies</span> <span class="ss">:restart</span><span class="p">,</span> <span class="s2">&quot;service[apache]&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>By default, notifications are <tt class="docutils literal"><span class="pre">:delayed</span></tt>, that is they are queued up as they are triggered, and then executed at the very end of a Chef run. To run an action immediately, use <tt class="docutils literal"><span class="pre">:immediately</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/etc/nagios3/configures-nagios.conf&quot;</span> <span class="k">do</span>
  <span class="c1"># other parameters</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s2">&quot;execute[test-nagios-config]&quot;</span><span class="p">,</span> <span class="ss">:immediately</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To verify a configuration and prevent an application from restarting if the configuration is broken, use <tt class="docutils literal"><span class="pre">:nothing</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s2">&quot;test-nagios-config&quot;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">&quot;nagios3 --verify-config&quot;</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To send notifications to multiple resources, just use multiple attributes. Multiple attributes will get sent to the notified resources in the order specified.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/etc/netatalk/netatalk.conf&quot;</span> <span class="k">do</span>
  <span class="n">notifies</span> <span class="ss">:restart</span><span class="p">,</span> <span class="s2">&quot;service[afpd]&quot;</span><span class="p">,</span> <span class="ss">:immediately</span>
  <span class="n">notifies</span> <span class="ss">:restart</span><span class="p">,</span> <span class="s2">&quot;service[cnid]&quot;</span><span class="p">,</span> <span class="ss">:immediately</span>
<span class="k">end</span>

<span class="n">service</span> <span class="s2">&quot;afpd&quot;</span>
<span class="n">service</span> <span class="s2">&quot;cnid&quot;</span>
</pre></div>
</div>
<div class="section" id="id3">
<h5>Examples<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p>To reload a service:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
  <span class="n">notifies</span> <span class="ss">:reload</span><span class="p">,</span> <span class="s2">&quot;service[apache]&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To enable a service after restarting or reloading it:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;apache&quot;</span> <span class="k">do</span>
  <span class="n">supports</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:reload</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="ss">:enable</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To notify multiple resources:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/etc/chef/server.rb&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;server.rb.erb&quot;</span>
  <span class="n">owner</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">group</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;644&quot;</span>
  <span class="n">notifies</span> <span class="ss">:restart</span><span class="p">,</span> <span class="s2">&quot;service[chef-solr]&quot;</span><span class="p">,</span> <span class="ss">:delayed</span>
  <span class="n">notifies</span> <span class="ss">:restart</span><span class="p">,</span> <span class="s2">&quot;service[chef-solr-indexer]&quot;</span><span class="p">,</span> <span class="ss">:delayed</span>
  <span class="n">notifies</span> <span class="ss">:restart</span><span class="p">,</span> <span class="s2">&quot;service[chef-server]&quot;</span><span class="p">,</span> <span class="ss">:delayed</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To notify multiple resources and create a sequence of ordered notifications:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s1">&#39;foo&#39;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s1">&#39;...&#39;</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s1">&#39;template[baz]&#39;</span><span class="p">,</span> <span class="ss">:immediately</span>
  <span class="n">notifies</span> <span class="ss">:install</span><span class="p">,</span> <span class="s1">&#39;package[bar]&#39;</span><span class="p">,</span> <span class="ss">:immediately</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s1">&#39;execute[final]&#39;</span><span class="p">,</span> <span class="ss">:immediately</span>
<span class="k">end</span>

<span class="n">template</span> <span class="s1">&#39;baz&#39;</span> <span class="k">do</span>
  <span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s1">&#39;execute[restart_baz]&#39;</span><span class="p">,</span> <span class="ss">:immediately</span>
<span class="k">end</span>

<span class="n">package</span> <span class="s1">&#39;bar&#39;</span>

<span class="n">execute</span> <span class="s1">&#39;restart_baz&#39;</span>

<span class="n">execute</span> <span class="s1">&#39;final&#39;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s1">&#39;...&#39;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where the sequencing will be in the following order: <tt class="docutils literal"><span class="pre">execute</span> <span class="pre">'foo'</span></tt>, <tt class="docutils literal"><span class="pre">template</span> <span class="pre">'baz'</span></tt>, <tt class="docutils literal"><span class="pre">execute</span> <span class="pre">[restart_baz]</span></tt>, <tt class="docutils literal"><span class="pre">package</span> <span class="pre">'bar'</span></tt>, and <tt class="docutils literal"><span class="pre">execute</span> <span class="pre">'final'</span></tt>.</p>
</div>
</div>
<div class="section" id="subscribes-syntax">
<h4>Subscribes Syntax<a class="headerlink" href="#subscribes-syntax" title="Permalink to this headline">¶</a></h4>
<p>A resource must be defined before another resource may subscribe to it. The basic syntax of a <tt class="docutils literal"><span class="pre">subscribes</span></tt> notification is:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">resource</span> <span class="s2">&quot;name&quot;</span> <span class="k">do</span>
  <span class="n">subscribes</span> <span class="ss">:action</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:resource_type</span> <span class="o">=&gt;</span> <span class="s2">&quot;resource_name&quot;</span><span class="p">),</span> <span class="ss">:notification_timing</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">resource</span> <span class="s2">&quot;name&quot;</span> <span class="k">do</span>
  <span class="n">subscribes</span> <span class="ss">:action</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="s2">&quot;resource[resource_name]&quot;</span><span class="p">),</span> <span class="ss">:notification_timing</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The notification timings for <tt class="docutils literal"><span class="pre">subscribes</span></tt> work in the same manner as <tt class="docutils literal"><span class="pre">notifies</span></tt>, so the following code should achieve the same results:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/etc/nagios3/configures-nagios.conf&quot;</span> <span class="k">do</span>
  <span class="c1"># other parameters</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To verify a configuration and prevent an application from restarting if the configuration is broken, use <tt class="docutils literal"><span class="pre">:nothing</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s2">&quot;test-nagios-config&quot;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">&quot;nagios3 --verify-config&quot;</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
  <span class="n">subscribes</span> <span class="ss">:run</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:template</span> <span class="o">=&gt;</span> <span class="s2">&quot;/etc/nagios3/configures-nagios.conf&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="section" id="id4">
<h5>Examples<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<p>To reload a service based on a template <strong>jamescott: WHAT DOES THIS ACTUALLY DO?</strong>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/somefile&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">source</span> <span class="s2">&quot;somefile.erb&quot;</span>
<span class="k">end</span>

<span class="n">service</span> <span class="s2">&quot;apache&quot;</span> <span class="k">do</span>
  <span class="n">supports</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:reload</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="ss">:enable</span>
  <span class="n">subscribes</span> <span class="ss">:reload</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="s2">&quot;template[/tmp/somefile]&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="relative-paths">
<h3>Relative Paths<a class="headerlink" href="#relative-paths" title="Permalink to this headline">¶</a></h3>
<p>The following relative paths can be used with any resource:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Relative Path</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">#{ENV['HOME']}</span></tt></td>
<td>Use to return the <tt class="docutils literal"><span class="pre">~</span></tt> path in Linux and Mac OS X or the <tt class="docutils literal"><span class="pre">%HOMEPATH%</span></tt> in Microsoft Windows.</td>
</tr>
</tbody>
</table>
<div class="section" id="id5">
<h4>Examples<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;HOME&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">/chef-getting-started.txt&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;chef-getting-started.txt.erb&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<p>The following resources are included with Chef and have native providers:</p>
<ul class="simple">
<li>cookbook_file</li>
<li>cron</li>
<li>deploy</li>
<li>directory</li>
<li>env</li>
<li>erlang_call</li>
<li>execute</li>
<li>file</li>
<li>git</li>
<li>group</li>
<li>http_request</li>
<li>ifconfig</li>
<li>link</li>
<li>log</li>
<li>mdadm</li>
<li>mount</li>
<li>ohai</li>
<li>package</li>
<li>powershell_script</li>
<li>remote_directory</li>
<li>remote_file</li>
<li>route</li>
<li>ruby_block</li>
<li>scm</li>
<li>script</li>
<li>service</li>
<li>subversion</li>
<li>template</li>
<li>user</li>
<li>yum</li>
</ul>
<p>See below for more information about each of these resources, their related actions and attributes, the providers they rely on, and examples of how these resources can be used in recipes.</p>
<div class="section" id="cookbook-file">
<h3>cookbook_file<a class="headerlink" href="#cookbook-file" title="Permalink to this headline">¶</a></h3>
<p>The Cookbook File resource is used to transfer files from a sub-directory of the <tt class="docutils literal"><span class="pre">files/</span></tt> directory in a cookbook to a specified path on the host running the chef-client or Chef Solo. <strong>jamescott: what about uploads to the Chef Hosted/Private servers?</strong> The file in a cookbook is selected according to file specificity, which allows different source files to be used based on the hostname, host platform (operating system, distro, or as appropriate), or platform version. Place files under COOKBOOK_NAME/files/default to use them on any platform.</p>
<div class="section" id="id6">
<h4>Actions<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:create_if_missing</span></tt></td>
<td>Use to create a file if it doesn&#8217;t already exist.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete a file.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id7">
<h4>Attributes<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">backup</span></tt></td>
<td>The number of backups of a file that should be kept. Set to <tt class="docutils literal"><span class="pre">false</span></tt> to prevent backups from being kept. Default value: <tt class="docutils literal"><span class="pre">5</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>A string or ID that identifies the group owner of the file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">mode</span></tt></td>
<td>The octal mode of the file. When specifying <tt class="docutils literal"><span class="pre">mode</span></tt>, the value can be a quoted string (&#8220;644&#8221;). For a numeric value, it should be five digits (&#8220;00644&#8221;) to ensure that it is correctly parsed by Ruby. The default value for this attribute varies.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rights</span></tt></td>
<td>Microsoft Windows only. The permissions for users and groups in a Microsoft Windows environment. For example: <tt class="docutils literal"><span class="pre">rights</span> <span class="pre">&lt;permissions&gt;,</span> <span class="pre">&lt;principal&gt;,</span> <span class="pre">&lt;options&gt;</span></tt> where <tt class="docutils literal"><span class="pre">&lt;permissions&gt;</span> <span class="pre">is</span> <span class="pre">specifies</span> <span class="pre">the</span> <span class="pre">rights</span> <span class="pre">granted</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">principal,</span> <span class="pre">``&lt;principal&gt;</span></tt> is the group or user name, and <tt class="docutils literal"><span class="pre">&lt;options</span></tt>&gt; is a hash with one (or more) advanced rights options.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">inherits</span></tt></td>
<td>Microsoft Windows only. Indicates that the file inherits rights from its parent. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of the file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to the file. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>The base name of the source file (and inferred from the <tt class="docutils literal"><span class="pre">path</span></tt> attribute).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">cookbook</span></tt></td>
<td>The cookbook in which a file is located. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt> (the current cookbook).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="providers">
<h4>Providers<a class="headerlink" href="#providers" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Cookbook File resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::CookbookFile</span></tt></td>
<td><tt class="docutils literal"><span class="pre">cookbook_file</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id8">
<h4>Examples<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>To transfer a file in a cookbook:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">cookbook_file</span> <span class="s2">&quot;/tmp/testfile&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;testfile&quot;</span> <span class="c1"># this is the value that would be inferred from the path parameter</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cron">
<h3>cron<a class="headerlink" href="#cron" title="Permalink to this headline">¶</a></h3>
<p>The Cron resource is used to manage cron entries for time-based job scheduling. Attributes for a schedule will default to <tt class="docutils literal"><span class="pre">*</span></tt> of not provided, so only specify scheduling attributes that are applicable to a cron entry. The Cron resource requires that a package be installed that provides the crontab program, typically cron.</p>
<div class="section" id="id9">
<h4>Actions<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create an entry in a cron table file (&#8220;crontab&#8221;). If an entry already exists with the same name, use to update that entry.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete an entry from a cron table file (&#8220;crontab&#8221;).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id10">
<h4>Attributes<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">minute</span></tt></td>
<td>The minute at which the cron entry should run (0 - 59). Default value: <tt class="docutils literal"><span class="pre">*</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">hour</span></tt></td>
<td>The hour at which the cron entry should run (0 - 23). Default value: <tt class="docutils literal"><span class="pre">*</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">day</span></tt></td>
<td>The day of month at which the cron entry should run (1 - 31). Default value: <tt class="docutils literal"><span class="pre">*</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">month</span></tt></td>
<td>The month in the year on which the cron entry should run (1 - 12). Default value: <tt class="docutils literal"><span class="pre">*</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">weekday</span></tt></td>
<td>The day of the week on this entry should run (0 - 6), where Sunday = 0. Default value: <tt class="docutils literal"><span class="pre">*</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">command</span></tt></td>
<td>The command to run. Default value: <tt class="docutils literal"><span class="pre">*</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">user</span></tt></td>
<td>The user that runs the command. If the <tt class="docutils literal"><span class="pre">user</span></tt> attribute is changed, the original <tt class="docutils literal"><span class="pre">user</span></tt> the crontab program for the original <tt class="docutils literal"><span class="pre">user</span></tt> will continue to run until that crontab program is deleted. Default value: <tt class="docutils literal"><span class="pre">root</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mailto</span></tt></td>
<td>Sets the MAILTO environment variable.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>Sets the PATH environment variable.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">home</span></tt></td>
<td>Sets the HOME environment variable.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">shell</span></tt></td>
<td>Sets the SHELL environment variable.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id11">
<h4>Providers<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Cron resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Cron</span></tt></td>
<td><tt class="docutils literal"><span class="pre">cron</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id12">
<h4>Examples<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>To run a program on the fifth hour of the day:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">cron</span> <span class="s2">&quot;noop&quot;</span> <span class="k">do</span>
  <span class="n">hour</span> <span class="s2">&quot;5&quot;</span>
  <span class="n">minute</span> <span class="s2">&quot;0&quot;</span>
  <span class="n">command</span> <span class="s2">&quot;/bin/true&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To run an entry if a folder exists:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">cron</span> <span class="s2">&quot;ganglia_tomcat_thread_max&quot;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">&quot;/usr/bin/gmetric -n &#39;tomcat threads max&#39; -t uint32 -v `/usr/local/bin/tomcat-stat --thread-max`&quot;</span>
  <span class="n">only_if</span> <span class="k">do</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="s2">&quot;/home/jboss&quot;</span><span class="p">)</span> <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="deploy">
<h3>deploy<a class="headerlink" href="#deploy" title="Permalink to this headline">¶</a></h3>
<p>The Deploy resource is used to manage and control deployments. There is a large number of attributes available for this resource that can be used to specify many different behaviors. Please review them carefully before deciding on which approach is required for a particular recipe.</p>
<div class="section" id="deployment-strategies">
<h4>Deployment Strategies<a class="headerlink" href="#deployment-strategies" title="Permalink to this headline">¶</a></h4>
<p>In the <tt class="docutils literal"><span class="pre">deploy</span></tt> directory, a sub-directory named <tt class="docutils literal"><span class="pre">shared</span></tt> must be created. This sub-directory is where configuration and temporary files will be kept. A typical Ruby on Rails application will have <tt class="docutils literal"><span class="pre">config</span></tt>, <tt class="docutils literal"><span class="pre">log</span></tt>, <tt class="docutils literal"><span class="pre">pids</span></tt>, and <tt class="docutils literal"><span class="pre">system</span></tt> directories within the <tt class="docutils literal"><span class="pre">shared</span></tt> directory to keep the files stored there independent of the code in the source repository.</p>
<p>In addition to the <tt class="docutils literal"><span class="pre">shared</span></tt> sub-directory, the deploy process will create sub-directories named <tt class="docutils literal"><span class="pre">releases</span></tt> and <tt class="docutils literal"><span class="pre">current</span></tt> (also in the <tt class="docutils literal"><span class="pre">deploy</span></tt> directory). The <tt class="docutils literal"><span class="pre">release</span></tt> directory holds (up to) five most recently deployed versions of an application. The <tt class="docutils literal"><span class="pre">current</span></tt> directory holds the currently-released version.</p>
<div class="section" id="deployment-phases">
<h5>Deployment Phases<a class="headerlink" href="#deployment-phases" title="Permalink to this headline">¶</a></h5>
<p>A deployment happens in four phases:</p>
<ol class="arabic simple">
<li>Checkout. Chef uses the Source Control Management (SCM) resource to get the specified application revision, placing a clone or checkout in the sub-directory of the <tt class="docutils literal"><span class="pre">deploy</span></tt> directory named <tt class="docutils literal"><span class="pre">cached-copy</span></tt>. A copy of the application is then placed in a sub-directory under <tt class="docutils literal"><span class="pre">releases</span></tt>.</li>
<li>Migrate. If a migration is to be run, Chef symlinks the database configuration file into the checkout (<tt class="docutils literal"><span class="pre">config/database.yml</span></tt> by default) and runs the migration command. For a Ruby on Rails application, the <tt class="docutils literal"><span class="pre">migration_command</span></tt> is usually set to <tt class="docutils literal"><span class="pre">rake</span> <span class="pre">db:migrate</span></tt>.</li>
<li>Symlink. Directories for shared and temporary files are removed from the checkout (<tt class="docutils literal"><span class="pre">log</span></tt>, <tt class="docutils literal"><span class="pre">tmp/pids</span></tt>, and <tt class="docutils literal"><span class="pre">public/system</span></tt> by default). After this step, any needed directories (<tt class="docutils literal"><span class="pre">tmp</span></tt>, <tt class="docutils literal"><span class="pre">public</span></tt>, and <tt class="docutils literal"><span class="pre">config</span></tt> by default) are created if they don&#8217;t already exist. This step is completed by symlinking shared directories into the current <tt class="docutils literal"><span class="pre">release</span></tt>, <tt class="docutils literal"><span class="pre">public/system</span></tt>, <tt class="docutils literal"><span class="pre">tmp/pids</span></tt>, and <tt class="docutils literal"><span class="pre">log</span></tt> directories, and then symlinking the <tt class="docutils literal"><span class="pre">release</span></tt> directory to <tt class="docutils literal"><span class="pre">current</span></tt>.</li>
<li>Restart. The application is restarted according to the restart command set in the recipe.</li>
</ol>
</div>
<div class="section" id="callbacks">
<h5>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h5>
<p>In-between each step in a deployment process, callbacks can be run using arbitrary Ruby code. All callbacks support embedded recipes given in a block, but each callback assumes a shell command (instead of a deploy hook filename) when given a string.</p>
<p>The following callback types are available:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">before_migrate</span></tt></li>
<li><tt class="docutils literal"><span class="pre">before_symlink</span></tt></li>
<li><tt class="docutils literal"><span class="pre">before_restart</span></tt></li>
<li><tt class="docutils literal"><span class="pre">after_restart</span></tt></li>
<li><tt class="docutils literal"><span class="pre">restart_command</span></tt></li>
</ul>
<p>Each of these callback types can be used in one of three ways:</p>
<ul class="simple">
<li>To pass a block</li>
<li>To specify a file</li>
<li>To do neither; Chef will look for a callback file named after one of the callback types (<tt class="docutils literal"><span class="pre">before_migrate.rb</span></tt>, for example) and if the file exists, to evaluate it as if it were a specified file.</li>
</ul>
<p>Within a callback, there are two ways to get access to information about the deployment:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">release_path</span></tt> can be used to get the path to the current release.</li>
<li><tt class="docutils literal"><span class="pre">new_resource</span></tt> can be used to access the deploy resource, including environment variables that have been set there. (<tt class="docutils literal"><span class="pre">new_resource</span></tt> is a preferred approach over using the <tt class="docutils literal"><span class="pre">&#64;configuration</span></tt> variable.)</li>
</ul>
<p>Both of these options must be available at the top-level within the callback, along with any assigned values that will be used later in the callback.</p>
<p>For example, to pass a block:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">deploy_revision</span> <span class="s2">&quot;/deploy/dir/&quot;</span> <span class="k">do</span>
  <span class="c1"># other attributes</span>
  <span class="c1"># ...</span>

  <span class="n">before_migrate</span> <span class="k">do</span>
    <span class="c1"># release_path is the path to the timestamp dir</span>
    <span class="c1"># for the current release</span>
    <span class="n">current_release</span> <span class="o">=</span> <span class="n">release_path</span>

    <span class="c1"># Create a local variable for the node so we&#39;ll have access to</span>
    <span class="c1"># the attributes</span>
    <span class="n">deploy_node</span> <span class="o">=</span> <span class="n">node</span>

    <span class="c1"># A local variable with the deploy resource.</span>
    <span class="n">deploy_resource</span> <span class="o">=</span> <span class="n">new_resource</span>

    <span class="n">python</span> <span class="k">do</span>
      <span class="n">cwd</span> <span class="n">current_release</span>
      <span class="n">user</span> <span class="s2">&quot;myappuser&quot;</span>
      <span class="n">code</span><span class="o">&lt;&lt;-</span><span class="no">PYCODE</span>
        <span class="c1"># Woah, callbacks in python!</span>
        <span class="c1"># ...</span>
        <span class="c1"># current_release, deploy_node, and deploy_resource are all available</span>
        <span class="c1"># within the deploy hook now.</span>
      <span class="no">PYCODE</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Files are searched relative to the current release. The code in the file is evaluated exactly as if the code had been put in a block. To specify a file:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">deploy</span> <span class="s2">&quot;/deploy/dir/&quot;</span> <span class="k">do</span>
  <span class="c1"># ...</span>

  <span class="n">before_migrate</span> <span class="s2">&quot;callbacks/do_this_before_migrate.rb&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-application-layouts">
<h5>Custom Application Layouts<a class="headerlink" href="#custom-application-layouts" title="Permalink to this headline">¶</a></h5>
<p>The Deploy resource expects an application to be structured like a Ruby on Rails application, but the layout can be modified to meet custom requirements as needed.</p>
<p>The following custom application layouts are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Layout</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">symlink_before_migrate</span></tt></td>
<td>Use this layout to link required configuration files into place so they can be available during a migration step. <tt class="docutils literal"><span class="pre">symlink_before_migrate</span></tt> is a hash that maps files in the shared directory to files in the current release. Use <tt class="docutils literal"><span class="pre">symlink_before_migrate({})</span></tt> or <tt class="docutils literal"><span class="pre">symlink_before_migrate</span> <span class="pre">nil</span></tt> instead of <tt class="docutils literal"><span class="pre">symlink_before_migrate</span> <span class="pre">{}</span></tt> because the <tt class="docutils literal"><span class="pre">{}</span></tt> is interpreted as a block rather than an empty hash. Default value: <tt class="docutils literal"><span class="pre">{&quot;config/database.yml&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;config/database.yml&quot;}</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">purge_before_symlink</span></tt></td>
<td>Use this layout to remove directories before the production copy from a shared directory is symlinked in. <tt class="docutils literal"><span class="pre">purge_before_symlink</span></tt> is an array of directories that are removed before symlink setup. Default value: <tt class="docutils literal"><span class="pre">[&quot;log&quot;,</span> <span class="pre">&quot;tmp/pids&quot;,</span> <span class="pre">&quot;public/system&quot;]</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">create_dirs_before_symlink</span></tt></td>
<td>Use this layout to create directories that need to exist in the release before the symlink step. For example, in the context of a rails app, <tt class="docutils literal"><span class="pre">.gitignore</span></tt> may be used to keep tempfiles out of a repository and to prevent the <tt class="docutils literal"><span class="pre">tmp/</span></tt> directory from being part of checked out code. The symlink step will create a symlink from <tt class="docutils literal"><span class="pre">shared/pids</span></tt> to <tt class="docutils literal"><span class="pre">RELEASE/tmp/pids</span></tt>. Since this behavior would fail if the <tt class="docutils literal"><span class="pre">RELEASE/tmp</span></tt> directory did not exist, that directory must be created for the deployment to proceed. It is not necessary to create directories that will be symlinked in the symlink step, such as <tt class="docutils literal"><span class="pre">log/</span></tt>, as these do not rely on the existence of other directories in the release. Directories that already exist will be overwritten. Default value: <tt class="docutils literal"><span class="pre">[&quot;tmp&quot;,</span> <span class="pre">&quot;public&quot;,</span> <span class="pre">&quot;config&quot;]</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">symlinks</span></tt></td>
<td>Use this layout to map files and directories during the main symlinking step. <tt class="docutils literal"><span class="pre">symlinks</span></tt> is a hash that maps files and directories from their locations in the shared directory to locations in the release directory. Default value: <tt class="docutils literal"><span class="pre">{&quot;system&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;public/system&quot;,</span> <span class="pre">&quot;pids&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;tmp/pids&quot;,</span> <span class="pre">&quot;log&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;log&quot;}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="starting-over">
<h5>Starting Over<a class="headerlink" href="#starting-over" title="Permalink to this headline">¶</a></h5>
<p>Chef uses a cache file to keep track of the order in which each revision of an application is deployed. Ifa re-deployment must be forced&#8212;by deleting the deployed code from a node, for example&#8212;the cache file must be deleted as well. The cache file is located in the default configuration at /var/chef/cache/revision-deploys/APPNAME/.</p>
</div>
</div>
<div class="section" id="id13">
<h4>Actions<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:deploy</span></tt></td>
<td>Default. Use to deploy an application.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:force_deploy</span></tt></td>
<td>Use to remove any existing release of the same code version and re-deploy a new one in its place.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:rollback</span></tt></td>
<td>Use to roll an application back to the previous release.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id14">
<h4>Attributes<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">deploy_to</span></tt></td>
<td>The &#8220;meta root&#8221; for the application.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">repository</span></tt></td>
<td>The URI for the repository.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">repo</span></tt></td>
<td>The alias for the repository.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">revision</span></tt></td>
<td>The revision to be checked out. This can be symbolic, like <tt class="docutils literal"><span class="pre">HEAD</span></tt> or it can be a source control management-specific revision identifier. Default value: <tt class="docutils literal"><span class="pre">HEAD</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">branch</span></tt></td>
<td>The alias for the revision.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">user</span></tt></td>
<td>The system user that is responsible for the checked-out code. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>The system group that is responsible for the checked-out code. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">svn_username</span></tt></td>
<td>Subversion only. The user name for a user that has access to the Subversion repository.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">svn_password</span></tt></td>
<td>Subversion only. The password for the user that has access to the Subversion repository.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">svn_arguments</span></tt></td>
<td>Subversion only. The extra arguments that are passed to the Subversion command.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">shallow_clone</span></tt></td>
<td>Indicates that the clone depth is set to 5. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>. This action only works with git.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">enable_submodules</span></tt></td>
<td>git only. Use to perform a sub-module initialization and update. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">remote</span></tt></td>
<td>git only. The remote repository to be used when synchronizing an existing clone. Default value: <tt class="docutils literal"><span class="pre">origin</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ssh_wrapper</span></tt></td>
<td>git only. The path to the wrapper script used when running SSH with git. The <tt class="docutils literal"><span class="pre">GIT_SSH</span></tt> environment variable is set to this.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">git_ssh_wrapper</span></tt></td>
<td>The alias for the <tt class="docutils literal"><span class="pre">ssh_wrapper</span></tt>. This attribute only works with git.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">scm_provider</span></tt></td>
<td>The name of the source control management provider to be used. Default value: <tt class="docutils literal"><span class="pre">Chef::Provider::Git</span></tt>. Optional values: <tt class="docutils literal"><span class="pre">Chef::Provider::Subversion</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">repository_cache</span></tt></td>
<td>The name of the sub-directory in which the pristine copy of an application&#8217;s source is kept. Default value: <tt class="docutils literal"><span class="pre">cached-copy</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">environment</span></tt></td>
<td>A hash of the form <tt class="docutils literal"><span class="pre">{&quot;ENV_VARIABLE&quot;=&gt;&quot;VALUE&quot;}</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">purge_before_symlink</span></tt></td>
<td>An array of paths, relative to the application root, that are to be removed from a checkout before symbolic linking. Default value: <tt class="docutils literal"><span class="pre">%w{log</span> <span class="pre">tmp/pids</span> <span class="pre">public/system}</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">create_dirs_before_symlink</span></tt></td>
<td>The directories to create before symbolic linking. This runs after <tt class="docutils literal"><span class="pre">purge_before_symlink</span></tt>. Default value: <tt class="docutils literal"><span class="pre">%w{tmp</span> <span class="pre">public</span> <span class="pre">config}</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">symlinks</span></tt></td>
<td>A hash that maps files in a shared directory to their paths in the current release. Default value: <tt class="docutils literal"><span class="pre">{&quot;system&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;public/system&quot;,</span> <span class="pre">&quot;pids&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;tmp/pids&quot;,</span> <span class="pre">&quot;log&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;log&quot;}</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">symlink_before_migrate</span></tt></td>
<td>A hash that maps files in a shared directory into the current release. Runs before migration. Default value: <tt class="docutils literal"><span class="pre">{&quot;config/database.yml&quot;</span> <span class="pre">=&gt;</span> <span class="pre">&quot;config/database.yml&quot;}</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">migrate</span></tt></td>
<td>Indicates that the migration command will be run. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">migration_command</span></tt></td>
<td>A string that contains a shell command that can be executed to run a migration operation.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">restart_command</span></tt></td>
<td>A string that contains a shell command that can be executed to run a restart operation . Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rollback_on_error</span></tt></td>
<td>Indicates whether a deploy resource will rollback to a previously-deployed release if an error occurs when deploying a new release. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">before_migrate</span></tt></td>
<td>A block or path to a file that contains Chef code that is run before a migration. Default value: <tt class="docutils literal"><span class="pre">deploy/before_migrate.rb</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">before_symlink</span></tt></td>
<td>A block or path to a file that contains Chef code that is run before symbolic linking. Default value: <tt class="docutils literal"><span class="pre">deploy/before_symlink.rb</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">before_restart</span></tt></td>
<td>A block or path to a file that contains Chef code that is run before restarting. Default value: <tt class="docutils literal"><span class="pre">deploy/before_restart.rb</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">after_restart</span></tt></td>
<td>A block or path to a file that contains Chef code that is run after restarting. Default value: <tt class="docutils literal"><span class="pre">deploy/after_restart.rb</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id15">
<h4>Providers<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>The Deploy resource providers are used to determine whether to deploy based on whether the release directory in which the deployment is to be made actually exists. Use the following providers to use the Deploy resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Deploy::TimstampedDeploy</span></tt></td>
<td><tt class="docutils literal"><span class="pre">timestamped_deploy</span></tt>. See below for more information.</td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Deploy::Revision</span></tt></td>
<td><tt class="docutils literal"><span class="pre">deploy_revision</span></tt>, <tt class="docutils literal"><span class="pre">deploy_branch</span></tt></td>
<td>&nbsp;</td>
<td>See below for more information.</td>
</tr>
</tbody>
</table>
<div class="section" id="timestamped-deploy">
<h5><tt class="docutils literal"><span class="pre">timestamped_deploy</span></tt><a class="headerlink" href="#timestamped-deploy" title="Permalink to this headline">¶</a></h5>
<p>The <tt class="docutils literal"><span class="pre">timestamped_deploy</span></tt> provider is the default Deploy provider. It is used to name release directories with a timestamp in the form of <tt class="docutils literal"><span class="pre">YYYYMMDDHHMMSS</span></tt>. For example: <tt class="docutils literal"><span class="pre">/my/deploy/dir/releases/20121120162342</span></tt>. The Deploy resource will determine whether or not to deploy code based on the existence of the release directory in which it is attempting to deploy. Because the timestamp is different for every Chef run, the <tt class="docutils literal"><span class="pre">timestamped_deploy</span></tt> provider is not idempotent. When the <tt class="docutils literal"><span class="pre">timestamped_deploy</span></tt> provider is used, it will require managing the action setting on the resource manually in order to prevent unintended continuous deployment.</p>
</div>
<div class="section" id="deploy-revision-and-deploy-branch">
<h5><tt class="docutils literal"><span class="pre">deploy_revision</span></tt> and <tt class="docutils literal"><span class="pre">deploy_branch</span></tt><a class="headerlink" href="#deploy-revision-and-deploy-branch" title="Permalink to this headline">¶</a></h5>
<p>The <tt class="docutils literal"><span class="pre">deploy_revision</span></tt> provider is the recommended provider, even if it is not listed as the default. The <tt class="docutils literal"><span class="pre">deploy_revision</span></tt> provider is used to ensure that the name of a release sub-directory is based on a revision identifier. For users of git, this will be the familiar SHA checksum. For users of Subversion, it will be the integer revision number. If a name other than a revision identifier is provided&#8212;branch names, tags, and so on&#8212;Chef will ignore the alternate names and will look up the revision identifier and use it to name the release sub-directory. When the <tt class="docutils literal"><span class="pre">deploy_revision</span></tt> provider is given an exact revision to deploy, it will behave in an idempotent manner. The <tt class="docutils literal"><span class="pre">deploy_revision</span></tt> provider results in deployed components under the destination location that is owned by the user who runs the application. This is sometimes an issue for certain workflows. If issues arise, consider the following: incorporate changing permissions to the desired end state from within a recipe; add a <tt class="docutils literal"><span class="pre">before_restart</span></tt> block to fix up the permissions; have an unprivileged user (for example: <tt class="docutils literal"><span class="pre">opscode</span></tt>) be the owner of the <tt class="docutils literal"><span class="pre">deploy</span></tt> directory and another unprivileged user (for example: <tt class="docutils literal"><span class="pre">opscodeapp</span></tt>) run the application. Most often, this is the solution that works best. When using the <tt class="docutils literal"><span class="pre">deploy_revision</span></tt> provider, and when the deploy fails for any reason, and when the same code is used to re-deploy, the action should be set manually to <tt class="docutils literal"><span class="pre">:force_deploy</span></tt>. Forcing the re-deploy will remove the old release directory, after which the deploy can proceed as usual. (Forcing a re-deploy over the current release can cause some downtime.) Deployed revisions are stored in <tt class="docutils literal"><span class="pre">(file_cache_path)/revision-deploys/(deploy_path)</span></tt>. <strong>jamescott: LEFT HERE FOR NOW: &#8220;You could also use this in more interesting ways, for example, if you have a &#8220;deploy&#8221; or &#8220;production&#8221; branch in git, you can set the provider to track this branch. This will cause your deployment to get updated the next time chef runs after pushing to that branch.&#8221; BUT IT&#8217;S PROBABLY A HIGHER-LEVEL IDEA RATHER THAN A TWO-SENTENCE COMMENT AT THE END OF A TOPIC BURIED IN A REFERENCE.</strong></p>
</div>
</div>
<div class="section" id="id16">
<h4>Examples<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>If you only want people who have access to your Chef organization to get access to this key, you could add it to an encrypted data bag instead. You could also add the repository, deploy_to, etc to the data bag if desired as well.</p>
<p>To add a private key to a node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
  <span class="s2">&quot;repository&quot;</span><span class="p">:</span> <span class="s2">&quot;git@github.com:acctname/private-repo.git&quot;</span><span class="p">,</span>
  <span class="s2">&quot;deploy_key&quot;</span><span class="p">:</span> <span class="s2">&quot;-----BEGIN RSA PRIVATE KEY-----</span><span class="se">\n</span><span class="s2">MIIEogIBAAKCAQEAoEN9TWqCSMvdfjke</span><span class="se">\n</span><span class="s2"> …truncated…&quot;</span><span class="p">,</span>
  <span class="s2">&quot;deploy_to&quot;</span><span class="p">:</span> <span class="s2">&quot;/tmp/private_code&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Remember to convert new lines in the private key to n when copying it to the data bag. Then you can use a file block within the recipe to add it to the node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="no">Chef</span><span class="o">::</span><span class="no">EncryptedDataBagItem</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;deploytest&#39;</span><span class="p">,</span> <span class="s1">&#39;app&#39;</span><span class="p">)</span>

<span class="n">file</span> <span class="s2">&quot;/tmp/private_code/.ssh/id_deploy&quot;</span> <span class="k">do</span>
  <span class="n">content</span> <span class="n">app</span><span class="o">[</span><span class="s1">&#39;deploy_key&#39;</span><span class="o">]</span>
  <span class="n">owner</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">mode</span> <span class="mo">0600</span>
<span class="k">end</span>
</pre></div>
</div>
<p>If there isn&#8217;t much concern about people being able to view the key, add the private key to <tt class="docutils literal"><span class="pre">cookbook/COOKBOOK_NAME/files/default/id_deploy</span></tt> and use a <tt class="docutils literal"><span class="pre">cookbook_file</span></tt> block somewhere in the recipe to add it to the SSH file locally on the node.</p>
<p>To add a private key to a node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">cookbook_file</span> <span class="s2">&quot;/tmp/private_code/.ssh/id_deploy&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;id_deploy&quot;</span>
  <span class="n">owner</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">mode</span> <span class="mo">0600</span>
<span class="k">end</span>
</pre></div>
</div>
<p>After this has been added to a recipe, it should be able to deploy the private repository.</p>
<p>Basic attribute usage</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">deploy</span> <span class="s2">&quot;/my/deploy/dir&quot;</span> <span class="k">do</span>
  <span class="n">repo</span> <span class="s2">&quot;git@github.com/whoami/project&quot;</span>
  <span class="n">revision</span> <span class="s2">&quot;abc123&quot;</span> <span class="c1"># or &quot;HEAD&quot; or &quot;TAG_for_1.0&quot; or (subversion) &quot;1234&quot;</span>
  <span class="n">user</span> <span class="s2">&quot;deploy_ninja&quot;</span>
  <span class="n">enable_submodules</span> <span class="kp">true</span>
  <span class="n">migrate</span> <span class="kp">true</span>
  <span class="n">migration_command</span> <span class="s2">&quot;rake db:migrate&quot;</span>
  <span class="n">environment</span> <span class="s2">&quot;RAILS_ENV&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;production&quot;</span><span class="p">,</span> <span class="s2">&quot;OTHER_ENV&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;foo&quot;</span>
  <span class="n">shallow_clone</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="ss">:deploy</span> <span class="c1"># or :rollback</span>
  <span class="n">restart_command</span> <span class="s2">&quot;touch tmp/restart.txt&quot;</span>
  <span class="n">git_ssh_wrapper</span> <span class="s2">&quot;wrap-ssh4git.sh&quot;</span>
  <span class="n">scm_provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Git</span> <span class="c1"># is the default, for svn: Chef::Provider::Subversion</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To customize the application layout:
The layout of the application matches a Rails app by default, but you can customize it to fit your needs</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">deploy</span> <span class="s2">&quot;/my/apps/dir/deploy&quot;</span> <span class="k">do</span>
  <span class="c1"># Use a local repo if you prefer</span>
  <span class="n">repo</span> <span class="s2">&quot;/path/to/gitrepo/typo/&quot;</span>
  <span class="n">environment</span> <span class="s2">&quot;RAILS_ENV&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;production&quot;</span>
  <span class="n">revision</span> <span class="s2">&quot;HEAD&quot;</span>
  <span class="n">action</span> <span class="ss">:deploy</span>
  <span class="n">migration_command</span> <span class="s2">&quot;rake db:migrate --trace&quot;</span>
  <span class="n">migrate</span> <span class="kp">true</span>
  <span class="n">restart_command</span> <span class="s2">&quot;touch tmp/restart.txt&quot;</span>
  <span class="n">create_dirs_before_symlink</span>  <span class="sx">%w{tmp public config deploy}</span>

  <span class="c1"># You can use this to customize if your app has extra configuration files</span>
  <span class="c1"># such as amqp.yml or app_config.yml</span>
  <span class="n">symlink_before_migrate</span>  <span class="s2">&quot;config/database.yml&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;config/database.yml&quot;</span>

  <span class="c1"># If your app has extra files in the shared folder, specify them here</span>
  <span class="n">symlinks</span>  <span class="s2">&quot;system&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;public/system&quot;</span><span class="p">,</span> <span class="s2">&quot;pids&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;tmp/pids&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
            <span class="s2">&quot;deploy/before_migrate.rb&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;deploy/before_migrate.rb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;deploy/before_symlink.rb&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;deploy/before_symlink.rb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;deploy/before_restart.rb&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;deploy/before_restart.rb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;deploy/after_restart.rb&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;deploy/after_restart.rb&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use embedded recipes for callbacks:
Using resources from within your callbacks as blocks or within callback files distributed with your application&#8217;s source code</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">deploy</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="ss">:tmpdir</span><span class="o">]</span><span class="si">}</span><span class="s2">/deploy&quot;</span> <span class="k">do</span>
  <span class="n">repo</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="ss">:tmpdir</span><span class="o">]</span><span class="si">}</span><span class="s2">/gitrepo/typo/&quot;</span>
  <span class="n">environment</span> <span class="s2">&quot;RAILS_ENV&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;production&quot;</span>
  <span class="n">revision</span> <span class="s2">&quot;HEAD&quot;</span>
  <span class="n">action</span> <span class="ss">:deploy</span>
  <span class="n">migration_command</span> <span class="s2">&quot;rake db:migrate --trace&quot;</span>
  <span class="n">migrate</span> <span class="kp">true</span>

  <span class="c1"># Callback awesomeness:</span>
  <span class="n">before_migrate</span> <span class="k">do</span>
    <span class="n">current_release</span> <span class="o">=</span> <span class="n">release_path</span>

    <span class="n">directory</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">current_release</span><span class="si">}</span><span class="s2">/deploy&quot;</span> <span class="k">do</span>
      <span class="n">mode</span> <span class="s2">&quot;0755&quot;</span>
    <span class="k">end</span>

    <span class="c1"># creates a callback for before_symlink</span>
    <span class="n">template</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">current_release</span><span class="si">}</span><span class="s2">/deploy/before_symlink_callback.rb&quot;</span> <span class="k">do</span>
      <span class="n">source</span> <span class="s2">&quot;embedded_recipe_before_symlink.rb.erb&quot;</span>
      <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
    <span class="k">end</span>

  <span class="k">end</span>

  <span class="c1"># This file can contain Chef recipe code, plain ruby also works</span>
  <span class="n">before_symlink</span> <span class="s2">&quot;deploy/before_symlink_callback.rb&quot;</span>

  <span class="n">restart</span> <span class="k">do</span>
    <span class="n">current_release</span> <span class="o">=</span> <span class="n">release_path</span>
    <span class="n">file</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">release_path</span><span class="si">}</span><span class="s2">/tmp/restart.txt&quot;</span> <span class="k">do</span>
      <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>

<span class="k">end</span>
</pre></div>
</div>
<p>To deploy from a private git repository without using the application cookbook:</p>
<p>To deploy from a private git repositopry without using the application cookbook, the following will need to happen:</p>
<ul class="simple">
<li>the private key cannot have a passphrase, as this will pause a Chef run to wait for input</li>
<li>an SSH wrapper must be used</li>
<li>a private key must be added to the node</li>
</ul>
<p>To remove a passphrase from a private key:</p>
<div class="highlight-bash"><div class="highlight"><pre>ssh-keygen -p -P <span class="s1">&#39;YOURPASSPHRASE&#39;</span> -N <span class="s1">&#39;&#39;</span> -f id_deploy
</pre></div>
</div>
<p>To write a recipe that uses an SSH wrapper:</p>
<ol class="arabic">
<li><p class="first">Create a file in the <tt class="docutils literal"><span class="pre">cookbooks/COOKBOOK_NAME/files/default</span></tt> directory that is named <tt class="docutils literal"><span class="pre">wrap-ssh4git.sh</span></tt> and which contains the following:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="c1">#!/usr/bin/env bash</span>
<span class="sr">/usr/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span> <span class="n">ssh</span> <span class="o">-</span><span class="n">o</span> <span class="s2">&quot;StrictHostKeyChecking=no&quot;</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&quot;/tmp/private_code/.ssh/id_deploy&quot;</span> <span class="vg">$1</span> <span class="vg">$2</span>
</pre></div>
</div>
</li>
<li><p class="first">Set up the cookbook file.</p>
</li>
<li><p class="first">Add a recipe to the cookbook file similar to the following:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">directory</span> <span class="s2">&quot;/tmp/private_code/.ssh&quot;</span> <span class="k">do</span>
  <span class="n">owner</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">recursive</span> <span class="kp">true</span>
<span class="k">end</span>

<span class="n">cookbook_file</span> <span class="s2">&quot;/tmp/private_code/wrap-ssh4git.sh&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;wrap-ssh4git.sh&quot;</span>
  <span class="n">owner</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">mode</span> <span class="mo">0700</span>
<span class="k">end</span>

<span class="n">deploy</span> <span class="s2">&quot;private_repo&quot;</span> <span class="k">do</span>
  <span class="n">repo</span> <span class="s2">&quot;git@github.com:acctname/private-repo.git&quot;</span>
  <span class="n">user</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">deploy_to</span> <span class="s2">&quot;/tmp/private_code&quot;</span>
  <span class="n">action</span> <span class="ss">:deploy</span>
  <span class="n">ssh_wrapper</span> <span class="s2">&quot;/tmp/private_code/wrap-ssh4git.sh&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>This will deploy the git repository at <tt class="docutils literal"><span class="pre">git&#64;github.com:acctname/private-repo.git</span></tt> in the <tt class="docutils literal"><span class="pre">/tmp/private_code</span></tt> directory.</p>
</li>
</ol>
<p>To use the same API when using the <tt class="docutils literal"><span class="pre">git-deploy</span></tt> gems:
Any recipes using the git-deploy gem can continue using the same API</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">deploy</span> <span class="s2">&quot;/srv/</span><span class="si">#{</span><span class="n">appname</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
  <span class="n">repo</span> <span class="s2">&quot;git://github.com/radiant/radiant.git&quot;</span>
  <span class="n">revision</span> <span class="s2">&quot;HEAD&quot;</span>
  <span class="n">user</span> <span class="s2">&quot;railsdev&quot;</span>
  <span class="n">enable_submodules</span> <span class="kp">false</span>
  <span class="n">migrate</span> <span class="kp">true</span>
  <span class="n">migration_command</span> <span class="s2">&quot;rake db:migrate&quot;</span>
  <span class="c1"># Giving a string for environment sets RAILS_ENV, MERB_ENV, RACK_ENV</span>
  <span class="n">environment</span> <span class="s2">&quot;production&quot;</span>
  <span class="n">shallow_clone</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="ss">:deploy</span>
  <span class="n">restart_command</span> <span class="s2">&quot;touch tmp/restart.txt&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To deploy without symlinking to shared:
When deploying non-rails code and you don&#8217;t want any symlinks to the shared folder, use parentheses or Hash.new to avoid an ambiguity in Ruby</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">deploy</span> <span class="s2">&quot;/my/apps/dir/deploy&quot;</span> <span class="k">do</span>
  <span class="c1"># OTHER PARAMETERS</span>
  <span class="c1"># ...</span>

  <span class="c1"># THIS DOESN&#39;T WORK, the {} gets parsed as a code block:</span>
  <span class="n">symlinks</span> <span class="p">{}</span>
  <span class="c1"># Instead, use parentheses:</span>
  <span class="n">symlinks</span><span class="p">({})</span>
  <span class="c1"># Or create your hash by calling new instead of using a literal:</span>
  <span class="n">symlinks</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="directory">
<h3>directory<a class="headerlink" href="#directory" title="Permalink to this headline">¶</a></h3>
<p>The Directory resource is used to manage a directory.</p>
<div class="section" id="id17">
<h4>Actions<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a directory.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete a directory.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id18">
<h4>Attributes<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>A string or ID that identifies the group owner of a file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mode</span></tt></td>
<td>The octal mode of the file. When specifying <tt class="docutils literal"><span class="pre">mode</span></tt>, the value can be a quoted string (&#8220;644&#8221;). For a numeric value, it should be five digits (&#8220;00644&#8221;) to ensure that it is correctly parsed by Ruby. The default value for this attribute varies.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rights</span></tt></td>
<td>Microsoft Windows only. The permissions for users and groups in a Microsoft Windows environment. For example: <tt class="docutils literal"><span class="pre">rights</span> <span class="pre">&lt;permissions&gt;,</span> <span class="pre">&lt;principal&gt;,</span> <span class="pre">&lt;options&gt;</span></tt> where <tt class="docutils literal"><span class="pre">&lt;permissions&gt;</span> <span class="pre">is</span> <span class="pre">specifies</span> <span class="pre">the</span> <span class="pre">rights</span> <span class="pre">granted</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">principal,</span> <span class="pre">``&lt;principal&gt;</span></tt> is the group or user name, and <tt class="docutils literal"><span class="pre">&lt;options</span></tt>&gt; is a hash with one (or more) advanced rights options.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">inherits</span></tt></td>
<td>Microsoft Windows only. Indicates that the file inherits rights from its parent. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of the directory.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to the directory. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">recursive</span></tt></td>
<td>Indicates whether the directory will be created or deleted recursively. For the <tt class="docutils literal"><span class="pre">owner</span></tt>, <tt class="docutils literal"><span class="pre">group</span></tt>, and <tt class="docutils literal"><span class="pre">mode</span></tt> attributes, the value of this attribute applies only to the leaf directory. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id19">
<h4>Providers<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Directory resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Directory</span></tt></td>
<td><tt class="docutils literal"><span class="pre">directory</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id20">
<h4>Examples<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>To create a directory:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">directory</span> <span class="s2">&quot;/tmp/something&quot;</span> <span class="k">do</span>
  <span class="n">owner</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">group</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;0755&quot;</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To create a directory in Microsoft Windows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">directory</span> <span class="s2">&quot;C:</span><span class="se">\t</span><span class="s2">mp</span><span class="se">\s</span><span class="s2">omething.txt&quot;</span> <span class="k">do</span>
  <span class="n">rights</span> <span class="ss">:full_control</span><span class="p">,</span> <span class="s2">&quot;DOMAIN\User&quot;</span>
  <span class="n">inherits</span> <span class="kp">false</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To create a directory recursively:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="sx">%w{dir1 dir2 dir3}</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">dir</span><span class="o">|</span>
  <span class="n">directory</span> <span class="s2">&quot;/tmp/mydirs/</span><span class="si">#{</span><span class="n">dir</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
    <span class="n">mode</span> <span class="s2">&quot;0775&quot;</span>
    <span class="n">owner</span> <span class="s2">&quot;root&quot;</span>
    <span class="n">group</span> <span class="s2">&quot;root&quot;</span>
    <span class="n">action</span> <span class="ss">:create</span>
    <span class="n">recursive</span> <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To delete a directory:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">directory</span> <span class="s2">&quot;/tmp/something&quot;</span> <span class="k">do</span>
  <span class="n">recursive</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="ss">:delete</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="env">
<h3>env<a class="headerlink" href="#env" title="Permalink to this headline">¶</a></h3>
<p>The Env resource is used to manage environment keys in Microsoft Windows. After an environment key is set, Microsoft Windows must be restarted before the environment key will be available to the Task Scheduler.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On UNIX-based systems, the best way to manipulate environment keys is with the ENV variable in Ruby; however, this approach does not have the same &#8220;permanent&#8221; effect as using the <tt class="docutils literal"><span class="pre">env</span></tt> resource.</p>
</div>
<div class="section" id="id21">
<h4>Actions<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a new environment variable.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete an environment variable.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:modify</span></tt></td>
<td>Use to modify an existing environment variable. This will append the new value to the existing value, using the delimiter specified by the <tt class="docutils literal"><span class="pre">delim</span></tt> attribute.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id22">
<h4>Attributes<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">key_name</span></tt></td>
<td>The name of the key that will be created, deleted, or modified. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">value</span></tt></td>
<td>The value with which <tt class="docutils literal"><span class="pre">key_name</span></tt> is set.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">delim</span></tt></td>
<td>The delimiter that is used to separate multiple values for a single key.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id23">
<h4>Providers<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Env resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Env::Windows</span></tt></td>
<td><tt class="docutils literal"><span class="pre">env</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all Microsoft Windows platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id24">
<h4>Examples<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h4>
<p>To set an environment variable:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">env</span> <span class="s2">&quot;ComSpec&quot;</span> <span class="k">do</span>
  <span class="n">value</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Windows</span><span class="se">\\</span><span class="s2">system32</span><span class="se">\\</span><span class="s2">cmd.exe&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="erlang-call">
<h3>erlang_call<a class="headerlink" href="#erlang-call" title="Permalink to this headline">¶</a></h3>
<p>The Erlang Call resource is used to connect to a node located within a distributed Erlang system. An Erlang Call resource is not idempotent. Use the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> meta parameters to guard the use of this resource for idempotence.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">erl_call</span></tt> command needs to be on the path for this resource to work properly. <strong>jamescott: HOW DO WE KNOW IF THE erl_call COMMAND IS &#8220;ON THE PATH&#8221;?</strong></p>
</div>
<div class="section" id="id25">
<h4>Actions<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:run</span></tt></td>
<td>Default. Indicates that the Erlang call should be run.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:nothing</span></tt></td>
<td>Indicates that the Erlang call should not be run.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id26">
<h4>Attributes<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">code</span></tt></td>
<td>The code to be executed on a node located within a distributed Erlang system. Default value: <tt class="docutils literal"><span class="pre">q()</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">cookie</span></tt></td>
<td>The magic cookie for the node to which a connection is made.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">distributed</span></tt></td>
<td>Indicates that a node is a distributed Erlang node. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">name_type</span></tt></td>
<td>Indicates whether the <tt class="docutils literal"><span class="pre">node_name</span></tt> attribute is a short node name (<tt class="docutils literal"><span class="pre">sname</span></tt>) or a long node name (<tt class="docutils literal"><span class="pre">name</span></tt>). A node with a long node name cannot communicate with a node with a short node name. Default value: <tt class="docutils literal"><span class="pre">sname</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node_name</span></tt></td>
<td>The hostname to which the node will connect. Default value: <tt class="docutils literal"><span class="pre">chef&#64;localhost</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id27">
<h4>Providers<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Erlang Call resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::ErlCall</span></tt></td>
<td><tt class="docutils literal"><span class="pre">erl_call</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id28">
<h4>Examples<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h4>
<p>To run a command on an Erlang node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">erl_call</span> <span class="s2">&quot;list names&quot;</span> <span class="k">do</span>
  <span class="n">code</span> <span class="s2">&quot;net_adm:names().&quot;</span>
  <span class="n">distributed</span> <span class="kp">true</span>
  <span class="n">node_name</span> <span class="s2">&quot;chef@latte&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="execute">
<h3>execute<a class="headerlink" href="#execute" title="Permalink to this headline">¶</a></h3>
<p>The Execute resource is used to execute a command. Commands that are executed with this resource are (by their nature) not idempotent, as they are typically unique to the environment in which they are run. Use the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> meta parameters to guard the use of this resource for idempotence.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use the Script resource to execute a script using a specific interpreter (Ruby, Python, Perl, Csh, or Bash).</p>
</div>
<div class="section" id="id29">
<h4>Actions<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:run</span></tt></td>
<td>Default. Indicates that the command should be run.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:nothing</span></tt></td>
<td>Indicates that the command should not be run. This action is used to specify that a command is run only when another resource notifies it.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id30">
<h4>Attributes<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">command</span></tt></td>
<td>The name of the command that will be executed. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">creates</span></tt></td>
<td>Indicates that a command to create a file will not be run when that file already exists. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">cwd</span></tt></td>
<td>The current working directory from which a command will be run. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">environment</span></tt></td>
<td>A hash of environment variables that should be set before running a command. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>The group name or group ID that should be changed before running a command. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>An array of paths to use when searching for a command. These paths are not added to the command&#8217;s environment $PATH. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt> (uses system path).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">returns</span></tt></td>
<td>The return value for a command. This may be an array of accepted values. An exception is raised when the return value(s) do not match. Default value: <tt class="docutils literal"><span class="pre">0</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">timeout</span></tt></td>
<td>The amount of time (in seconds) the command will wait before timing out. Default value: <tt class="docutils literal"><span class="pre">3600</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">user</span></tt></td>
<td>The user name or user ID that should be changed before running a command. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">umask</span></tt></td>
<td>The file mode creation mask for files that are created by a command. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id31">
<h4>Providers<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Execute resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Execute</span></tt></td>
<td><tt class="docutils literal"><span class="pre">execute</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id32">
<h4>Examples<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h4>
<p>To execute a command only upon notification:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s2">&quot;slapadd&quot;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">&quot;slapadd &lt; /tmp/something.ldif&quot;</span>
  <span class="n">creates</span> <span class="s2">&quot;/var/lib/slapd/uid.bdb&quot;</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span>

<span class="n">template</span> <span class="s2">&quot;/tmp/something.ldif&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;something.ldif&quot;</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:execute</span> <span class="o">=&gt;</span> <span class="s2">&quot;slapadd&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To execute a command with a touch file running only once:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s2">&quot;upgrade script&quot;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">&quot;php upgrade-application.php &amp;&amp; touch /var/application/.upgraded&quot;</span>
  <span class="n">creates</span> <span class="s2">&quot;/var/application/.upgraded&quot;</span>
  <span class="n">action</span> <span class="ss">:run</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To execute a command with an environment variable:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s2">&quot;slapadd&quot;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">&quot;slapadd &lt; /tmp/something.ldif&quot;</span>
  <span class="n">creates</span> <span class="s2">&quot;/var/lib/slapd/uid.bdb&quot;</span>
  <span class="n">action</span> <span class="ss">:run</span>
  <span class="n">environment</span> <span class="p">({</span><span class="s1">&#39;HOME&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/home/myhome&#39;</span><span class="p">})</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="file">
<h3>file<a class="headerlink" href="#file" title="Permalink to this headline">¶</a></h3>
<p>The File resource is used to manage files that are present on a node, including setting or updating the contents of those files.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Other resources should be used to manage files that are not present on a node. Use Cookbook File when copying a file from a cookbook, Template when using a template, and Remote File when transferring files from remote locations.</p>
</div>
<div class="section" id="id33">
<h4>Actions<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:create_if_missing</span></tt></td>
<td>Use to create a file only if the file does not already exist. (When the file exists, nothing happens.)</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Default. Use to delete a file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:touch</span></tt></td>
<td>Use to touch a file. This updates the access (atime) and file modification (mtime) times for a file.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id34">
<h4>Attributes<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to the file. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">backup</span></tt></td>
<td>The number of backups of a file that should be kept. Set to <tt class="docutils literal"><span class="pre">false</span></tt> to prevent backups from being kept. Default value: <tt class="docutils literal"><span class="pre">5</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>A string or ID that identifies the group owner of the file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mode</span></tt></td>
<td>The octal mode of the file. When specifying <tt class="docutils literal"><span class="pre">mode</span></tt>, the value can be a quoted string (&#8220;644&#8221;). For a numeric value, it should be five digits (&#8220;00644&#8221;) to ensure that it is correctly parsed by Ruby. The default value for this attribute varies.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rights</span></tt></td>
<td>Microsoft Windows only. The permissions for users and groups in a Microsoft Windows environment. For example: <tt class="docutils literal"><span class="pre">rights</span> <span class="pre">&lt;permissions&gt;,</span> <span class="pre">&lt;principal&gt;,</span> <span class="pre">&lt;options&gt;</span></tt> where <tt class="docutils literal"><span class="pre">&lt;permissions&gt;</span> <span class="pre">is</span> <span class="pre">specifies</span> <span class="pre">the</span> <span class="pre">rights</span> <span class="pre">granted</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">principal,</span> <span class="pre">``&lt;principal&gt;</span></tt> is the group or user name, and <tt class="docutils literal"><span class="pre">&lt;options</span></tt>&gt; is a hash with one (or more) advanced rights options.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">inherits</span></tt></td>
<td>Microsoft Windows only. Indicates that the file inherits rights from its parent. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of the file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">content</span></tt></td>
<td>A string that is written to the file. The contents of this attribute will replace any previous content when this attribute has something other than the default value. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt> (don&#8217;t modify content).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id35">
<h4>Providers<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the File resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::File</span></tt></td>
<td><tt class="docutils literal"><span class="pre">file</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id36">
<h4>Examples<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h4>
<p>To create a file:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">file</span> <span class="s2">&quot;/tmp/something&quot;</span> <span class="k">do</span>
  <span class="n">owner</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">group</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;0755&quot;</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To create a file in Microsoft Windows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">file</span> <span class="s2">&quot;C:</span><span class="se">\t</span><span class="s2">mp</span><span class="se">\s</span><span class="s2">omething.txt&quot;</span> <span class="k">do</span>
  <span class="n">rights</span> <span class="ss">:read</span><span class="p">,</span> <span class="s2">&quot;Everyone&quot;</span>
  <span class="n">rights</span> <span class="ss">:full_control</span><span class="p">,</span> <span class="s2">&quot;DOMAIN\User&quot;</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To remove a file:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">file</span> <span class="s2">&quot;/tmp/something&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To set a file mode:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">file</span> <span class="s2">&quot;/tmp/something&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="s2">&quot;644&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">file</span> <span class="s2">&quot;/tmp/something&quot;</span> <span class="k">do</span>
  <span class="n">mode</span> <span class="mo">00644</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="group">
<h3>group<a class="headerlink" href="#group" title="Permalink to this headline">¶</a></h3>
<p>The Group resource is used to manage a local group.</p>
<div class="section" id="id37">
<h4>Actions<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a group.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a group.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:modify</span></tt></td>
<td>Use to modify an existing group. This action will raise an exception if the group does not exist.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:manage</span></tt></td>
<td>Use to manage an existing group. This action will do nothing if the group does not exist.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id38">
<h4>Attributes<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group_name</span></tt></td>
<td>A string or ID that identifies the name of the group. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">gid</span></tt></td>
<td>The group identifier. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">members</span></tt></td>
<td>Indicates that users are included in the group. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">append</span></tt></td>
<td>Indicates whether members are .  true: add these members to the group, false: these are the definitive group members   Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">system</span></tt></td>
<td>Indicates whether a group is a system group (<tt class="docutils literal"><span class="pre">true</span></tt>) or is not a system group (<tt class="docutils literal"><span class="pre">false</span></tt>). Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id39">
<h4>Providers<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h4>
<p>Use the following providers to use the Group resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Group::Dscl</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Mac OS X platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Group::Gpasswd</span></tt></td>
<td>&nbsp;</td>
<td>Yes</td>
<td>This is the default provider for all platforms except Mac OS X, FreeBSD, Oracle Solaris, and Microsoft Windows, which have their own dedicated providers.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Group::Pw</span></tt></td>
<td>&nbsp;</td>
<td>Yes</td>
<td>This is the default provider for the FreeBSD platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Group::Usermod</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Oracle Solaris platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Group::Windows</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Microsoft Windows platform.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id40">
<h4>Examples<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h4>
<p>To append a user to an existing group:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">group</span> <span class="s2">&quot;www-data&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:modify</span>
  <span class="n">members</span> <span class="s2">&quot;maintenance&quot;</span>
  <span class="n">append</span> <span class="kp">true</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="http-request">
<h3>http_request<a class="headerlink" href="#http-request" title="Permalink to this headline">¶</a></h3>
<p>The HTTP Request resource is used to send an HTTP request (GET, PUT, POST, DELETE, HEAD, or OPTIONS) with an arbitrary message. This resource is useful when custom callbacks are necessary.</p>
<div class="section" id="id41">
<h4>Actions<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:get</span></tt></td>
<td>Default. Use to send a GET request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:put</span></tt></td>
<td>Use to send a PUT request.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:post</span></tt></td>
<td>Use to send a POST request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to send a DELETE request.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:head</span></tt></td>
<td>Use to send a HEAD request.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:options</span></tt></td>
<td>Use to send an OPTIONS request.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id42">
<h4>Attributes<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">url</span></tt></td>
<td>The URL to which the HTTP request is sent. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">message</span></tt></td>
<td>The message that is sent by the HTTP request. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">headers</span></tt></td>
<td>A hash of custom headers. Default value: <tt class="docutils literal"><span class="pre">{}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id43">
<h4>Providers<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the HTTP Request resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::HttpRequest</span></tt></td>
<td><tt class="docutils literal"><span class="pre">http_request</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id44">
<h4>Examples<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h4>
<p>To send a GET request:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">http_request</span> <span class="s2">&quot;some_message&quot;</span> <span class="k">do</span>
  <span class="n">url</span> <span class="s2">&quot;http://example.com/check_in&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>The message is sent as &#8220;<a class="reference external" href="http://example.com/check_in?message=some_message">http://example.com/check_in?message=some_message</a>&#8221;.</p>
<p>To send a POST request, with a JSON message body and using basic authentication:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">http_request</span> <span class="s2">&quot;posting data&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:post</span>
  <span class="n">url</span> <span class="s2">&quot;http://example.com/check_in&quot;</span>
  <span class="n">message</span> <span class="ss">:some</span> <span class="o">=&gt;</span> <span class="s2">&quot;data&quot;</span>
  <span class="n">headers</span><span class="p">({</span><span class="s2">&quot;AUTHORIZATION&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Basic </span><span class="si">#{</span><span class="no">Base64</span><span class="o">.</span><span class="n">encode64</span><span class="p">(</span><span class="s2">&quot;username:password&quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>
<span class="k">end</span>
      <span class="no">JSON</span> <span class="n">message</span> <span class="n">body</span>
</pre></div>
</div>
<p>The message is posted as application/data and not multipart/form-data or application/x-www-form-urlencoded.</p>
</div>
</div>
<div class="section" id="ifconfig">
<h3>ifconfig<a class="headerlink" href="#ifconfig" title="Permalink to this headline">¶</a></h3>
<p>The Ifconfig resource is used to manage interfaces.</p>
<div class="section" id="id45">
<h4>Actions<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:add</span></tt></td>
<td>Default. Use to run ifconfig to configure a network interface and (on some platforms) write a configuration file for that network interface.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to run ifconfig to disable a network interface and (on some platforms) delete that network interface&#8217;s configuration file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to run ifconfig to enable a network interface.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:disable</span></tt></td>
<td>Use to run ifconfig to disable a network interface.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id46">
<h4>Attributes<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">target</span></tt></td>
<td>The network address that will be assigned to the network interface. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">device</span></tt></td>
<td>The network interface to be configured. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">hwaddr</span></tt></td>
<td>The hardware address for the network interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">inet_addr</span></tt></td>
<td>The Internet host address for the network interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">bcast</span></tt></td>
<td>The broadcast address for the network interface. One some platforms this attribute is not set with ifconfig, but is instead added to the startup configuration file for the network interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mask</span></tt></td>
<td>The netmask for the network interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">mtu</span></tt></td>
<td>The maximum transmission unit (MTU) for the network interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">metric</span></tt></td>
<td>The routing metric for the interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">onboot</span></tt></td>
<td>Indicates that the network interface should be brought up on boot when this value is set to <tt class="docutils literal"><span class="pre">yes</span></tt>. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">network</span></tt></td>
<td>The network address for the network interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">bootproto</span></tt></td>
<td>The boot protocol&#8212;such as &#8220;dhcp&#8221;&#8211;that is used by the network interface. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">onparent</span></tt></td>
<td>Indicates that the network interface should be brought up when its parent interface is brought up when this value is set to <tt class="docutils literal"><span class="pre">yes</span></tt>. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id47">
<h4>Providers<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Ifconfig resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Ifconfig</span></tt></td>
<td><tt class="docutils literal"><span class="pre">ifconfig</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms. Currently, this provider only writes out a start-up configuration file for the interface on Red Hat-based platforms (it writes to /etc/sysconfig/network-scripts/ifcfg-#{device_name}).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id48">
<h4>Examples<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h4>
<p>To configure a network interface:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">ifconfig</span> <span class="s2">&quot;192.186.0.1&quot;</span> <span class="k">do</span>
  <span class="n">device</span> <span class="s2">&quot;eth0&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="link">
<h3>link<a class="headerlink" href="#link" title="Permalink to this headline">¶</a></h3>
<p>The Link resource is used to create symbolic or hard links.</p>
<div class="section" id="id49">
<h4>Actions<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a link.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete a link.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id50">
<h4>Attributes<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">target_file</span></tt></td>
<td>The name of the link. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">to</span></tt></td>
<td>The actual file to which the link will be created.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">link_type</span></tt></td>
<td>The type of link: <tt class="docutils literal"><span class="pre">:symbolic</span></tt> or <tt class="docutils literal"><span class="pre">:hard</span></tt>. Default value: <tt class="docutils literal"><span class="pre">symbolic</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner associated with a symbolic link.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>A string or ID that identifies the group associated with a symbolic link.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id51">
<h4>Providers<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Link resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Link</span></tt></td>
<td><tt class="docutils literal"><span class="pre">link</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id52">
<h4>Examples<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h4>
<p>To create a symbolic link:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="c1"># ln -s /etc/passwd /tmp/passwd</span>
<span class="n">link</span> <span class="s2">&quot;/tmp/passwd&quot;</span> <span class="k">do</span>
  <span class="n">to</span> <span class="s2">&quot;/etc/passwd&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To create a hard link:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="c1"># ln /etc/passwd /tmp/passwd</span>
<span class="n">link</span> <span class="s2">&quot;/tmp/passwd&quot;</span> <span class="k">do</span>
  <span class="n">to</span> <span class="s2">&quot;/etc/passwd&quot;</span>
  <span class="n">link_type</span> <span class="ss">:hard</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To delete a link</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">link</span> <span class="s2">&quot;/tmp/mylink&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
  <span class="n">only_if</span> <span class="s2">&quot;test -L /tmp/mylink&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="log">
<h3>log<a class="headerlink" href="#log" title="Permalink to this headline">¶</a></h3>
<p>The Log resource is used to create log entries from a recipe.</p>
<div class="section" id="id53">
<h4>Actions<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:write</span></tt></td>
<td>Default. Use to write to log.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id54">
<h4>Attributes<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">level</span></tt></td>
<td>The level of logging that Chef will display. Chef uses the <tt class="docutils literal"><span class="pre">mixlib-log</span></tt> (<a class="reference external" href="https://github.com/opscode/mixlib-log">https://github.com/opscode/mixlib-log</a>) to handle logging behavior. Options (in order of priority): <tt class="docutils literal"><span class="pre">:debug</span></tt>, <tt class="docutils literal"><span class="pre">:info</span></tt>, <tt class="docutils literal"><span class="pre">:warn</span></tt>, <tt class="docutils literal"><span class="pre">:error</span></tt>, and <tt class="docutils literal"><span class="pre">:fatal</span></tt>. Default value: <tt class="docutils literal"><span class="pre">:info</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id55">
<h4>Providers<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Log resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Log::ChefLog</span></tt></td>
<td><tt class="docutils literal"><span class="pre">log</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id56">
<h4>Examples<a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h4>
<p>To set the info (default) logging level:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">log</span> <span class="s2">&quot;your string to log&quot;</span>
</pre></div>
</div>
<p>To set the debug logging level:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">log</span><span class="p">(</span><span class="s2">&quot;a debug string&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">level</span> <span class="ss">:debug</span> <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mdadm">
<h3>mdadm<a class="headerlink" href="#mdadm" title="Permalink to this headline">¶</a></h3>
<p>The MDADM resource is used to manage mdadm software RAID devices in a Linux environment. The MDADM provider will create and assemble an array, but it will not create the config file that is used to persist the array upon reboot. If the config file is required, it must be done by specifying a template with the correct array layout, and then by using the Mount provider to create a file systems table (fstab) entry.</p>
<div class="section" id="id57">
<h4>Actions<a class="headerlink" href="#id57" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a new array with per-device superblocks.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:assemble</span></tt></td>
<td>Use to assemble a previously created array into an active array.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:stop</span></tt></td>
<td>Use to stop an active array.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id58">
<h4>Attributes<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">raid_device</span></tt></td>
<td>The name of the RAID device. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">devices</span></tt></td>
<td>An array of devices to include in the RAID array.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">level</span></tt></td>
<td>The RAID level. Default value: <tt class="docutils literal"><span class="pre">1</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">chunk</span></tt></td>
<td>The chunk size. Default value: <tt class="docutils literal"><span class="pre">16</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id59">
<h4>Providers<a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the MDADM resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Mdadm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mdadm</span></tt></td>
<td>Yes</td>
<td>This is the default provider for the Linux platform.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id60">
<h4>Examples<a class="headerlink" href="#id60" title="Permalink to this headline">¶</a></h4>
<p>To create and assemble a RAID 1 array from two disks with a 64k chunks size:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mdadm</span> <span class="s2">&quot;/dev/md0&quot;</span> <span class="k">do</span>
  <span class="n">devices</span> <span class="o">[</span> <span class="s2">&quot;/dev/sda&quot;</span><span class="p">,</span> <span class="s2">&quot;/dev/sdb&quot;</span> <span class="o">]</span>
  <span class="n">level</span> <span class="mi">1</span>
  <span class="n">chunk</span> <span class="mi">64</span>
  <span class="n">action</span> <span class="o">[</span> <span class="ss">:create</span><span class="p">,</span> <span class="ss">:assemble</span> <span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mount">
<h3>mount<a class="headerlink" href="#mount" title="Permalink to this headline">¶</a></h3>
<p>The Ohai resource is used to reload the Ohai configuration on node. This allows recipes that have changed system attributes (such as adding a user) to refer to those attributes later in the recipe.</p>
<div class="section" id="id61">
<h4>Actions<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:mount</span></tt></td>
<td>Default. Use to mount a device.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:umount</span></tt></td>
<td>Use to unmount a device.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:remount</span></tt></td>
<td>Use to remount a device.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to add an entry to the file systems table (fstab).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:disable</span></tt></td>
<td>Use to remove an entry from the file systems table (fstab).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Order matters when passing multiple actions. For example: <tt class="docutils literal"><span class="pre">action</span> <span class="pre">[:mount,</span> <span class="pre">:enable]</span></tt> ensures that the file system is mounted before it is enabled.</p>
</div>
</div>
<div class="section" id="id62">
<h4>Attributes<a class="headerlink" href="#id62" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">mount_point</span></tt></td>
<td>The directory (or path) in which the device should be mounted. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">device</span></tt></td>
<td>Required for <tt class="docutils literal"><span class="pre">:umount</span></tt> and <tt class="docutils literal"><span class="pre">:remout</span></tt> actions (for the purpose of checking the mount command output for presence). The special block device or remote node, a label, or a uuid to be mounted. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">device_type</span></tt></td>
<td>The type of device: <tt class="docutils literal"><span class="pre">:device</span></tt>, <tt class="docutils literal"><span class="pre">:label</span></tt>, or <tt class="docutils literal"><span class="pre">:uuid</span></tt>. Default value: <tt class="docutils literal"><span class="pre">:device</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">fstype</span></tt></td>
<td>Required. The file system type (fstype) of the device. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>An array or string that contains mount options. If this value is a string, it will be converted to an array. Default value: <tt class="docutils literal"><span class="pre">defaults</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">dump</span></tt></td>
<td>The dump frequency (in days) used while creating a file systems table (fstab) entry. Default value: <tt class="docutils literal"><span class="pre">0</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">pass</span></tt></td>
<td>The pass number used by the file system check (fsck) command while creating a file systems table (fstab) entry. Default value: <tt class="docutils literal"><span class="pre">2</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">supports</span></tt></td>
<td>A hash of options for supported mount features. Default value: <tt class="docutils literal"><span class="pre">{</span> <span class="pre">:remount</span> <span class="pre">=&gt;</span> <span class="pre">false</span> <span class="pre">}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id63">
<h4>Providers<a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h4>
<p>Use the following providers to use the Mount resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Mount</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mount</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms, except for Microsoft Windows.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Mount::Windows</span></tt></td>
<td><tt class="docutils literal"><span class="pre">mount</span></tt></td>
<td>Yes</td>
<td>This is the default provider for the Microsoft Windows platform.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id64">
<h4>Examples<a class="headerlink" href="#id64" title="Permalink to this headline">¶</a></h4>
<p>To mount a labeled file system:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mount</span> <span class="s2">&quot;/mnt/volume1&quot;</span> <span class="k">do</span>
  <span class="n">device</span> <span class="s2">&quot;volume1&quot;</span>
  <span class="n">device_type</span> <span class="ss">:label</span>
  <span class="n">fstype</span> <span class="s2">&quot;xfs&quot;</span>
  <span class="n">options</span> <span class="s2">&quot;rw&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To mount a local block device:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mount</span> <span class="s2">&quot;/mnt/local&quot;</span> <span class="k">do</span>
  <span class="n">device</span> <span class="s2">&quot;/dev/sdb1&quot;</span>
  <span class="n">fstype</span> <span class="s2">&quot;ext3&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To mount a non-block file system</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mount</span> <span class="s2">&quot;/mount/tmp&quot;</span> <span class="k">do</span>
  <span class="n">pass</span>     <span class="mi">0</span>
  <span class="n">fstype</span>   <span class="s2">&quot;tmpfs&quot;</span>
  <span class="n">device</span>   <span class="s2">&quot;/dev/null&quot;</span>
  <span class="n">options</span>  <span class="s2">&quot;nr_inodes=999k,mode=755,size=500m&quot;</span>
  <span class="n">action</span>   <span class="o">[</span><span class="ss">:mount</span><span class="p">,</span> <span class="ss">:enable</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To mount a remote file system and add to fstab:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mount</span> <span class="s2">&quot;/export/www&quot;</span> <span class="k">do</span>
  <span class="n">device</span> <span class="s2">&quot;nas1prod:/export/web_sites&quot;</span>
  <span class="n">fstype</span> <span class="s2">&quot;nfs&quot;</span>
  <span class="n">options</span> <span class="s2">&quot;rw&quot;</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:mount</span><span class="p">,</span> <span class="ss">:enable</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To mount a remote file system:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mount</span> <span class="s2">&quot;/export/www&quot;</span> <span class="k">do</span>
  <span class="n">device</span> <span class="s2">&quot;nas1prod:/export/web_sites&quot;</span>
  <span class="n">fstype</span> <span class="s2">&quot;nfs&quot;</span>
  <span class="n">options</span> <span class="s2">&quot;rw&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To mount a remote Microsoft Windows folder on local drive letter T:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mount</span> <span class="s2">&quot;T:&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:mount</span>
  <span class="n">device</span> <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">hostname.example.com</span><span class="se">\\</span><span class="s2">folder&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To un-mount a remote Microsoft Windows D: drive attached as local drive letter T:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mount</span> <span class="s2">&quot;T:&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:umount</span>
  <span class="n">device</span> <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">hostname.example.com</span><span class="se">\\</span><span class="s2">D$&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ohai">
<h3>ohai<a class="headerlink" href="#ohai" title="Permalink to this headline">¶</a></h3>
<p>The Ohai resource is used to re-load the Ohai configuration on a node. This allows recipes that change system attributes (like adding a user) to refer to those attributes later on during the Chef run.</p>
<div class="section" id="id65">
<h4>Actions<a class="headerlink" href="#id65" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:reload</span></tt></td>
<td>Default. Use to reload the Ohai configuration on a node.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id66">
<h4>Attributes<a class="headerlink" href="#id66" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">plugin</span></tt></td>
<td>Optional. Indicates that only the specified plug-ins are reloaded by Ohai. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt> (all plug-ins are reloaded ).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id67">
<h4>Providers<a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Ohai resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Ohai</span></tt></td>
<td><tt class="docutils literal"><span class="pre">ohai</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id68">
<h4>Examples<a class="headerlink" href="#id68" title="Permalink to this headline">¶</a></h4>
<p>To reload Ohai:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">ohai</span> <span class="s2">&quot;reload&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:reload</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To reload Ohai configuration after a new user is created:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">ohai</span> <span class="s2">&quot;reload_passwd&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
  <span class="n">plugin</span> <span class="s2">&quot;passwd&quot;</span>
<span class="k">end</span>

<span class="n">user</span> <span class="s2">&quot;daemonuser&quot;</span> <span class="k">do</span>
  <span class="n">home</span> <span class="s2">&quot;/dev/null&quot;</span>
  <span class="n">shell</span> <span class="s2">&quot;/sbin/nologin&quot;</span>
  <span class="nb">system</span> <span class="kp">true</span>
  <span class="n">notifies</span> <span class="ss">:reload</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:ohai</span> <span class="o">=&gt;</span> <span class="s2">&quot;reload_passwd&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
<span class="k">end</span>

<span class="n">ruby_block</span> <span class="s2">&quot;just an example&quot;</span> <span class="k">do</span>
  <span class="n">block</span> <span class="k">do</span>
    <span class="c1"># These variables will now have the new values</span>
    <span class="nb">puts</span> <span class="n">node</span><span class="o">[</span><span class="ss">:etc</span><span class="o">][</span><span class="ss">:passwd</span><span class="o">][</span><span class="ss">:daemonuser</span><span class="o">][</span><span class="ss">:uid</span><span class="o">]</span>
    <span class="nb">puts</span> <span class="n">node</span><span class="o">[</span><span class="ss">:etc</span><span class="o">][</span><span class="ss">:passwd</span><span class="o">][</span><span class="ss">:daemonuser</span><span class="o">][</span><span class="ss">:gid</span><span class="o">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="package">
<h3>package<a class="headerlink" href="#package" title="Permalink to this headline">¶</a></h3>
<p>The Package resource is used to manage packages. When the package is installed from a local file (such as RubyGems dkpg or RPM Package Manager) the file must be added to the node using the Remote File or Cookbook File resources.</p>
<div class="section" id="gem-package-options">
<h4>Gem Package Options<a class="headerlink" href="#gem-package-options" title="Permalink to this headline">¶</a></h4>
<p>The RubyGems package provider attempts to use the RubyGems API to install gems without spawning a new process, whenever possible. A gems command to install will be spawned under the following conditions:</p>
<ul class="simple">
<li>When a <tt class="docutils literal"><span class="pre">gem_binary</span></tt> attribute is specified (as a hash, a string, or by a .gemrc file), the provider will run that command to examine its environment settings and then again to install the gem.</li>
<li>When install options are specified as a string, the provider will span a gems command with those options when installing the gem.</li>
<li>The omnibus installer will search the PATH for a gem command rather than defaulting to the current gem environment. As part of <tt class="docutils literal"><span class="pre">enforce_path_sanity</span></tt>, the <tt class="docutils literal"><span class="pre">bin</span></tt> directories area dded to the PATH, which means when there are no other proceeding RubyGems, the installation will still be operated against it. <strong>jamescott: THIS IS CONFUSING IN THE WIKI AND IS STILL CONFUSING HERE. JTIMBERMAN OR BMCLELLAN SHOULD REVIEW.</strong></li>
</ul>
<div class="section" id="specify-options-with-a-hash">
<h5>Specify Options with a Hash<a class="headerlink" href="#specify-options-with-a-hash" title="Permalink to this headline">¶</a></h5>
<p>If an explicit <tt class="docutils literal"><span class="pre">gem_binary</span></tt> parameter is not being used with the <tt class="docutils literal"><span class="pre">gem_package</span></tt> resource, it is preferable to provide the install options as a hash. This approach allows the provider to install the gem without needing to spawn an external gem process.</p>
<p>The following RubyGems options are available for inclusion within a hash and are passed to the RubyGems DependencyInstaller:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:env_shebang</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:force</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:format_executable</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:ignore_dependencies</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:prerelease</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:security_policy</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:wrappers</span></tt></li>
</ul>
<p>For more information about these options, see the RubyGems documentation: <a class="reference external" href="http://rubygems.rubyforge.org/rubygems-update/Gem/DependencyInstaller.html">http://rubygems.rubyforge.org/rubygems-update/Gem/DependencyInstaller.html</a>.</p>
<p>To install a gem with a hash of options</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span><span class="p">(</span><span class="s2">&quot;bundler&quot;</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">options</span><span class="p">(</span><span class="ss">:prerelease</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:format_executable</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="specify-options-with-a-string">
<h5>Specify Options with a String<a class="headerlink" href="#specify-options-with-a-string" title="Permalink to this headline">¶</a></h5>
<p>When using an explicit <tt class="docutils literal"><span class="pre">gem_binary</span></tt>, options must be passed as a string. When not using an explicit <tt class="docutils literal"><span class="pre">gem_binary</span></tt>, Chef is forced to spawn a gems process to install the gems (which uses more system resources) when options are passed as a string. String options are passed verbatim to the gems command and should be specified just as if they were passed on a command line. For example, <tt class="docutils literal"><span class="pre">--prerelease</span></tt> for a pre-release gem.</p>
<p>To install a gem with an options string:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span><span class="p">(</span><span class="s2">&quot;nokogiri&quot;</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">gem_binary</span><span class="p">(</span><span class="s2">&quot;/opt/ree/bin/gem&quot;</span><span class="p">)</span>
  <span class="n">options</span><span class="p">(</span><span class="s2">&quot;--prerelease --no-format-executable&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="specify-options-with-a-gemrc-file">
<h5>Specify Options with a .gemrc File<a class="headerlink" href="#specify-options-with-a-gemrc-file" title="Permalink to this headline">¶</a></h5>
<p>Options can be specified in a .gemrc file. By default the <tt class="docutils literal"><span class="pre">gem_package</span></tt> resource will use the Ruby interface to install gems which will ignore the .gemrc file. The <tt class="docutils literal"><span class="pre">gem_package</span></tt> resource can be forced to use the gems command instead (and to read the .gemrc file) by adding the <tt class="docutils literal"><span class="pre">gem_binary</span></tt> attribute to a code block:</p>
<p>To require a .gemrc file to be used during install:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span><span class="p">(</span><span class="s2">&quot;nokogiri&quot;</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">gem_binary</span> <span class="s2">&quot;gem&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id69">
<h4>Actions<a class="headerlink" href="#id69" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Default. Use to install a package. If a version is specified, use to install the specified version of a package.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:upgrade</span></tt></td>
<td>Use to upgrade a package to the latest version.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a package.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:purge</span></tt></td>
<td>Use to purge a package. This action typically removes the configuration files as well as the package.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id70">
<h4>Attributes<a class="headerlink" href="#id70" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">package_name</span></tt></td>
<td>The name of the package to install. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">version</span></tt></td>
<td>The version of the package that is being installed or upgraded. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">response_file</span></tt></td>
<td>Optional. The response file that is used to pre-seed packages. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>Optional. The package source for providers that use a local file (such as RubyGems, dkpg, yum or RPM Package Manager).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>Additional options that are added to the underlying package command. Can be used with APT, dkpg, Gentoo, RPM Package Manager, and RubyGems. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">gem_binary</span></tt></td>
<td>An attribute for the <tt class="docutils literal"><span class="pre">gem_package</span></tt> provider that is used to specify a gems binary. This attribute is useful when installing Ruby 1.9 gems while running Chef in Ruby 1.8.  Default value: <tt class="docutils literal"><span class="pre">nil</span> <span class="pre">(API)</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">arch</span></tt></td>
<td>An attribute for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> provider that is used to specify the architecture of the package that is being installed or upgraded. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">flush_cache</span></tt></td>
<td>An attribute for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> provider that is used to flush the internal YumCache before or after an install or upgrade action. Default value: <tt class="docutils literal"><span class="pre">{</span> <span class="pre">:before</span> <span class="pre">=&gt;</span> <span class="pre">false,</span> <span class="pre">:after</span> <span class="pre">=&gt;</span> <span class="pre">false</span> <span class="pre">}</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">allow_downgrade</span></tt></td>
<td>An attribute for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> provider that indicates that yum can downgrade a package to satisfy a requested version. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id71">
<h4>Providers<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h4>
<p>Use the following providers to use the Package resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Apt</span></tt></td>
<td><tt class="docutils literal"><span class="pre">apt_package</span></tt></td>
<td>Yes</td>
<td>This is the default provider for the Debian and Ubuntu platforms.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Dpkg</span></tt></td>
<td><tt class="docutils literal"><span class="pre">dpkg_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the dkpg platform. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::EasyInstall</span></tt></td>
<td><tt class="docutils literal"><span class="pre">easy_install_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the Python <strong>jamescott: PYTHON IS CORRECT?</strong>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Freebsd</span></tt></td>
<td><tt class="docutils literal"><span class="pre">freebsd_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the FreeBSD platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Macports</span></tt></td>
<td><tt class="docutils literal"><span class="pre">macports_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the Mac OS X platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Portage</span></tt></td>
<td><tt class="docutils literal"><span class="pre">portage_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the Gentoo platform. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Rpm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">rpm_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the RPM Package Manager platform. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Rubygems</span></tt></td>
<td><tt class="docutils literal"><span class="pre">gem_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for packages that are only included in recipes. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute. The <tt class="docutils literal"><span class="pre">gem_package</span></tt> provider should be used when installing a gem to be used on the system.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Rubygems</span></tt></td>
<td><tt class="docutils literal"><span class="pre">chef_gem</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for when installing a gem only for Chef resources. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute. The <tt class="docutils literal"><span class="pre">chef_gem</span></tt> provider should be used when installing a gem only for Chef resources. The <tt class="docutils literal"><span class="pre">chef_gem</span></tt> provider works with all of the same attributes and options as the <tt class="docutils literal"><span class="pre">gem_package</span></tt> provider, but does not accept <tt class="docutils literal"><span class="pre">gem_binary</span></tt> because it always uses the <tt class="docutils literal"><span class="pre">CurrentGemEnvironment</span></tt> under which Chef is running. In addition to performing actions of the <tt class="docutils literal"><span class="pre">gem_package</span></tt> resource, <tt class="docutils literal"><span class="pre">chef_gem</span></tt> does the following: runs its actions immediately, before convergence, allowing you to use a gem in a recipe immediately after it is installed; and runs <tt class="docutils literal"><span class="pre">Gem.clear_paths</span></tt> after the action, ensuring that gem is aware of changes so that it can be required immediately after it is installed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Yum</span></tt></td>
<td><tt class="docutils literal"><span class="pre">yum_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the Red Hat and CentOS platforms.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Zypper</span></tt></td>
<td><tt class="docutils literal"><span class="pre">zypper_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the SuSE platform.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id72">
<h4>Examples<a class="headerlink" href="#id72" title="Permalink to this headline">¶</a></h4>
<p>To install a gems file only for use in Chef recipes:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">chef_gem</span> <span class="s2">&quot;right_aws&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>

<span class="nb">require</span> <span class="s1">&#39;right_aws&#39;</span>
</pre></div>
</div>
<p>To install a gems file from the local file system:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span> <span class="s2">&quot;right_aws&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;/tmp/right_aws-1.11.0.gem&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a specific package version:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="s2">&quot;1.16.1-1&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a package with options:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;debian-archive-keyring&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">options</span> <span class="s2">&quot;--force-yes&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Use of a <tt class="docutils literal"><span class="pre">response_file</span></tt> is only supported on Debian and Ubuntu at this time. Providers need to be written to support the use of a <tt class="docutils literal"><span class="pre">response_file</span></tt>, which contains debconf answers to questions normally asked by the package manager on installation. Put the file in files/default of the cookbook where the package is specified and Chef will use the Cookbook File resource to retrieve it.</p>
<p>To install a package with a response_file</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;sun-java6-jdk&quot;</span> <span class="k">do</span>
  <span class="n">response_file</span> <span class="s2">&quot;java.seed&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a package using a specific provider:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">source</span> <span class="s2">&quot;/tmp/tar-1.16.1-1.rpm&quot;</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rpm</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a yum package with a specified architecture:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;glibc-devel&quot;</span> <span class="k">do</span>
  <span class="n">arch</span> <span class="s2">&quot;i386&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a package:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To purge a package:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:purge</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To remove a package:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:remove</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To upgrade a package</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:upgrade</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="powershell-script">
<h3>powershell_script<a class="headerlink" href="#powershell-script" title="Permalink to this headline">¶</a></h3>
<p>The PowerShell Script resource is used to execute a script using the Windows PowerShell interpreter.</p>
<ul class="simple">
<li>This resource is used just like the Script resource or the providers for Bash, Csh, Perl, Python, and Ruby. The PowerShell Script resource is similar to those, but with some small tweaks under the covers for the Microsoft Windows platform and Windows PowerShell interpreter.</li>
<li>This resource creates and executes a temporary file (similar to the Script resource), rather than running it inline.</li>
<li>This resource includes actions (<tt class="docutils literal"><span class="pre">:run</span></tt> and <tt class="docutils literal"><span class="pre">:nothing</span></tt>; ) and attributes (<tt class="docutils literal"><span class="pre">creates</span></tt>, <tt class="docutils literal"><span class="pre">cwd</span></tt>, <tt class="docutils literal"><span class="pre">environment</span></tt>, <tt class="docutils literal"><span class="pre">group</span></tt>, <tt class="docutils literal"><span class="pre">path</span></tt>, <tt class="docutils literal"><span class="pre">timeout</span></tt>, and <tt class="docutils literal"><span class="pre">user</span></tt>) that are available from the Execute resource.</li>
</ul>
<p>Commands that are executed with this resource are (by their nature) not idempotent, as they are typically unique to the environment in which they are run. Use the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> meta parameters to guard the use of this resource for idempotence.</p>
<div class="section" id="id73">
<h4>Actions<a class="headerlink" href="#id73" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:run</span></tt></td>
<td>Default. Use to run the script.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id74">
<h4>Attributes<a class="headerlink" href="#id74" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">command</span></tt></td>
<td>The name of the command to execute. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">code</span></tt></td>
<td>The quoted script of code to execute. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">interpreter</span></tt></td>
<td>The script interpreter to be used during code execution. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">flags</span></tt></td>
<td>The command line flags that are passed to the interpreter when invoked. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id75">
<h4>Providers<a class="headerlink" href="#id75" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the PowerShell Script resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::PowershellScript</span></tt></td>
<td><tt class="docutils literal"><span class="pre">powershell</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id76">
<h4>Examples<a class="headerlink" href="#id76" title="Permalink to this headline">¶</a></h4>
<p>To write out to an interpolated path:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">powershell</span> <span class="s2">&quot;write-to-interpolated-path&quot;</span> <span class="k">do</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">  $stream = [System.IO.StreamWriter] &quot;#{Chef::Config[:file_cache_path]}/powershell-test.txt&quot;</span>
<span class="sh">  $stream.WriteLine(&quot;In #{Chef::Config[:file_cache_path]}...word.&quot;)</span>
<span class="sh">  $stream.close()</span>
<span class="no">  EOH</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To change the working directory to a Microsoft Windows environment variable:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">powershell</span> <span class="s2">&quot;cwd-to-win-env-var&quot;</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="s2">&quot;%TEMP%&quot;</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">  $stream = [System.IO.StreamWriter] &quot;./temp-write-from-chef.txt&quot;</span>
<span class="sh">  $stream.WriteLine(&quot;chef on windows rox yo!&quot;)</span>
<span class="sh">  $stream.close()</span>
<span class="no">  EOH</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use the change working directory (<tt class="docutils literal"><span class="pre">cwd</span></tt>) attribute:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">powershell</span> <span class="s2">&quot;cwd-then-write&quot;</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">  $stream = [System.IO.StreamWriter] &quot;C:/powershell-test2.txt&quot;</span>
<span class="sh">  $pwd = pwd</span>
<span class="sh">  $stream.WriteLine(&quot;This is the contents of: $pwd&quot;)</span>
<span class="sh">  $dirs = dir</span>
<span class="sh">  foreach ($dir in $dirs) {</span>
<span class="sh">    $stream.WriteLine($dir.fullname)</span>
<span class="sh">  }</span>
<span class="sh">  $stream.close()</span>
<span class="no">  EOH</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To pass an environment variable to a script:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">powershell</span> <span class="s2">&quot;read-env-var&quot;</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span>
  <span class="n">environment</span> <span class="p">({</span><span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;BAZ&#39;</span><span class="p">})</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">  $stream = [System.IO.StreamWriter] &quot;./test-read-env-var.txt&quot;</span>
<span class="sh">  $stream.WriteLine(&quot;FOO is $foo&quot;)</span>
<span class="sh">  $stream.close()</span>
<span class="no">  EOH</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="remote-directory">
<h3>remote_directory<a class="headerlink" href="#remote-directory" title="Permalink to this headline">¶</a></h3>
<p>The Directory resource is used to manage a directory.</p>
<div class="section" id="id77">
<h4>Actions<a class="headerlink" href="#id77" title="Permalink to this headline">¶</a></h4>
<p>This resource does not have any actions.</p>
</div>
<div class="section" id="id78">
<h4>Attributes<a class="headerlink" href="#id78" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">cookbook</span></tt></td>
<td>The cookbook in which a file is located. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt> (the current cookbook).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">files_backup</span></tt></td>
<td>The number of backup copies to keep for files in the directory. Default value: <tt class="docutils literal"><span class="pre">5</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">files_owner</span></tt></td>
<td>The owner of the files in the directory. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">files_group</span></tt></td>
<td>The group for the files in the directory. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">files_mode</span></tt></td>
<td>The octal mode of the file. When specifying <tt class="docutils literal"><span class="pre">files_mode</span></tt>, the value can be a quoted string (&#8220;644&#8221;). For a numeric value, it should be five digits (&#8220;00644&#8221;) to ensure that it is correctly parsed by Ruby. The default value for this attribute varies.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rights</span></tt></td>
<td>Microsoft Windows only. The permissions for users and groups in a Microsoft Windows environment. For example: <tt class="docutils literal"><span class="pre">rights</span> <span class="pre">&lt;permissions&gt;,</span> <span class="pre">&lt;principal&gt;,</span> <span class="pre">&lt;options&gt;</span></tt> where <tt class="docutils literal"><span class="pre">&lt;permissions&gt;</span> <span class="pre">is</span> <span class="pre">specifies</span> <span class="pre">the</span> <span class="pre">rights</span> <span class="pre">granted</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">principal,</span> <span class="pre">``&lt;principal&gt;</span></tt> is the group or user name, and <tt class="docutils literal"><span class="pre">&lt;options</span></tt>&gt; is a hash with one (or more) advanced rights options.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">inherits</span></tt></td>
<td>Microsoft Windows only. Indicates that the file inherits rights from its parent. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to the directory. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>The base name of the source file (and inferred from the <tt class="docutils literal"><span class="pre">path</span></tt> attribute).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">purge</span></tt></td>
<td>Indicates that extra files found in the target directory will be purged. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">overwrite</span></tt></td>
<td>Indicates that files (if different from the source) will be overwritten. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id79">
<h4>Providers<a class="headerlink" href="#id79" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Remote Directory resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Directory::RemoteDirectory</span></tt></td>
<td><tt class="docutils literal"><span class="pre">remote_directory</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id80">
<h4>Examples<a class="headerlink" href="#id80" title="Permalink to this headline">¶</a></h4>
<p>To recursively transfer a directory from a remote location:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="c1"># create up to 10 backups of the files, set the files owner different from the directory.</span>
<span class="n">remote_directory</span> <span class="s2">&quot;/tmp/remote_something&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;something&quot;</span>
  <span class="n">files_backup</span> <span class="mi">10</span>
  <span class="n">files_owner</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">files_group</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">files_mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">owner</span> <span class="s2">&quot;nobody&quot;</span>
  <span class="n">group</span> <span class="s2">&quot;nobody&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;0755&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="remote-file">
<h3>remote_file<a class="headerlink" href="#remote-file" title="Permalink to this headline">¶</a></h3>
<p>The Remote File resource is used to transfer a file from a remote location using file specificity. This resource is similar to File.</p>
<p><strong>jamescott: NEED NEW DESCRIPTION IN INCLUDE FILE &#8211; THIS ONE HAS ROUTES.</strong></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Fetching files from the <tt class="docutils literal"><span class="pre">files/</span></tt> directory in a cookbook should be done with the Cookbook File resource.</p>
</div>
<div class="section" id="id81">
<h4>Actions<a class="headerlink" href="#id81" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to synchronize a file from a remote source to the file system.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:create_if_missing</span></tt></td>
<td>Use to create a file locally by fetching from the remote source, but only if the file doesn&#8217;t yet exist.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id82">
<h4>Attributes<a class="headerlink" href="#id82" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to the file. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">backup</span></tt></td>
<td>The number of backups of a file that should be kept. Set to <tt class="docutils literal"><span class="pre">false</span></tt> to prevent backups from being kept. Default value: <tt class="docutils literal"><span class="pre">5</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>A string or ID that identifies the group owner of the file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mode</span></tt></td>
<td>The octal mode of the file. When specifying <tt class="docutils literal"><span class="pre">mode</span></tt>, the value can be a quoted string (&#8220;644&#8221;). For a numeric value, it should be five digits (&#8220;00644&#8221;) to ensure that it is correctly parsed by Ruby. The default value for this attribute varies.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rights</span></tt></td>
<td>Microsoft Windows only. The permissions for users and groups in a Microsoft Windows environment. For example: <tt class="docutils literal"><span class="pre">rights</span> <span class="pre">&lt;permissions&gt;,</span> <span class="pre">&lt;principal&gt;,</span> <span class="pre">&lt;options&gt;</span></tt> where <tt class="docutils literal"><span class="pre">&lt;permissions&gt;</span> <span class="pre">is</span> <span class="pre">specifies</span> <span class="pre">the</span> <span class="pre">rights</span> <span class="pre">granted</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">principal,</span> <span class="pre">``&lt;principal&gt;</span></tt> is the group or user name, and <tt class="docutils literal"><span class="pre">&lt;options</span></tt>&gt; is a hash with one (or more) advanced rights options.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">inherits</span></tt></td>
<td>Microsoft Windows only. Indicates that the file inherits rights from its parent. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of the file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>The base name of the source file (and inferred from the <tt class="docutils literal"><span class="pre">path</span></tt> attribute).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">checksum</span></tt></td>
<td>Optional. The SHA-256 checksum of the file. If the local file matches the checksum, Chef will not download it. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id83">
<h4>Providers<a class="headerlink" href="#id83" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Remote File resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::File::RemoteFile</span></tt></td>
<td><tt class="docutils literal"><span class="pre">remote_file</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id84">
<h4>Examples<a class="headerlink" href="#id84" title="Permalink to this headline">¶</a></h4>
<p>To transfer a file from a URL:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">remote_file</span> <span class="s2">&quot;/tmp/testfile&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://www.example.com/tempfiles/testfile&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">checksum</span> <span class="s2">&quot;08da002l&quot;</span> <span class="c1"># A SHA256 (or portion thereof) of the file.</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To transfer a file only if the remote source has changed (using the <tt class="docutils literal"><span class="pre">http_request</span></tt> resource):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">remote_file</span> <span class="s2">&quot;/tmp/couch.png&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://couchdb.apache.org/img/sketch.png&quot;</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span>

<span class="n">http_request</span> <span class="s2">&quot;HEAD </span><span class="si">#{</span><span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">couchdb</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">img</span><span class="o">/</span><span class="n">sketch</span><span class="o">.</span><span class="n">png</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
  <span class="n">message</span> <span class="s2">&quot;&quot;</span>
  <span class="n">url</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">couchdb</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">img</span><span class="o">/</span><span class="n">sketch</span><span class="o">.</span><span class="n">png</span>
  <span class="n">action</span> <span class="ss">:head</span>
  <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="s2">&quot;/tmp/couch.png&quot;</span><span class="p">)</span>
    <span class="n">headers</span> <span class="s2">&quot;If-Modified-Since&quot;</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">.</span><span class="n">mtime</span><span class="p">(</span><span class="s2">&quot;/tmp/couch.png&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">httpdate</span>
  <span class="k">end</span>
  <span class="n">notifies</span> <span class="ss">:create</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:remote_file</span> <span class="o">=&gt;</span> <span class="s2">&quot;/tmp/couch.png&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="route">
<h3>route<a class="headerlink" href="#route" title="Permalink to this headline">¶</a></h3>
<p>The Route resource is used to manage the system routing table in a Linux environment.</p>
<div class="section" id="id85">
<h4>Actions<a class="headerlink" href="#id85" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:add</span></tt></td>
<td>Default. Use to add a route.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete a route.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id86">
<h4>Attributes<a class="headerlink" href="#id86" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">target</span></tt></td>
<td>The address of the target route. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">netmask</span></tt></td>
<td>The decimal representation of the network mask. For example: <tt class="docutils literal"><span class="pre">255.255.255.0</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">gateway</span></tt></td>
<td>The gateway for the route.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">device</span></tt></td>
<td>The network interface to which the route applies.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id87">
<h4>Providers<a class="headerlink" href="#id87" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Route resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Route</span></tt></td>
<td><tt class="docutils literal"><span class="pre">route</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id88">
<h4>Examples<a class="headerlink" href="#id88" title="Permalink to this headline">¶</a></h4>
<p>To add a host route:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">route</span> <span class="s2">&quot;10.0.1.10/32&quot;</span> <span class="k">do</span>
  <span class="n">gateway</span> <span class="s2">&quot;10.0.0.20&quot;</span>
  <span class="n">device</span> <span class="s2">&quot;eth1&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To delete a network route:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">route</span> <span class="s2">&quot;10.1.1.0/24&quot;</span> <span class="k">do</span>
  <span class="n">gateway</span> <span class="s2">&quot;10.0.0.20&quot;</span>
  <span class="n">action</span> <span class="ss">:delete</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ruby-block">
<h3>ruby_block<a class="headerlink" href="#ruby-block" title="Permalink to this headline">¶</a></h3>
<p>The Ruby Block resource is used to execute Ruby code during a Chef run. Ruby code in the <tt class="docutils literal"><span class="pre">ruby_block</span></tt> resource is evaluated with other resources during convergence, whereas Ruby code outside of a <tt class="docutils literal"><span class="pre">ruby_block</span></tt> resource is evaluated before other resources, as the recipe is compiled.</p>
<div class="section" id="id89">
<h4>Actions<a class="headerlink" href="#id89" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a Ruby block.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id90">
<h4>Attributes<a class="headerlink" href="#id90" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">block</span></tt></td>
<td>A block of Ruby code. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id91">
<h4>Providers<a class="headerlink" href="#id91" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Ruby Block resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::RubyBlock</span></tt></td>
<td><tt class="docutils literal"><span class="pre">ruby_block</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id92">
<h4>Examples<a class="headerlink" href="#id92" title="Permalink to this headline">¶</a></h4>
<p>To re-read the chef-client configuration during a Chef run:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">ruby_block</span> <span class="s2">&quot;reload_client_config&quot;</span> <span class="k">do</span>
  <span class="n">block</span> <span class="k">do</span>
    <span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;/etc/chef/client.rb&quot;</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="scm">
<h3>scm<a class="headerlink" href="#scm" title="Permalink to this headline">¶</a></h3>
<p>The Source Control Management (SCM) resource is used to manage source control resources that exist in a git repository or a Subversion repository.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This resource is often used in conjunction with the Deploy resource.</p>
</div>
<div class="section" id="id93">
<h4>Actions<a class="headerlink" href="#id93" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:sync</span></tt></td>
<td>Default. Use to update the source to the specified version, or to get a new clone or checkout.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:checkout</span></tt></td>
<td>Use to clone or check out the source. When a checkout is available, this provider does nothing.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:export</span></tt></td>
<td>Use to export the source, excluding or removing any version control artifacts.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:force_export</span></tt></td>
<td>Subversion only. Use to export the source, excluding or removing any version control artifacts and to force an export of the source that is overwriting the existing copy (if it exists).</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id94">
<h4>Attributes<a class="headerlink" href="#id94" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">destination</span></tt></td>
<td>The path to the location to which the source will be cloned, checked out, or exported.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">repository</span></tt></td>
<td>The URI for the repository.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">revision</span></tt></td>
<td>The revision to be checked out. This can be symbolic, like <tt class="docutils literal"><span class="pre">HEAD</span></tt> or it can be a source control management-specific revision identifier. Default value: <tt class="docutils literal"><span class="pre">HEAD</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">reference</span></tt></td>
<td>The alias for revision. This action only works with the <tt class="docutils literal"><span class="pre">git</span></tt> provider.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">user</span></tt></td>
<td>The system user that is responsible for the checked-out code. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>The system group that is responsible for the checked-out code. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">svn_username</span></tt></td>
<td>Subversion only. The user name for a user that has access to the Subversion repository.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">svn_password</span></tt></td>
<td>Subversion only. The password for the user that has access to the Subversion repository.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">svn_arguments</span></tt></td>
<td>Subversion only. The extra arguments that are passed to the Subversion command.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">svn_info_args</span></tt></td>
<td>Subversion only. Use when the <tt class="docutils literal"><span class="pre">svn</span> <span class="pre">info</span></tt> command is used by Chef and arguments need to be passed. (The <tt class="docutils literal"><span class="pre">svn_arguments</span></tt> command does not work when the <tt class="docutils literal"><span class="pre">svn</span> <span class="pre">info</span></tt> command is used by Chef.)</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">depth</span></tt></td>
<td>git only. The number of past revisions that will be included in the git shallow clone. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt> (full clone).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">enable_submodules</span></tt></td>
<td>git only. Use to perform a sub-module initialization and update. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">remote</span></tt></td>
<td>git only. Use to define the remote repository that is when synchronizing an existing close.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">additional_remotes</span></tt></td>
<td>git only. An array of additional remotes that are added to the repository configuration.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ssh_wrapper</span></tt></td>
<td>git only. The path to the wrapper script that is used when running SSH with git. The <tt class="docutils literal"><span class="pre">GIT_SSH</span></tt> environment variable is set to this value.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id95">
<h4>Providers<a class="headerlink" href="#id95" title="Permalink to this headline">¶</a></h4>
<p>Use the following providers to use the Source Control Management (SCM) resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Git</span></tt></td>
<td><tt class="docutils literal"><span class="pre">git</span></tt></td>
<td>&nbsp;</td>
<td>This provider works only with git.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Subversion</span></tt></td>
<td><tt class="docutils literal"><span class="pre">subversion</span></tt></td>
<td>&nbsp;</td>
<td>This provider work only with Subversion.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id96">
<h4>Examples<a class="headerlink" href="#id96" title="Permalink to this headline">¶</a></h4>
<p>To get the latest version of CouchDB:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">grab_couchdb_from_svn</span>
<span class="n">subversion</span> <span class="s2">&quot;CouchDB Edge&quot;</span> <span class="k">do</span>
  <span class="n">repository</span> <span class="s2">&quot;http://svn.apache.org/repos/asf/couchdb/trunk&quot;</span>
  <span class="n">revision</span> <span class="s2">&quot;HEAD&quot;</span>
  <span class="n">destination</span> <span class="s2">&quot;/opt/mysources/couch&quot;</span>
  <span class="n">action</span> <span class="ss">:sync</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use the git mirror:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">grab_couchdb_from_git_mirror</span>
<span class="n">git</span> <span class="s2">&quot;/opt/mysources/couch&quot;</span> <span class="k">do</span>
  <span class="n">repository</span> <span class="s2">&quot;git://git.apache.org/couchdb.git&quot;</span>
  <span class="n">reference</span> <span class="s2">&quot;master&quot;</span>
  <span class="n">action</span> <span class="ss">:sync</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use different branches, depending on the environment of the node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">using_different_branches_in_git</span>
<span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">chef_environment</span> <span class="o">==</span> <span class="s2">&quot;QA&quot;</span>
   <span class="n">branch_name</span> <span class="o">=</span> <span class="s2">&quot;staging&quot;</span>
<span class="k">else</span>
   <span class="n">branch_name</span> <span class="o">=</span> <span class="s2">&quot;master&quot;</span>
<span class="k">end</span>

<span class="n">git</span> <span class="s2">&quot;/home/user/deployment&quot;</span> <span class="k">do</span>
   <span class="n">repository</span> <span class="s2">&quot;git@github.com:gitsite/deployment.git&quot;</span>
   <span class="n">revision</span> <span class="n">branch_name</span>
   <span class="n">action</span> <span class="ss">:sync</span>
   <span class="n">user</span> <span class="s2">&quot;user&quot;</span>
   <span class="n">group</span> <span class="s2">&quot;test&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where the <tt class="docutils literal"><span class="pre">branch_name</span></tt> variable is set to <tt class="docutils literal"><span class="pre">staging</span></tt> or <tt class="docutils literal"><span class="pre">master</span></tt>, depending on the environment of the node. Once this is determined, the <tt class="docutils literal"><span class="pre">branch_name</span></tt> variable is used to set the revision for the repository. If the <tt class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></tt> command is used after running the example above, it will return the branch name as <tt class="docutils literal"><span class="pre">deploy</span></tt>, as this is the default value. Run the <tt class="docutils literal"><span class="pre">chef-client</span></tt> in debug mode to verify that the correct branches are being checked out:</p>
<div class="highlight-bash"><div class="highlight"><pre>sudo chef-client -l debug
</pre></div>
</div>
</div>
</div>
<div class="section" id="script">
<h3>script<a class="headerlink" href="#script" title="Permalink to this headline">¶</a></h3>
<p>The Script resource is used to execute using the specified interpreter (Bash, Csh, Perl, Python, or Ruby). This resource includes all of the actions and attributes that are available to the Execute resource. The Ruby script resource is different from the Ruby Block resource because Ruby run with the Script resource is created as a temporary file and executed like other script resources, rather than run inline. Commands that are executed with this resource are (by their nature) not idempotent, as they are typically unique to the environment in which they are run. Use the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> meta parameters to guard the use of this resource for idempotence.</p>
<div class="section" id="id97">
<h4>Actions<a class="headerlink" href="#id97" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:run</span></tt></td>
<td>Default. Use to run a script.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id98">
<h4>Attributes<a class="headerlink" href="#id98" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">command</span></tt></td>
<td>The name of the command to execute. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">code</span></tt></td>
<td>The quoted script of code to execute. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">interpreter</span></tt></td>
<td>The script interpreter to be used during code execution. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">flags</span></tt></td>
<td>The command line flags that are passed to the interpreter when invoked. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id99">
<h4>Providers<a class="headerlink" href="#id99" title="Permalink to this headline">¶</a></h4>
<p>Use the following providers to use the Script resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Resource::Script::Bash</span></tt></td>
<td><tt class="docutils literal"><span class="pre">bash</span></tt></td>
<td>&nbsp;</td>
<td>This is the provider used for the Bash command interpreter.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Resource::Script::Csh</span></tt></td>
<td><tt class="docutils literal"><span class="pre">csh</span></tt></td>
<td>&nbsp;</td>
<td>This is the provider used for the Csh command interpreter.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Resource::Script::Perl</span></tt></td>
<td><tt class="docutils literal"><span class="pre">perl</span></tt></td>
<td>&nbsp;</td>
<td>This is the provider used for the Perl command interpreter.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Resource::Script::Python</span></tt></td>
<td><tt class="docutils literal"><span class="pre">python</span></tt></td>
<td>&nbsp;</td>
<td>This is the provider used for the Python command interpreter.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Resource::Script::Ruby</span></tt></td>
<td><tt class="docutils literal"><span class="pre">ruby</span></tt></td>
<td>&nbsp;</td>
<td>This is the provider used for the Ruby command interpreter.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id100">
<h4>Examples<a class="headerlink" href="#id100" title="Permalink to this headline">¶</a></h4>
<p>To use a bash provider and interpreter to run the same script:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">bash</span> <span class="s2">&quot;install_something&quot;</span> <span class="k">do</span>
  <span class="n">user</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">cwd</span> <span class="s2">&quot;/tmp&quot;</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">  wget http://www.example.com/tarball.tar.gz</span>
<span class="sh">  tar -zxf tarball.tar.gz</span>
<span class="sh">  cd tarball</span>
<span class="sh">  ./configure</span>
<span class="sh">  make</span>
<span class="sh">  make install</span>
<span class="no">  EOH</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To run a bash script:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">script</span> <span class="s2">&quot;install_something&quot;</span> <span class="k">do</span>
  <span class="n">interpreter</span> <span class="s2">&quot;bash&quot;</span>
  <span class="n">user</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">cwd</span> <span class="s2">&quot;/tmp&quot;</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="no">EOH</span>
<span class="sh">  wget http://www.example.com/tarball.tar.gz</span>
<span class="sh">  tar -zxf tarball.tar.gz</span>
<span class="sh">  cd tarball</span>
<span class="sh">  ./configure</span>
<span class="sh">  make</span>
<span class="sh">  make install</span>
<span class="no">  EOH</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="service">
<h3>service<a class="headerlink" href="#service" title="Permalink to this headline">¶</a></h3>
<p>The Service resource is used to manage a service.</p>
<div class="section" id="id101">
<h4>Actions<a class="headerlink" href="#id101" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to enable a service at boot.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:disable</span></tt></td>
<td>Use to disable a service.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:nothing</span></tt></td>
<td>Default. Use to do nothing with a service.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:start</span></tt></td>
<td>Use to start a service (and keep it running until stopped or disabled).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:stop</span></tt></td>
<td>Use to stop a service.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:restart</span></tt></td>
<td>Use to restart a service.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:reload</span></tt></td>
<td>Use to reload the configuration for this service.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id102">
<h4>Attributes<a class="headerlink" href="#id102" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">service_name</span></tt></td>
<td>The name of the service. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">pattern</span></tt></td>
<td>The pattern to look for in the process table. Default value: <tt class="docutils literal"><span class="pre">service_name</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">start_command</span></tt></td>
<td>The command used to start a service. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">stop_command</span></tt></td>
<td>The command used to stop a service. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">status_command</span></tt></td>
<td>The command used to check the run status for a service. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">restart_command</span></tt></td>
<td>The command used to restart a service. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">reload_command</span></tt></td>
<td>The command used to tell a service to reload its configuration. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">supports</span></tt></td>
<td>A list of attributes that controls how Chef will attempt to manage a service: <tt class="docutils literal"><span class="pre">:restart</span></tt>, <tt class="docutils literal"><span class="pre">:reload</span></tt>, <tt class="docutils literal"><span class="pre">:status</span></tt>. For <tt class="docutils literal"><span class="pre">:restart</span></tt>, the init script or other service provider can use a restart command; if <tt class="docutils literal"><span class="pre">:restart</span></tt> is not specified, Chef will attempt to stop and then start a service. For <tt class="docutils literal"><span class="pre">:reload</span></tt>, the init script or other service provider can use a reload command. For <tt class="docutils literal"><span class="pre">:status</span></tt>, the init script or other service provider can use a status command to determine if the service is running; if <tt class="docutils literal"><span class="pre">:status</span></tt> is not specified, Chef will attempt to match the <tt class="docutils literal"><span class="pre">service_name</span></tt> against the process table as a regular expression, unless a pattern is specified as a parameter attribute. Default value: <tt class="docutils literal"><span class="pre">{</span> <span class="pre">:restart</span> <span class="pre">=&gt;</span> <span class="pre">true,</span> <span class="pre">:status</span> <span class="pre">=&gt;</span> <span class="pre">true</span> <span class="pre">}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id103">
<h4>Providers<a class="headerlink" href="#id103" title="Permalink to this headline">¶</a></h4>
<p>Use the following providers to use the Service resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Init</span></tt></td>
<td><tt class="docutils literal"><span class="pre">service</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms, unless there is a specific provider for a specific platform (see the other entries in this table).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Init::Debian</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Debian and Ubuntu platforms.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Upstart</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Upstart platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Init::Freebsd</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the FreeBSD platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Init::Gentoo</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Gentoo platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Init::Redhat</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Red Hat and CentOS platforms.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Solaris</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Oracle Solaris platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Windows</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Microsoft Windows platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Service::Macosx</span></tt></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>This is the default provider for the Mac OS X platform.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id104">
<h4>Examples<a class="headerlink" href="#id104" title="Permalink to this headline">¶</a></h4>
<p>To start the service when it is not running and enable it so that it starts at system boot time:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="c1"># runs /etc/init.d/example_service (start|stop|restart), etc.</span>
<span class="n">service</span> <span class="s2">&quot;example_service&quot;</span> <span class="k">do</span>
  <span class="n">supports</span> <span class="ss">:status</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:reload</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="o">[</span> <span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span> <span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To start a service when it is not running:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="c1"># typically this will run /etc/init.d/example_service start</span>
<span class="n">service</span> <span class="s2">&quot;example_service&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:start</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To handle situations when the process table has a different value than the name of the service script:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;samba&quot;</span> <span class="k">do</span>
  <span class="n">pattern</span> <span class="s2">&quot;smbd&quot;</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To manage the SSH service, named depending on the platform of the node:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;example_service&quot;</span> <span class="k">do</span>
  <span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="ss">:platform</span><span class="o">]</span>
  <span class="k">when</span> <span class="s2">&quot;CentOS&quot;</span><span class="p">,</span><span class="s2">&quot;RedHat&quot;</span><span class="p">,</span><span class="s2">&quot;Fedora&quot;</span>
    <span class="n">service_name</span> <span class="s2">&quot;redhat_name&quot;</span>
  <span class="k">else</span>
    <span class="n">service_name</span> <span class="s2">&quot;other_name&quot;</span>
  <span class="k">end</span>
  <span class="n">supports</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="o">[</span> <span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span> <span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To change a service provider depending on a node&#8217;s platform:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;example_service&quot;</span> <span class="k">do</span>
  <span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="ss">:platform</span><span class="o">]</span>
  <span class="k">when</span> <span class="s2">&quot;ubuntu&quot;</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">[</span><span class="ss">:platform_version</span><span class="o">].</span><span class="n">to_f</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="o">.</span><span class="mi">10</span>
      <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Service</span><span class="o">::</span><span class="no">Upstart</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="template">
<h3>template<a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h3>
<p>The Template resource is used to manage file contents with an embedded Ruby (erb) template. This resource includes actions and attributes from the File resource. Templates follow the same file specificity rules as the Remote File and File resources.</p>
<div class="section" id="id105">
<h4>Actions<a class="headerlink" href="#id105" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:create_if_missing</span></tt></td>
<td>Use to create a file only if it does not exist.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id106">
<h4>Attributes<a class="headerlink" href="#id106" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">backup</span></tt></td>
<td>The number of backups of a file that should be kept. Set to <tt class="docutils literal"><span class="pre">false</span></tt> to prevent backups from being kept. Default value: <tt class="docutils literal"><span class="pre">5</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">cookbook</span></tt></td>
<td>The cookbook in which a template is located. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt> (the current cookbook).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to the file. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>The location of the template source file. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>A string or ID that identifies the group owner of the file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">mode</span></tt></td>
<td>The octal mode of the file. When specifying <tt class="docutils literal"><span class="pre">mode</span></tt>, the value can be a quoted string (&#8220;644&#8221;). For a numeric value, it should be five digits (&#8220;00644&#8221;) to ensure that it is correctly parsed by Ruby. The default value for this attribute varies.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rights</span></tt></td>
<td>Microsoft Windows only. The permissions for users and groups in a Microsoft Windows environment. For example: <tt class="docutils literal"><span class="pre">rights</span> <span class="pre">&lt;permissions&gt;,</span> <span class="pre">&lt;principal&gt;,</span> <span class="pre">&lt;options&gt;</span></tt> where <tt class="docutils literal"><span class="pre">&lt;permissions&gt;</span> <span class="pre">is</span> <span class="pre">specifies</span> <span class="pre">the</span> <span class="pre">rights</span> <span class="pre">granted</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">principal,</span> <span class="pre">``&lt;principal&gt;</span></tt> is the group or user name, and <tt class="docutils literal"><span class="pre">&lt;options</span></tt>&gt; is a hash with one (or more) advanced rights options.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">inherits</span></tt></td>
<td>Microsoft Windows only. Indicates that the file inherits rights from its parent. Default value: <tt class="docutils literal"><span class="pre">true</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of the file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">variables</span></tt></td>
<td>A hash of variables that are used in the template.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">local</span></tt></td>
<td>Indicates whether a template is already present on the node. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id107">
<h4>Providers<a class="headerlink" href="#id107" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider to use the Template resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::File::Template</span></tt></td>
<td><tt class="docutils literal"><span class="pre">template</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id108">
<h4>Examples<a class="headerlink" href="#id108" title="Permalink to this headline">¶</a></h4>
<p>To configure a file from a template:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/config.conf&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;config.conf.erb&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To configure a file from a local template:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/config.conf&quot;</span> <span class="k">do</span>
  <span class="n">local</span> <span class="kp">true</span>
  <span class="n">source</span> <span class="s2">&quot;/tmp/config.conf.erb&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To configure a file from a template with a variable map:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/tmp/config.conf&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;config.conf.erb&quot;</span>
  <span class="n">variables</span><span class="p">(</span>
    <span class="ss">:config_var</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="ss">:configs</span><span class="o">][</span><span class="ss">:config_var</span><span class="o">]</span>
  <span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="user">
<h3>user<a class="headerlink" href="#user" title="Permalink to this headline">¶</a></h3>
<p>The User resource is used to manage a local user.</p>
<div class="section" id="id109">
<h4>Actions<a class="headerlink" href="#id109" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Default. Use to create a user with given attributes. If the user already exists, use to ensure that the resource is in the correct state (which is effectively the same as <tt class="docutils literal"><span class="pre">:modify</span></tt>).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a user.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:modify</span></tt></td>
<td>Use to modify an existing user. This action will raise an exception if the user does not exist.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:manage</span></tt></td>
<td>Use to manage an existing user. This action will do nothing if the user does not exist.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:lock</span></tt></td>
<td>Use to lock a user&#8217;s password.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:unlock</span></tt></td>
<td>Use to unlock a user&#8217;s password.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id110">
<h4>Attributes<a class="headerlink" href="#id110" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">username</span></tt></td>
<td>The name of the user. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">comment</span></tt></td>
<td>One (or more) comments about the user. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">uid</span></tt></td>
<td>The numeric user identifier. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">gid</span></tt></td>
<td>The primary group identifier. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">home</span></tt></td>
<td>The location of the home directory. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">shell</span></tt></td>
<td>The login shell. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">password</span></tt></td>
<td>The password shadow hash. This attribute requires that <tt class="docutils literal"><span class="pre">ruby-shadow</span></tt> be installed. This is part of the Debian package: <tt class="docutils literal"><span class="pre">libshadow-ruby1.8</span></tt>. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">system</span></tt></td>
<td>Indicates that a system user should be created. This attribute may be used with <tt class="docutils literal"><span class="pre">useradd</span></tt> as the provider to create a system user which passes the <tt class="docutils literal"><span class="pre">-r</span></tt> flag to <tt class="docutils literal"><span class="pre">useradd</span></tt>. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">supports</span></tt></td>
<td>A Mash where keys represent features and values are booleans that indicate if that feature is supported. Default value: <tt class="docutils literal"><span class="pre">{:manage_home</span> <span class="pre">=&gt;</span> <span class="pre">false,</span> <span class="pre">:non_unique</span> <span class="pre">=&gt;</span> <span class="pre">false</span> <span class="pre">}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="supported-features">
<h4>Supported Features<a class="headerlink" href="#supported-features" title="Permalink to this headline">¶</a></h4>
<p>There are a number of encryption options and tools that can be used to create a password shadow hash. In general, using a strong encryption method like SHA-512 and the <tt class="docutils literal"><span class="pre">passwd</span></tt> command in the OpenSSL toolkit is a good approach, however the encryption options and tools that are available may be different from one distribution to another. The following examples show how the command line can be used to create a password shadow hash. When using the <tt class="docutils literal"><span class="pre">passwd</span></tt> command in the OpenSSL tool:</p>
<div class="highlight-bash"><div class="highlight"><pre>openssl passwd -1 <span class="s2">&quot;theplaintextpassword&quot;</span>
</pre></div>
</div>
<p>When using <tt class="docutils literal"><span class="pre">mkpasswd</span></tt>:</p>
<div class="highlight-bash"><div class="highlight"><pre>mkpasswd -m sha-512
</pre></div>
</div>
<p>For more information:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.openssl.org/docs/apps/passwd.html">http://www.openssl.org/docs/apps/passwd.html</a></li>
<li>Check the local documentation or package repository for the distribution that is being used. For example, on Ubuntu 9.10-10.04, the <tt class="docutils literal"><span class="pre">mkpasswd</span></tt> package is required and on Ubuntu 10.10+ the <tt class="docutils literal"><span class="pre">whois</span></tt> package is required.</li>
</ul>
</div>
<div class="section" id="password-shadow-hash">
<h4>Password Shadow Hash<a class="headerlink" href="#password-shadow-hash" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">supports</span></tt> attribute allows a list of supported features to be identified. There are two features of note:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:manage_home</span></tt> indicates whether a user&#8217;s home directory will be created when the user is created. When the <tt class="docutils literal"><span class="pre">useradd</span></tt> provider is used, this feature indicates whether <tt class="docutils literal"><span class="pre">-d</span></tt> and <tt class="docutils literal"><span class="pre">-m</span></tt> will be passed to <tt class="docutils literal"><span class="pre">useradd</span></tt> (when the <tt class="docutils literal"><span class="pre">:create</span></tt> action is used) or whether <tt class="docutils literal"><span class="pre">-d</span></tt> will be passed to <tt class="docutils literal"><span class="pre">usermod</span></tt> (when the <tt class="docutils literal"><span class="pre">:manage</span></tt> or <tt class="docutils literal"><span class="pre">:modify</span></tt> actions are used). When &#8220;supports :manage_home=&gt;true&#8221; the User resource does not include the <tt class="docutils literal"><span class="pre">-d</span></tt> and <tt class="docutils literal"><span class="pre">-m</span></tt> parameters together on the <tt class="docutils literal"><span class="pre">usermod</span></tt> command.</li>
<li><tt class="docutils literal"><span class="pre">:non_unique</span></tt> indicates whether non-unique UIDs are allowed.</li>
</ul>
</div>
<div class="section" id="id111">
<h4>Providers<a class="headerlink" href="#id111" title="Permalink to this headline">¶</a></h4>
<p>Use the following providers to use the User resource in a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::User::Useradd</span></tt></td>
<td><tt class="docutils literal"><span class="pre">user</span></tt></td>
<td>Yes</td>
<td>This is the default provider for all platforms.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::User::Pw</span></tt></td>
<td><tt class="docutils literal"><span class="pre">xxxxx</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the FreeBSD platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::User::Dscl</span></tt></td>
<td><tt class="docutils literal"><span class="pre">xxxxx</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the Mac OS X platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::User::Windows</span></tt></td>
<td><tt class="docutils literal"><span class="pre">xxxxx</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for all Microsoft Windows platforms.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id112">
<h4>Examples<a class="headerlink" href="#id112" title="Permalink to this headline">¶</a></h4>
<p>To create a random user:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">user</span> <span class="s2">&quot;random&quot;</span> <span class="k">do</span>
  <span class="n">comment</span> <span class="s2">&quot;Random User&quot;</span>
  <span class="n">uid</span> <span class="mi">1000</span>
  <span class="n">gid</span> <span class="s2">&quot;users&quot;</span>
  <span class="n">home</span> <span class="s2">&quot;/home/random&quot;</span>
  <span class="n">shell</span> <span class="s2">&quot;/bin/zsh&quot;</span>
  <span class="n">password</span> <span class="s2">&quot;$1$JJsvHslV$szsCjVEroftprNn4JHtDi.&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To create a system user:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">user</span> <span class="s2">&quot;systemguy&quot;</span> <span class="k">do</span>
  <span class="n">comment</span> <span class="s2">&quot;system guy&quot;</span>
  <span class="nb">system</span> <span class="kp">true</span>
  <span class="n">shell</span> <span class="s2">&quot;/bin/false&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="yum">
<h3>yum<a class="headerlink" href="#yum" title="Permalink to this headline">¶</a></h3>
<p>The Yum Package resource is used to use yum for installation, upgrade, and removal of packages. This resource is able to resolve provides data for packages much like yum can do when running it from the command line. This allows a variety of options for installing packages, like minimum versions, virtual provides, and library names.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Support for using file names to install packages (as in <tt class="docutils literal"><span class="pre">yum_package</span> <span class="pre">&quot;/bin/sh&quot;</span></tt>) is not available because the volume of data required to parse for this is excessive.</p>
</div>
<div class="section" id="id113">
<h4>Actions<a class="headerlink" href="#id113" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Default. Indicates that a package (or a version, when provided) will be installed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:upgrade</span></tt></td>
<td>Indicates that a package will be upgraded to the latest available version.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Indicates that a package (or a version, when provided) will be removed.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id114">
<h4>Attributes<a class="headerlink" href="#id114" title="Permalink to this headline">¶</a></h4>
<p>This resource has the following has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">package_name</span></tt></td>
<td>One of the following: the name of a package, the name of a package and its architecture; the name of a dependency. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">version</span></tt></td>
<td>The version of the package that will be installed, upgraded, or removed. This value must be a complete version-release. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>Indicates that the <tt class="docutils literal"><span class="pre">yum</span> <span class="pre">localinstall</span></tt> command will be used. When this attribute is specified, yum will use repositories to satisfy any remote dependencies. Default value: none.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>Indicates that additional options to the <tt class="docutils literal"><span class="pre">yum</span> <span class="pre">localinstall</span></tt> command will be used, such as those that enable or disable a repository, disable integrity checking, and so on. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">arch</span></tt></td>
<td>The architecture of the package that will be installed or upgraded. (This value can also be passed as part of the package name.) Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>. This attribute is only available for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> resource.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">flush_cache</span></tt></td>
<td>An array that indicates whether the yum cache should be flushed before or after a yum operation that installs, upgrades, or removes a package. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>. Possible values: <tt class="docutils literal"><span class="pre">:before</span></tt> and <tt class="docutils literal"><span class="pre">:after</span></tt>. This attribute is only available for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> resource.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">allow_downgrade</span></tt></td>
<td>Indicates that yum can downgrade a package to satisfy requested version requirements. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>. This attribute is only available for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> resource.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id115">
<h4>Providers<a class="headerlink" href="#id115" title="Permalink to this headline">¶</a></h4>
<p>This resource does not have any providers.</p>
</div>
<div class="section" id="id116">
<h4>Examples<a class="headerlink" href="#id116" title="Permalink to this headline">¶</a></h4>
<p>To delete a repository while using yum to scrub the cache to avoid issues:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s2">&quot;clean-yum-cache&quot;</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">&quot;yum clean all&quot;</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span>

<span class="n">file</span> <span class="s2">&quot;/etc/yum.repos.d/bad.repo&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:execute</span> <span class="o">=&gt;</span> <span class="s2">&quot;clean-yum-cache&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
  <span class="n">notifies</span> <span class="ss">:create</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:ruby_block</span> <span class="o">=&gt;</span> <span class="s2">&quot;reload-internal-yum-cache&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The previous two examples are thanks to gaffneyc &#64; <a class="reference external" href="https://gist.github.com/918711">https://gist.github.com/918711</a>.</p>
</div>
<p>To handle cookbook_file and yum_package when both called in the same recipe
When a <tt class="docutils literal"><span class="pre">cookbook_file</span></tt> resource and a <tt class="docutils literal"><span class="pre">yum_package</span></tt> resource are both called from within the same recipe, dump the cache and use the new repository immediately to ensure that the correct package is installed:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">cookbook_file</span> <span class="s2">&quot;/etc/yum.repos.d/custom.repo&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;custom&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
<span class="k">end</span>

<span class="n">yum_package</span> <span class="s2">&quot;only-in-custom-repo&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">flush_cache</span> <span class="o">[</span> <span class="ss">:before</span> <span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install an exact version:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm = 10.35.58-8.el5&quot;</span>
</pre></div>
</div>
<p>To install a minimum version:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm &gt;= 10.35.58-8.el5&quot;</span>
</pre></div>
</div>
<p>To install the same package using the default action:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm&quot;</span>
</pre></div>
</div>
<p>To install a package:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a partial minimum version:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm &gt;= 10&quot;</span>
</pre></div>
</div>
<p>To install a specific architecture:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm&quot;</span> <span class="k">do</span>
  <span class="n">arch</span> <span class="s2">&quot;i386&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm.x86_64&quot;</span>
</pre></div>
</div>
<p>To install a specific version-release:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;netpbm&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="s2">&quot;10.35.58-8.el5&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a specific version (even if it is older than the version currently installed):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;tzdata&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="s2">&quot;2011b-1.el5&quot;</span>
  <span class="n">allow_downgrade</span> <span class="kp">true</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install new yum repositories from a file, where the installation of the repository triggers a creation of the yum cache that forces the internal Chef cache to reload:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">execute</span> <span class="s2">&quot;create-yum-cache&quot;</span> <span class="k">do</span>
 <span class="n">command</span> <span class="s2">&quot;yum -q makecache&quot;</span>
 <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span>

<span class="n">ruby_block</span> <span class="s2">&quot;reload-internal-yum-cache&quot;</span> <span class="k">do</span>
  <span class="n">block</span> <span class="k">do</span>
    <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Yum</span><span class="o">::</span><span class="no">YumCache</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">reload</span>
  <span class="k">end</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span>

<span class="n">cookbook_file</span> <span class="s2">&quot;/etc/yum.repos.d/custom.repo&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;custom&quot;</span>
  <span class="n">mode</span> <span class="s2">&quot;0644&quot;</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:execute</span> <span class="o">=&gt;</span> <span class="s2">&quot;create-yum-cache&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
  <span class="n">notifies</span> <span class="ss">:create</span><span class="p">,</span> <span class="n">resources</span><span class="p">(</span><span class="ss">:ruby_block</span> <span class="o">=&gt;</span> <span class="s2">&quot;reload-internal-yum-cache&quot;</span><span class="p">),</span> <span class="ss">:immediately</span>
<span class="k">end</span>
</pre></div>
</div>
<p>xxxxx</p>
</div>
</div>
</div>
<div class="section" id="lightweight-resources-and-providers">
<h2>Lightweight Resources and Providers<a class="headerlink" href="#lightweight-resources-and-providers" title="Permalink to this headline">¶</a></h2>
<p>Custom resources and providers can also be created using the lightweight resource provider (LWRP) DSL. Opscode provides several cookbooks that define some commonly used lightweight resource provider (LWRP). To use the lightweight resources provided by Opscode the cookbook that defines it must also be used. These lightweight resources can be used within recipes to increase automation opportunities.</p>
<p>A lightweight resource is a custom resource that creates an abstract approach for defining a set of actions and (for each action) a set of attributes and validation parameters. A lightweight resource relies on a lightweight provider to take the necessary steps to bring a piece of the system to a desired state.</p>
<p>A lightweight provider is a custom provider that is designed to take the steps that are required to bring a piece of the system to a desired state based on an action that is defined by a lightweight resource.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Typically, using a lightweight provider is the best (and recommended) way of handling a resource that does not already exist. If using a lightweight provider is not an option, then creating a custom provider might be the best approach. Please use the Chef IRC channel to contact us and we will help you get started.</p>
</div>
<p>Lightweight resources and providers are loaded from files that are saved in the following cookbook sub-directories:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Directory</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">providers/</span></tt></td>
<td>The sub-directory in which lightweight providers are located.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">resources/</span></tt></td>
<td>The sub-directory in which lightweight resources are located.</td>
</tr>
</tbody>
</table>
<p>The naming patterns of lightweight resources and providers are determined by the name of the cookbook and by the name of the files in the <tt class="docutils literal"><span class="pre">resources/</span></tt> and <tt class="docutils literal"><span class="pre">providers/</span></tt> sub-directories. For example, if a cookbook named <tt class="docutils literal"><span class="pre">example</span></tt> was downloaded to the Chef repository, it would be located at <tt class="docutils literal"><span class="pre">/cookbooks/example/</span></tt>. If that cookbook contained two resources and two providers, the following files would be part of the <tt class="docutils literal"><span class="pre">resources/</span></tt> directory:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Files</th>
<th class="head">Resource Name</th>
<th class="head">Generated Class</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">default.rb</span></tt></td>
<td>example</td>
<td>Chef::Resource::Example</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">custom.rb</span></tt></td>
<td>custom</td>
<td>Chef::Resource::ExampleCustom</td>
</tr>
</tbody>
</table>
<p>And the following files would be part of the <tt class="docutils literal"><span class="pre">providers/</span></tt> directory:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Files</th>
<th class="head">Provider Name</th>
<th class="head">Generated Class</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">default.rb</span></tt></td>
<td>example</td>
<td>Chef::Provider::Example</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">custom.rb</span></tt></td>
<td>custom</td>
<td>Chef::Provider::ExampleCustom</td>
</tr>
</tbody>
</table>
<p>The following groups of lightweight resources are available in open source cookbooks that are provided by Opscode:</p>
<ul class="simple">
<li>apt</li>
<li>aws</li>
<li>bluepill</li>
<li>chef_handler</li>
<li>daemontools</li>
<li>djbdns</li>
<li>dmg</li>
<li>dynect</li>
<li>firewall</li>
<li>gunicorn</li>
<li>homebrew</li>
<li>mysql</li>
<li>pacman</li>
<li>php</li>
<li>python</li>
<li>riak</li>
<li>samba</li>
<li>transmission</li>
<li>windows</li>
</ul>
<p>Some of the cookbooks contain more than one lightweight resource. Each lightweight resource is described individually in the following sections.</p>
<p><strong>jamescott: need to move the actions and attributes and examples sections into the base INCLUDE files for each of the lightweight resources. There is no reason for them to ever not be included together, therefore. Also need to create a swap_notes file and start putting the notes there.</strong></p>
<div class="section" id="apt-repository">
<h3>apt_repository<a class="headerlink" href="#apt-repository" title="Permalink to this headline">¶</a></h3>
<p>The apt_repository lightweight resource is used to manage APT repositories by dropping a <tt class="docutils literal"><span class="pre">sources.list</span></tt> in <tt class="docutils literal"><span class="pre">etc/apt/sources.list.d</span></tt>. This lightweight resource is only useful on distributions that have APT (for example, Debian or Ubuntu distributions). The <tt class="docutils literal"><span class="pre">sources.list</span></tt> file name is the same as the value for the <tt class="docutils literal"><span class="pre">repo_name</span></tt> attribute.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">apt</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/apt">http://community.opscode.com/cookbooks/apt</a>).</p>
</div>
<div class="section" id="id117">
<h4>Actions<a class="headerlink" href="#id117" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:add</span></tt></td>
<td>Use to add a new repository.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to delete a repository.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id118">
<h4>Attributes<a class="headerlink" href="#id118" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">repo_name</span></tt></td>
<td>The name of the repository. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">uri</span></tt></td>
<td>The URI for the repository. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">distribution</span></tt></td>
<td>The short name for the distribution. For example: <tt class="docutils literal"><span class="pre">lucid</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">components</span></tt></td>
<td>An array of components. For example: <tt class="docutils literal"><span class="pre">[&quot;main&quot;,</span> <span class="pre">&quot;street&quot;])</span></tt>. Default value: <tt class="docutils literal"><span class="pre">[]</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">deb_src</span></tt></td>
<td>Indicates whether the <tt class="docutils literal"><span class="pre">deb-src</span></tt> source repository is added. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">keyserver</span></tt></td>
<td>The key server from which a PGP encryption key is downloaded. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">key</span></tt></td>
<td>The fingerprint of the key server or the URI for the PGP encryption key associated with the repository specified by <tt class="docutils literal"><span class="pre">repo_name</span></tt>. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id119">
<h4>Examples<a class="headerlink" href="#id119" title="Permalink to this headline">¶</a></h4>
<p>Example: /etc/apt/sources.list.d/cloudkick.list (signed repository)</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">apt_repository</span> <span class="s2">&quot;cloudkick&quot;</span> <span class="k">do</span>
  <span class="n">uri</span> <span class="s2">&quot;http://packages.cloudkick.com/ubuntu&quot;</span>
  <span class="n">distribution</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;lsb&#39;</span><span class="o">][</span><span class="s1">&#39;codename&#39;</span><span class="o">]</span>
  <span class="n">components</span> <span class="o">[</span><span class="s2">&quot;main&quot;</span><span class="o">]</span>
  <span class="n">key</span> <span class="s2">&quot;http://packages.cloudkick.com/cloudkick.packages.key&quot;</span>
  <span class="n">action</span> <span class="ss">:add</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: /etc/apt/sources.list.d/opscode.list (signed repository) v2</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">apt_repository</span> <span class="s2">&quot;opscode&quot;</span> <span class="k">do</span>
  <span class="n">uri</span> <span class="s2">&quot;http://apt.opscode.com&quot;</span>
  <span class="n">distribution</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;lsb&#39;</span><span class="o">][</span><span class="s1">&#39;codename&#39;</span><span class="o">]</span> <span class="c1"># or &quot;lucid&quot; if lsb isn&#39;t installed :)</span>
  <span class="n">components</span> <span class="o">[</span><span class="s2">&quot;main&quot;</span><span class="o">]</span>
  <span class="n">key</span> <span class="s2">&quot;http://apt.opscode.com/packages@opscode.com.gpg.key&quot;</span>
  <span class="n">action</span> <span class="ss">:add</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: /etc/apt/sources.list.d/opscode.list (signed repository)</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">apt_repository</span> <span class="s2">&quot;opscode&quot;</span> <span class="k">do</span>
  <span class="n">uri</span> <span class="s2">&quot;http://apt.opscode.com&quot;</span>
  <span class="n">distribution</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;lsb&#39;</span><span class="o">][</span><span class="s1">&#39;codename&#39;</span><span class="o">]</span> <span class="c1"># or &quot;lucid&quot; if lsb isn&#39;t installed :)</span>
  <span class="n">components</span> <span class="o">[</span><span class="s2">&quot;main&quot;</span><span class="o">]</span>
  <span class="n">key</span> <span class="s2">&quot;2940ABA983EF826A&quot;</span>
  <span class="n">keyserver</span> <span class="s2">&quot;pgpkeys.mit.edu&quot;</span>
  <span class="n">action</span> <span class="ss">:add</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: /etc/apt/sources.list.d/hardy-rsyslog-ppa.list (signed repository)</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">apt_repository</span> <span class="s2">&quot;hardy-rsyslog-ppa&quot;</span> <span class="k">do</span>
  <span class="n">uri</span> <span class="s2">&quot;http://ppa.launchpad.net/a.bono/rsyslog/ubuntu&quot;</span>
  <span class="n">distribution</span> <span class="s2">&quot;hardy&quot;</span>
  <span class="n">components</span> <span class="o">[</span><span class="s2">&quot;main&quot;</span><span class="o">]</span>
  <span class="n">keyserver</span> <span class="s2">&quot;keyserver.ubuntu.com&quot;</span>
  <span class="n">key</span> <span class="s2">&quot;C0061A4A&quot;</span>
  <span class="n">action</span> <span class="ss">:add</span>
  <span class="n">notifies</span> <span class="ss">:run</span><span class="p">,</span> <span class="s2">&quot;execute[apt-get update]&quot;</span><span class="p">,</span> <span class="ss">:immediately</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: /etc/apt/sources.list.d/zenoss.list</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">apt_repository</span> <span class="s2">&quot;zenoss&quot;</span> <span class="k">do</span>
  <span class="n">uri</span> <span class="s2">&quot;http://dev.zenoss.org/deb&quot;</span>
  <span class="n">components</span> <span class="o">[</span><span class="s2">&quot;main&quot;</span><span class="p">,</span><span class="s2">&quot;stable&quot;</span><span class="o">]</span>
  <span class="n">action</span> <span class="ss">:add</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: Remove /etc/apt/sources.list.d/zenoss.list</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">apt_repository</span> <span class="s2">&quot;zenoss&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:remove</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-ebs-volume">
<h3>aws_ebs_volume<a class="headerlink" href="#aws-ebs-volume" title="Permalink to this headline">¶</a></h3>
<p>The aws_ebs_volume lightweight resource is used to handle manipulations of Amazon Elastic Block Store volumes. This lightweight resource does not create file systems, mount points, or other storage management tasks. This lightweight resource used the <tt class="docutils literal"><span class="pre">right_aws</span></tt> Ruby gem to access the Amazon EC2 API.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">AWS</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/aws">http://community.opscode.com/cookbooks/aws</a>), which provides libraries, resources, and providers that can be used to configure and manage Amazon Web Services components using the Amazon EC2 API.</p>
</div>
<div class="section" id="amazon-aws-credentials">
<h4>Amazon Web Services Credentials<a class="headerlink" href="#amazon-aws-credentials" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource requires that Amazon Web Services credentials be passed using the <tt class="docutils literal"><span class="pre">aws_access_key</span></tt> and <tt class="docutils literal"><span class="pre">aws_secret_access_key</span></tt> attributes. It is recommended that these be stored as a data bag item. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
   <span class="s2">&quot;aws_access_key_id&quot;</span><span class="p">:</span> <span class="s2">&quot;YOUR AWS ACCESS KEY&quot;</span><span class="p">,</span>
   <span class="s2">&quot;aws_secret_access_key&quot;</span><span class="p">:</span> <span class="s2">&quot;YOUR AWS SECRET ACCESS KEY&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>These values can be loaded in a recipe by using something like the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">aws</span> <span class="o">=</span> data_bag_item<span class="o">(</span><span class="s2">&quot;aws&quot;</span>, <span class="s2">&quot;main&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>and then the elements of the data bag item can be accessed as hash keys in the Amazon Web Services hash. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre>aws<span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span>
aws<span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="id120">
<h4>Actions<a class="headerlink" href="#id120" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Use to create a new Amazon Elastic Block Store volume. This action will only make the API call to create a new volume, which will get a random volume identifier that is generated by Amazon EC2. This identifier can be attached in the same resource by specifying the actions as an array.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:attach</span></tt></td>
<td>Use to attach an existing volume to a node.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:detach</span></tt></td>
<td>Use to detach the specified volume from a node.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:snapshot</span></tt></td>
<td>Use to create a snapshot of the volume.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:prune</span></tt></td>
<td>Use to prune older snapshots from a node.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id121">
<h4>Attributes<a class="headerlink" href="#id121" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">aws_access_key</span></tt></td>
<td>The user name for the secret access key for the API endpoint used with Amazon EC2.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">aws_secret_access_key</span></tt></td>
<td>The password for the secret access key for the API endpoint used with Amazon EC2.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">size</span></tt></td>
<td>The size of the volume (in gigabytes).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">snapshot_id</span></tt></td>
<td>The snapshot with which to build an Amazon Elastic Block Store volume.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">availability_zone</span></tt></td>
<td>The Amazon EC2 availability zone.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">device</span></tt></td>
<td>The local block device to be attached to an Amazon Elastic Block Store volume.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">volume_id</span></tt></td>
<td>The ID for volume to be attached to an Amazon Elastic Block Store volume.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">timeout</span></tt></td>
<td>The connection timeout for the Amazon EC2 API. Default value: <tt class="docutils literal"><span class="pre">3</span> <span class="pre">minutes</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">snapshots_to_keep</span></tt></td>
<td>The number of snapshots to maintain. This attribute is available only when the <tt class="docutils literal"><span class="pre">:prune</span></tt> action is used. Default value: <tt class="docutils literal"><span class="pre">2</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id122">
<h4>Examples<a class="headerlink" href="#id122" title="Permalink to this headline">¶</a></h4>
<p>To create a volume and attach it to a node</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">aws_ebs_volume</span> <span class="s2">&quot;database_volume&quot;</span> <span class="k">do</span>
  <span class="n">aws_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span>
  <span class="n">aws_secret_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span>
  <span class="n">size</span> <span class="mi">50</span>
  <span class="n">device</span> <span class="s2">&quot;/dev/sdm&quot;</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:create</span><span class="p">,</span> <span class="ss">:attach</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To create a volume based on an existing volume snapshot</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">aws_ebs_volume</span> <span class="s2">&quot;db_ebs_volume_from_snapshot&quot;</span> <span class="k">do</span>
  <span class="n">aws_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span>
  <span class="n">aws_secret_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span>
  <span class="n">size</span> <span class="mi">50</span>
  <span class="n">device</span> <span class="s2">&quot;/dev/sdi&quot;</span>
  <span class="n">snapshot_id</span> <span class="s2">&quot;snap-ABCDEFGH&quot;</span> <span class="c1"># creates a new volume based on this snapshot</span>
  <span class="n">action</span> <span class="o">[</span> <span class="ss">:create</span><span class="p">,</span> <span class="ss">:attach</span> <span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To prune all snapshots (except for one)</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">aws_ebs_volume</span> <span class="s2">&quot;prune_snapshots&quot;</span> <span class="k">do</span>
  <span class="n">aws_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span>
  <span class="n">aws_secret_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span>
  <span class="n">volume_id</span> <span class="s2">&quot;vol-ABCDEF12&quot;</span> <span class="c1"># must specify the volume ID to prune</span>
  <span class="n">snapshots_to_keep</span> <span class="mi">1</span>
  <span class="n">action</span> <span class="ss">:prune</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="aws-elastic-ip">
<h3>aws_elastic_ip<a class="headerlink" href="#aws-elastic-ip" title="Permalink to this headline">¶</a></h3>
<p>The aws_elastic_ip lightweight resource is used to associate or disassociate elastic IP addresses used within Amazon EC2. New elastic IP address must be added manually to the Amazon EC2 account. When an elastic IP address is associated with a node, network connectivity may be lost. This lightweight resource used the <tt class="docutils literal"><span class="pre">right_aws</span></tt> Ruby gem to access the Amazon EC2 API.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">AWS</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/aws">http://community.opscode.com/cookbooks/aws</a>), which provides libraries, resources, and providers that can be used to configure and manage Amazon Web Services components using the Amazon EC2 API.</p>
</div>
<div class="section" id="id123">
<h4>Amazon Web Services Credentials<a class="headerlink" href="#id123" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource requires that Amazon Web Services credentials be passed using the <tt class="docutils literal"><span class="pre">aws_access_key</span></tt> and <tt class="docutils literal"><span class="pre">aws_secret_access_key</span></tt> attributes. It is recommended that these be stored as a data bag item. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
   <span class="s2">&quot;aws_access_key_id&quot;</span><span class="p">:</span> <span class="s2">&quot;YOUR AWS ACCESS KEY&quot;</span><span class="p">,</span>
   <span class="s2">&quot;aws_secret_access_key&quot;</span><span class="p">:</span> <span class="s2">&quot;YOUR AWS SECRET ACCESS KEY&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>These values can be loaded in a recipe by using something like the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">aws</span> <span class="o">=</span> data_bag_item<span class="o">(</span><span class="s2">&quot;aws&quot;</span>, <span class="s2">&quot;main&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>and then the elements of the data bag item can be accessed as hash keys in the Amazon Web Services hash. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre>aws<span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span>
aws<span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="id124">
<h4>Actions<a class="headerlink" href="#id124" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:associate</span></tt></td>
<td>Use to associate the specified IP address with a node.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:disassociate</span></tt></td>
<td>Use to disassociate the specified IP address from a node.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id125">
<h4>Attributes<a class="headerlink" href="#id125" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">aws_access_key</span></tt></td>
<td>The user name for the secret access key for the API endpoint used with Amazon EC2.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">aws_secret_access_key</span></tt></td>
<td>The password for the secret access key for the API endpoint used with Amazon EC2.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ip</span></tt></td>
<td>The IP address that is allocated to the node.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">timeout</span></tt></td>
<td>The amount of time before the Amazon EC2 API will time out. Default value: <tt class="docutils literal"><span class="pre">3</span> <span class="pre">minutes</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id126">
<h4>Examples<a class="headerlink" href="#id126" title="Permalink to this headline">¶</a></h4>
<p>Example: Assocating a new IP address The IP below is not valid in Amazon EC2, and is used just as an example.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">aws_elastic_ip</span> <span class="s2">&quot;eip_load_balancer_production&quot;</span> <span class="k">do</span>
  <span class="n">aws_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span>
  <span class="n">aws_secret_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span>
  <span class="n">ip</span> <span class="s2">&quot;192.168.1.42&quot;</span>
  <span class="n">action</span> <span class="ss">:associate</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: Disassociating a new IP address The IP below is not valid in Amazon EC2, and is used just as an example.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">aws_elastic_ip</span> <span class="s2">&quot;eip_load_balancer_production&quot;</span> <span class="k">do</span>
  <span class="n">aws_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_access_key_id&#39;</span><span class="o">]</span>
  <span class="n">aws_secret_access_key</span> <span class="n">aws</span><span class="o">[</span><span class="s1">&#39;aws_secret_access_key&#39;</span><span class="o">]</span>
  <span class="n">ip</span> <span class="s2">&quot;192.168.1.42&quot;</span>
  <span class="n">action</span> <span class="ss">:disassociate</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="bluepill-service">
<h3>bluepill_service<a class="headerlink" href="#bluepill-service" title="Permalink to this headline">¶</a></h3>
<p>The bluepill_service lightweight resource is used to include the Blue Pill process management functionality within a cookbook or a recipe.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">bluepill</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/bluepill">http://community.opscode.com/cookbooks/bluepill</a>).</p>
</div>
<div class="section" id="id127">
<h4>Actions<a class="headerlink" href="#id127" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:start</span></tt></td>
<td>Use to start a service.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:stop</span></tt></td>
<td>Use to stop a service.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to enable a service by adding a pill link.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:disable</span></tt></td>
<td>Use to disable a service by removing a pill link.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:load</span></tt></td>
<td>Use to load a service&#8217;s pill to Blue Pill.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:restart</span></tt></td>
<td>Use to restart a service.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id128">
<h4>Attributes<a class="headerlink" href="#id128" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">service_name</span></tt></td>
<td>The name of the service. A recipe that uses the bluepill_service lightweight resource must contain a template resource for the pill and it must be named <tt class="docutils literal"><span class="pre">NAME.pill.erb</span></tt> where <tt class="docutils literal"><span class="pre">NAME</span></tt> is the <tt class="docutils literal"><span class="pre">service_name</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">variables</span></tt></td>
<td>A hash of variables that are passed into the pill template.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">supports</span></tt></td>
<td>A list of attributes that controls how Chef will attempt to manage a service: <tt class="docutils literal"><span class="pre">:restart</span></tt>, <tt class="docutils literal"><span class="pre">:reload</span></tt>, <tt class="docutils literal"><span class="pre">:status</span></tt>. For <tt class="docutils literal"><span class="pre">:restart</span></tt>, the init script or other service provider can use a restart command; if <tt class="docutils literal"><span class="pre">:restart</span></tt> is not specified, Chef will attempt to stop and then start a service. For <tt class="docutils literal"><span class="pre">:reload</span></tt>, the init script or other service provider can use a reload command. For <tt class="docutils literal"><span class="pre">:status</span></tt>, the init script or other service provider can use a status command to determine if the service is running; if <tt class="docutils literal"><span class="pre">:status</span></tt> is not specified, Chef will attempt to match the <tt class="docutils literal"><span class="pre">service_name</span></tt> against the process table as a regular expression, unless a pattern is specified as a parameter attribute. Default value: <tt class="docutils literal"><span class="pre">{</span> <span class="pre">:restart</span> <span class="pre">=&gt;</span> <span class="pre">true,</span> <span class="pre">:status</span> <span class="pre">=&gt;</span> <span class="pre">true</span> <span class="pre">}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id129">
<h4>Examples<a class="headerlink" href="#id129" title="Permalink to this headline">¶</a></h4>
<p>Example: Using the bluepill_service resource directly</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">bluepill_service</span> <span class="s2">&quot;my_app&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:enable</span><span class="p">,</span> <span class="ss">:load</span><span class="p">,</span> <span class="ss">:start</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Actual bluepill_service resources:</p>
<p>Example: Using the service resource</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">service</span> <span class="s2">&quot;my_app&quot;</span> <span class="k">do</span>
  <span class="n">provider</span> <span class="n">bluepill_service</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:enable</span><span class="p">,</span> <span class="ss">:load</span><span class="p">,</span> <span class="ss">:start</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: template resource in the example recipe</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">template</span> <span class="s2">&quot;/etc/bluepill/my_app&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;my_app.pill.erb&quot;</span>
<span class="k">end</span>
<span class="n">my_app</span><span class="o">.</span><span class="n">pill</span><span class="o">.</span><span class="n">erb</span>
<span class="no">Bluepill</span><span class="o">.</span><span class="n">application</span><span class="p">(</span><span class="s2">&quot;my_app&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="n">app</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;my_app&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">process</span><span class="o">|</span>
    <span class="n">process</span><span class="o">.</span><span class="n">pid_file</span> <span class="o">=</span> <span class="s2">&quot;/var/run/my_app.pid&quot;</span>
    <span class="n">process</span><span class="o">.</span><span class="n">start_command</span> <span class="o">=</span> <span class="s2">&quot;/usr/bin/my_app&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="chef-handler">
<h3>chef_handler<a class="headerlink" href="#chef-handler" title="Permalink to this headline">¶</a></h3>
<p>A handler is a feature of Chef that is used to trigger certain behaviors in response to certain situations, typically identified during a Chef run.</p>
<ul class="simple">
<li>An exception handler is used to trigger behaviors when a defined aspect of a Chef run fails.</li>
<li>A report handler is used to trigger behaviors when a defined aspect of a Chef run is successful.</li>
</ul>
<p>Both types of handlers can be used to gather data about a Chef run, and when used across the entire Chef organization, can provide rich levels of data about all types of Chef usage that can be used later for trending and analysis. <strong>jamescott: this really needs to be re-written. Basically, Chef can track GOBS of data based on the success/fail of a Chef run and then once collected, the customer can do LOTS OF THINGS with it, including to trigger custom actions based on exceptions (and probably not based on reports) so that the system can adjust in real-time to things that go wrong. JUST A GUESS.</strong></p>
<p>The chef_handler lightweight resource is used to allow cookbook authors to ship a product-specific handler. This lightweight resource requires, configures, and enables handlers on a node for the current Chef run and can pass arguments to the initializer, which allows initialization data to be pulled from a node&#8217;s attribute data. This lightweight resource should be declared early in the compile phase so it may trigger exceptions during the Chef run. For a base role, recipes that register Chef handlers should come first in the run_list.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">chef_handler</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/chef_handler">http://community.opscode.com/cookbooks/chef_handler</a>).</p>
</div>
<div class="section" id="id130">
<h4>Actions<a class="headerlink" href="#id130" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to enable the Chef handler for the current Chef run on the current node.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:disable</span></tt></td>
<td>Use to disable the Chef handler for the current Chef run on the current node.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id131">
<h4>Attributes<a class="headerlink" href="#id131" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">class_name</span></tt></td>
<td>The name of the handler class. This can be module name-spaced.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>The full path to the handler file or the path to a gem (if the handler ships as part of a Ruby gem).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">arguments</span></tt></td>
<td>An array of arguments that are passed to the initializer for the handler class.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">supports</span></tt></td>
<td>The type of Chef handler to be registered as: <tt class="docutils literal"><span class="pre">:report</span></tt>, <tt class="docutils literal"><span class="pre">:exception</span></tt> or <tt class="docutils literal"><span class="pre">both</span></tt>. Default value: <tt class="docutils literal"><span class="pre">{</span> <span class="pre">:report</span> <span class="pre">=&gt;</span> <span class="pre">true,</span> <span class="pre">:exception</span> <span class="pre">=&gt;</span> <span class="pre">true</span> <span class="pre">}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id132">
<h4>Examples<a class="headerlink" href="#id132" title="Permalink to this headline">¶</a></h4>
<p>Example: enable the CloudkickHandler which was dropped off in the default handler path. Also passes the oauth key/secret to the handler&#8217;s initializer</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">chef_handler</span> <span class="s2">&quot;CloudkickHandler&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;chef_handler&#39;</span><span class="o">][</span><span class="s1">&#39;handler_path&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">/cloudkick_handler.rb&quot;</span>
  <span class="n">arguments</span> <span class="o">[</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;cloudkick&#39;</span><span class="o">][</span><span class="s1">&#39;oauth_key&#39;</span><span class="o">]</span><span class="p">,</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;cloudkick&#39;</span><span class="o">][</span><span class="s1">&#39;oauth_secret&#39;</span><span class="o">]]</span>
  <span class="n">action</span> <span class="ss">:enable</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: enable handler during the compile phase</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">chef_handler</span> <span class="s2">&quot;Chef::Handler::JsonFile&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;chef/handler/json_file&quot;</span>
  <span class="n">arguments</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">&#39;/var/chef/reports&#39;</span>
  <span class="n">action</span> <span class="ss">:nothing</span>
<span class="k">end</span><span class="o">.</span><span class="n">run_action</span><span class="p">(</span><span class="ss">:enable</span><span class="p">)</span>
</pre></div>
</div>
<p>Example: handle exceptions only</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">chef_handler</span> <span class="s2">&quot;Chef::Handler::JsonFile&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;chef/handler/json_file&quot;</span>
  <span class="n">arguments</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">&#39;/var/chef/reports&#39;</span>
  <span class="n">supports</span> <span class="ss">:exception</span> <span class="o">=&gt;</span> <span class="kp">true</span>
  <span class="n">action</span> <span class="ss">:enable</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Example: register the Chef::Handler::JsonFile handler that ships as part of the Chef gem</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">chef_handler</span> <span class="s2">&quot;Chef::Handler::JsonFile&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;chef/handler/json_file&quot;</span>
  <span class="n">arguments</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">&#39;/var/chef/reports&#39;</span>
  <span class="n">action</span> <span class="ss">:enable</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="daemontools-service">
<h3>daemontools_service<a class="headerlink" href="#daemontools-service" title="Permalink to this headline">¶</a></h3>
<p>The daemontools_service lightweight resource is used to manage UNIX services using the <tt class="docutils literal"><span class="pre">svc</span></tt> command. All of the available actions correspond to command-line parameters in the <tt class="docutils literal"><span class="pre">svc</span></tt> command. The <tt class="docutils literal"><span class="pre">svc</span></tt> command is idempotent.</p>
<p>For more information: <a class="reference external" href="http://cr.yp.to/daemontools.html">http://cr.yp.to/daemontools.html</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">daemontools</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/daemontools">http://community.opscode.com/cookbooks/daemontools</a>).</p>
</div>
<div class="section" id="id133">
<h4>Actions<a class="headerlink" href="#id133" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:start</span></tt></td>
<td>Use to start a service. If the service stops, restart it. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-u</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:stop</span></tt></td>
<td>Use to stop a service using the <tt class="docutils literal"><span class="pre">STOP</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-p</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:restart</span></tt></td>
<td>Use to restart a service using the <tt class="docutils literal"><span class="pre">TERM</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-t</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:up</span></tt></td>
<td>Use to start a service. If the service stops, restart it. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-u</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:once</span></tt></td>
<td>Use to start a service. The service does not restart if it stops. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-o</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:pause</span></tt></td>
<td>Use to send the <tt class="docutils literal"><span class="pre">STOP</span></tt> signal to pause a service. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-p</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:cont</span></tt></td>
<td>Use to send the <tt class="docutils literal"><span class="pre">CONT</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-c</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:hup</span></tt></td>
<td>Use to send the <tt class="docutils literal"><span class="pre">HUP</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-h</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:alrm</span></tt></td>
<td>Use to send the <tt class="docutils literal"><span class="pre">ALRM</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-a</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:int</span></tt></td>
<td>Use to send the <tt class="docutils literal"><span class="pre">INT</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-i</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:term</span></tt></td>
<td>Use to send the <tt class="docutils literal"><span class="pre">TERM</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-t</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:kill</span></tt></td>
<td>Use to send the <tt class="docutils literal"><span class="pre">KILL</span></tt> signal. The following command is used: <tt class="docutils literal"><span class="pre">svc</span> <span class="pre">-k</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to enable a service by setting up the service directory and link.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:disable</span></tt></td>
<td>Use to disable a service by removing the link to the service directory.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id134">
<h4>Attributes<a class="headerlink" href="#id134" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">service_name</span></tt></td>
<td>The name of the service.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">directory</span></tt></td>
<td>Required. The directory in which the service is set up.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">template</span></tt></td>
<td>The name variable for the template files. The run script is set up by a template named <tt class="docutils literal"><span class="pre">sv-NAME-run.erb</span></tt>. The log/run script is set up by a template named <tt class="docutils literal"><span class="pre">sv-NAME-log-run.erb</span></tt>. The finish script is set up by a template named <tt class="docutils literal"><span class="pre">sv-NAME-finish.erb</span></tt>. For each of these scripts, the <tt class="docutils literal"><span class="pre">NAME</span></tt> placeholder will be replaced by the value specified for this attribute. These templates should be located in the directory of a cookbook that uses this lightweight resource. Default value: <tt class="docutils literal"><span class="pre">NAME</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">cookbook</span></tt></td>
<td>The cookbook in which the template files are located (if they are not located in the current cookbook).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">variables</span></tt></td>
<td>A hash of variables that are passed to the template file. Default value: <tt class="docutils literal"><span class="pre">{}</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of the service directory and scripts.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>The group of the service directory and scripts.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">finish</span></tt></td>
<td>Indicates whether a service has a finish script. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">log</span></tt></td>
<td>Indicates whether a service has a custom logging script. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">env</span></tt></td>
<td>Use to create an <tt class="docutils literal"><span class="pre">env</span></tt> directory for a service. The directory will contain files named for each environment variable that is required, with the contents of its value in a hash. For more information about how to use this attribute, see: <a class="reference external" href="http://cr.yp.to/daemontools/envdir.html">http://cr.yp.to/daemontools/envdir.html</a>. Default value: <tt class="docutils literal"><span class="pre">{}</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id135">
<h4>Examples<a class="headerlink" href="#id135" title="Permalink to this headline">¶</a></h4>
<p>Example: The following example will set up /etc/sv/chef-client directory, /etc/sv/chef-client/run script from the specified template, and the /etc/sv/chef-client/log/run script.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">chef</span><span class="o">-</span><span class="n">client</span> <span class="n">service</span>
<span class="n">daemontools_service</span> <span class="s2">&quot;chef-client&quot;</span> <span class="k">do</span>
  <span class="n">directory</span> <span class="s2">&quot;/etc/sv/chef-client&quot;</span>
  <span class="n">template</span> <span class="s2">&quot;chef-client&quot;</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:enable</span><span class="p">,</span><span class="ss">:start</span><span class="o">]</span>
  <span class="n">log</span> <span class="kp">true</span>
<span class="k">end</span>
<span class="n">sv</span><span class="o">-</span><span class="n">chef</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">run</span><span class="o">.</span><span class="n">erb</span>
<span class="c1">#!/bin/sh</span>
<span class="no">PATH</span><span class="o">=</span><span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="ss">:/</span><span class="n">bin</span><span class="ss">:/</span><span class="n">sbin</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span>
<span class="nb">exec</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="nb">exec</span> <span class="sr">/usr/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span> <span class="n">chef</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="sx">%= node[&quot;chef_client&quot;][&quot;interval&quot;] %&gt; -s &lt;%=</span> <span class="n">node</span><span class="o">[</span><span class="s2">&quot;chef_client&quot;</span><span class="o">][</span><span class="s2">&quot;splay&quot;</span><span class="o">]</span> <span class="o">%&gt;</span>
<span class="n">sv</span><span class="o">-</span><span class="n">chef</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="n">run</span><span class="o">.</span><span class="n">erb</span>
<span class="c1">#!/bin/sh</span>
<span class="nb">exec</span> <span class="n">svlogd</span> <span class="o">-</span><span class="n">tt</span> <span class="o">.</span><span class="n">/main</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="djbdns-rr">
<h3>djbdns_rr<a class="headerlink" href="#djbdns-rr" title="Permalink to this headline">¶</a></h3>
<p>The djbdns_rr lightweight resource is used to create new DNS resource records for Tinydns servers by using the tinydns-edit command. Tinydns is a component of djbdns.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">djbdns</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/djbdns">http://community.opscode.com/cookbooks/djbdns</a>).</p>
</div>
<div class="section" id="id136">
<h4>Actions<a class="headerlink" href="#id136" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:add</span></tt></td>
<td>Use to add a new resource record to Tinydns.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id137">
<h4>Attributes<a class="headerlink" href="#id137" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">fqdn</span></tt></td>
<td>The fully qualified domain name.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ip</span></tt></td>
<td>Required. The IP address.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">type</span></tt></td>
<td>The type of record: <tt class="docutils literal"><span class="pre">ns</span></tt>, <tt class="docutils literal"><span class="pre">childns</span></tt>, <tt class="docutils literal"><span class="pre">host</span></tt>, <tt class="docutils literal"><span class="pre">alias</span></tt>, or <tt class="docutils literal"><span class="pre">mx</span></tt>. Default value: <tt class="docutils literal"><span class="pre">host</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">cwd</span></tt></td>
<td>The current working directory in which the Tinydns data file is located.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id138">
<h4>Examples<a class="headerlink" href="#id138" title="Permalink to this headline">¶</a></h4>
<p>In the example, the node[:djbdns][:tinydns_internal_dir] is the djbdns cookbook attribute for the default location where the internal tinydns service is configured.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">djbdns_rr</span> <span class="s2">&quot;www.example.com&quot;</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="ss">:djbdns</span><span class="o">][</span><span class="ss">:tinydns_internal_dir</span><span class="o">]</span><span class="si">}</span><span class="s2">/root&quot;</span>
  <span class="n">ip</span> <span class="s2">&quot;192.168.1.10&quot;</span>
  <span class="n">type</span> <span class="s2">&quot;host&quot;</span>
  <span class="n">action</span> <span class="ss">:add</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dmg-package">
<h3>dmg_package<a class="headerlink" href="#dmg-package" title="Permalink to this headline">¶</a></h3>
<p>The dmg_package lightweight resource is used to install applications from Mac OS X Apple Disk Image (.dmg) files. This lightweight resource will install a package by retrieving the file from a remote URL, mounting the file using the HDI driver backing store service (hdid), copying the application directory to the specified directory, detaching the image (using <tt class="docutils literal"><span class="pre">hdiutil</span></tt>), and then storing the file in the <tt class="docutils literal"><span class="pre">Chef::Config[:file_cache_path]</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource does not do full package management for Mac OS X applications, as they have different installed artifacts.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">dmg</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/dmg">http://community.opscode.com/cookbooks/dmg</a>).</p>
</div>
<div class="section" id="id139">
<h4>Actions<a class="headerlink" href="#id139" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Use to install an application. (There is no <tt class="docutils literal"><span class="pre">:uninstall</span></tt> action because on in the Mac OS X environment, uninstalling an application only requires it being dragged to the trash can.)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id140">
<h4>Attributes<a class="headerlink" href="#id140" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">app</span></tt></td>
<td>The name of the application used for the <tt class="docutils literal"><span class="pre">/Volumes</span></tt> directory and <tt class="docutils literal"><span class="pre">.app</span></tt> directory copied to <tt class="docutils literal"><span class="pre">/Applications</span></tt>. Default value: <tt class="docutils literal"><span class="pre">name</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>The remote URL for the Apple Disk Image (.dmg) to be download. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">destination</span></tt></td>
<td>The directory to which the <tt class="docutils literal"><span class="pre">.app</span></tt> directory is copied. Default value: <tt class="docutils literal"><span class="pre">/Applications</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">checksum</span></tt></td>
<td>The SHA-256 checksum for the Apple Disk Image (.dmg) to be downloaded. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">volumes_dir</span></tt></td>
<td>The directory under <tt class="docutils literal"><span class="pre">/Volumes</span></tt> where the Apple Disk Image (.dmg) is to be mounted. Default value: <tt class="docutils literal"><span class="pre">app</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">dmg_name</span></tt></td>
<td>The name of the Apple Disk Image (.dmg) (if it is not the same as the <tt class="docutils literal"><span class="pre">app</span></tt> attribute or if the name of the application contains spaces). Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id141">
<h4>Examples<a class="headerlink" href="#id141" title="Permalink to this headline">¶</a></h4>
<p>To install Google Chrome. Uses the dmg_name because the application name has spaces. Installs in /Applications/Google Chrome.app.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">dmg_package</span> <span class="s2">&quot;Google Chrome&quot;</span> <span class="k">do</span>
   <span class="n">dmg_name</span> <span class="s2">&quot;googlechrome&quot;</span>
   <span class="n">source</span> <span class="s2">&quot;https://dl-ssl.google.com/chrome/mac/stable/GGRM/googlechrome.dmg&quot;</span>
   <span class="n">checksum</span> <span class="s2">&quot;7daa2dc5c46d9bfb14f1d7ff4b33884325e5e63e694810adc58f14795165c91a&quot;</span>
   <span class="n">action</span> <span class="ss">:install</span>
 <span class="k">end</span>
</pre></div>
</div>
<p>The following examples all use the SHA256 checksum that was current when the application was originally installed, and may not be current for the latest releases.</p>
<p>If you want to install an application that has already been downloaded (not using the source parameter), copy it to the appropriate location. You can find out what directory this is with the following command on the node to run chef:</p>
<div class="highlight-bash"><div class="highlight"><pre>knife <span class="nb">exec</span> -E <span class="s1">&#39;p Chef::Config[:file_cache_path]&#39;</span> -c /etc/chef/client.rb
</pre></div>
</div>
<p>To install Dropbox. Uses volumes_dir because the mounted directory is different than the name of the application directory. Installs in /Applications/Dropbox.app.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">dmg_package</span> <span class="s2">&quot;Dropbox&quot;</span> <span class="k">do</span>
   <span class="n">volumes_dir</span> <span class="s2">&quot;Dropbox Installer&quot;</span>
   <span class="n">source</span> <span class="s2">&quot;http://www.dropbox.com/download?plat=mac&quot;</span>
   <span class="n">checksum</span> <span class="s2">&quot;b4ea620ca22b0517b75753283ceb82326aca8bc3c86212fbf725de6446a96a13&quot;</span>
   <span class="n">action</span> <span class="ss">:install</span>
 <span class="k">end</span>
</pre></div>
</div>
<p>The following examples all use the SHA256 checksum that was current when the application was originally installed, and may not be current for the latest releases.</p>
<p>To install MacIrssi to ~/Applications from the local file downloaded to the cache path into an Applications directory in the current user&#8217;s home directory.</p>
<p>Chef should run as a non-root user for this: directory &#8220;#{ENV[&#8216;HOME&#8217;]}/Applications&#8221;</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">dmg_package</span> <span class="s2">&quot;MacIrssi&quot;</span> <span class="k">do</span>
   <span class="n">destination</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;HOME&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">/Applications&quot;</span>
   <span class="n">action</span> <span class="ss">:install</span>
 <span class="k">end</span>
</pre></div>
</div>
<p>The following examples all use the SHA256 checksum that was current when the application was originally installed, and may not be current for the latest releases.</p>
<p>To install /Applications/Tunnelblick.app from the primary download site.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">dmg_package</span> <span class="s2">&quot;Tunnelblick&quot;</span> <span class="k">do</span>
   <span class="n">source</span> <span class="s2">&quot;http://tunnelblick.googlecode.com/files/Tunnelblick_3.1.2.dmg&quot;</span>
   <span class="n">checksum</span> <span class="s2">&quot;a3fae60b6833175f32df20c90cd3a3603a&quot;</span>
   <span class="n">action</span> <span class="ss">:install</span>
 <span class="k">end</span>
</pre></div>
</div>
<p>The following examples all use the SHA256 checksum that was current when the application was originally installed, and may not be current for the latest releases.</p>
</div>
</div>
<div class="section" id="dynect-rr">
<h3>dynect_rr<a class="headerlink" href="#dynect-rr" title="Permalink to this headline">¶</a></h3>
<p>The dynect_rr lightweight resource is used to create resource records using the DNS Update API.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">dynect</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/dynect">http://community.opscode.com/cookbooks/dynect</a>). The <tt class="docutils literal"><span class="pre">dynect_rest</span></tt> Ruby gem is required.</p>
</div>
<div class="section" id="id142">
<h4>Actions<a class="headerlink" href="#id142" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete a record.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Use to create a record.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:update</span></tt></td>
<td>Use to update an existing record.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:replace</span></tt></td>
<td>Use to replace an existing record.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id143">
<h4>Attributes<a class="headerlink" href="#id143" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">record_type</span></tt></td>
<td>The type of record. For example: <tt class="docutils literal"><span class="pre">A</span></tt>, <tt class="docutils literal"><span class="pre">CNAME</span></tt>, and so on.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rdata</span></tt></td>
<td>The record data.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ttl</span></tt></td>
<td>The record time to live.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">fqdn</span></tt></td>
<td>The fully qualified domain name.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">username</span></tt></td>
<td>The DNS Update API username.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">customer</span></tt></td>
<td>The DNS Update API customer ID.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">password</span></tt></td>
<td>The DNS Update API password.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">zone</span></tt></td>
<td>The DNS zone.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id144">
<h4>Examples<a class="headerlink" href="#id144" title="Permalink to this headline">¶</a></h4>
<p>To create a record, with authentication credentials as node attributes:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">dynect_rr</span> <span class="s2">&quot;webprod&quot;</span> <span class="k">do</span>
  <span class="n">record_type</span> <span class="s2">&quot;A&quot;</span>
  <span class="n">rdata</span><span class="p">({</span><span class="s2">&quot;address&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;10.1.1.10&quot;</span><span class="p">})</span>
  <span class="n">fqdn</span> <span class="s2">&quot;webprod.example.com&quot;</span>
  <span class="n">customer</span> <span class="n">node</span><span class="o">[</span><span class="ss">:dynect</span><span class="o">][</span><span class="ss">:customer</span><span class="o">]</span>
  <span class="n">username</span> <span class="n">node</span><span class="o">[</span><span class="ss">:dynect</span><span class="o">][</span><span class="ss">:username</span><span class="o">]</span>
  <span class="n">password</span> <span class="n">node</span><span class="o">[</span><span class="ss">:dynect</span><span class="o">][</span><span class="ss">:password</span><span class="o">]</span>
  <span class="n">zone</span>     <span class="n">node</span><span class="o">[</span><span class="ss">:dynect</span><span class="o">][</span><span class="ss">:zone</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="firewall">
<h3>firewall<a class="headerlink" href="#firewall" title="Permalink to this headline">¶</a></h3>
<p>The firewall lightweight resource is used to handle the state of a firewall (enabled, disabled, and reset).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">firewall</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/firewall">http://community.opscode.com/cookbooks/firewall</a>), which provides a set of primitives for managing firewalls and associated rules.</p>
</div>
<div class="section" id="id145">
<h4>Actions<a class="headerlink" href="#id145" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to enable a firewall. Rules that have been defined for that firewall will be activated.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:disable</span></tt></td>
<td>Use to disable a firewall. Rules will be de-activated and the node will be put into an unprotected state.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:reset</span></tt></td>
<td>Use to reset a firewall. Rules will be de-activated and the node will be put into the default state. This action does not enable or disable a firewall.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id146">
<h4>Attributes<a class="headerlink" href="#id146" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">name</span></tt></td>
<td>An arbitrary name that is used to uniquely identify the resource.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id147">
<h4>Examples<a class="headerlink" href="#id147" title="Permalink to this headline">¶</a></h4>
<p>To enable platform default firewall</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">firewall</span> <span class="s2">&quot;ufw&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:enable</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="firewall-rule">
<h3>firewall_rule<a class="headerlink" href="#firewall-rule" title="Permalink to this headline">¶</a></h3>
<p>The firewall_rule lightweight resource is used to add rules to a firewall.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">firewall</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/firewall">http://community.opscode.com/cookbooks/firewall</a>), which provides a set of primitives for managing firewalls and associated rules.</p>
</div>
<div class="section" id="id148">
<h4>Actions<a class="headerlink" href="#id148" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:allow</span></tt></td>
<td>Use to set a rule that allows incoming traffic.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:deny</span></tt></td>
<td>Use to set a rule that denies incoming traffic.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:reject</span></tt></td>
<td>Use to set a rule that rejects incoming traffic.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id149">
<h4>Attributes<a class="headerlink" href="#id149" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">name</span></tt></td>
<td>A unique name for a firewall rule.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">protocol</span></tt></td>
<td>The protocol used by the firewall rule. Valid values are: <tt class="docutils literal"><span class="pre">:all</span></tt>, <tt class="docutils literal"><span class="pre">:udp</span></tt>, <tt class="docutils literal"><span class="pre">:tcp</span></tt>. Default value: <tt class="docutils literal"><span class="pre">:all</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">port</span></tt></td>
<td>The port number.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>The IP address or subnet from which incoming traffic originates. Default value: <tt class="docutils literal"><span class="pre">0.0.0.0/0</span></tt> (from &#8220;anywhere&#8221;).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">destination</span></tt></td>
<td>The IP address or subnet to which traffic is routed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">position</span></tt></td>
<td>The position at which a rule is inserted. If this value is not specified, a rule is inserted at the end of a rule list.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id150">
<h4>Examples<a class="headerlink" href="#id150" title="Permalink to this headline">¶</a></h4>
<p>To open standard ssh port, enable firewall</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">firewall_rule</span> <span class="s2">&quot;ssh&quot;</span> <span class="k">do</span>
  <span class="n">port</span> <span class="mi">22</span>
  <span class="n">action</span> <span class="ss">:allow</span>
  <span class="n">notifies</span> <span class="ss">:enable</span><span class="p">,</span> <span class="s2">&quot;firewall[ufw]&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To open standard http port to tcp traffic only; insert as first rule; enable firewall</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">firewall_rule</span> <span class="s2">&quot;http&quot;</span> <span class="k">do</span>
  <span class="n">port</span> <span class="mi">80</span>
  <span class="n">protocol</span> <span class="ss">:tcp</span>
  <span class="n">position</span> <span class="mi">1</span>
  <span class="n">action</span> <span class="ss">:allow</span>
  <span class="n">notifies</span> <span class="ss">:enable</span><span class="p">,</span> <span class="s2">&quot;firewall[ufw]&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gunicorn-config-needs-review">
<h3>gunicorn_config &#8211; NEEDS REVIEW<a class="headerlink" href="#gunicorn-config-needs-review" title="Permalink to this headline">¶</a></h3>
<p>The gunicorn_config is used to install the latest version of Gunicorn using pip and then manage Gunicorn configuration files. Gunicorn is a web service gateway interface server for UNIX that is a pre-fork worker model from the Ruby Unicorn project.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">gunicorn</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/gunicorn">http://community.opscode.com/cookbooks/gunicorn</a>).</p>
</div>
<div class="section" id="id151">
<h4>Actions<a class="headerlink" href="#id151" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Use to create a Gunicorn configuration file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete a Gunicorn configuration file.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id152">
<h4>Attributes<a class="headerlink" href="#id152" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:backlog</span></tt></td>
<td>The maximum number of pending connections. Default value: <tt class="docutils literal"><span class="pre">2048</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:cookbook</span></tt></td>
<td>The cookbook in which a template file is located. Default value: <tt class="docutils literal"><span class="pre">gunicorn</span></tt> (the <tt class="docutils literal"><span class="pre">gunicorn</span></tt> cookbook).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:group</span></tt></td>
<td>A string or identifier for the group owner of a configuration file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:listen</span></tt></td>
<td>The socket to bind. This value must be a string in the form: <tt class="docutils literal"><span class="pre">HOST</span></tt>, <tt class="docutils literal"><span class="pre">HOST:PORT</span></tt>, or <tt class="docutils literal"><span class="pre">unix:PATH</span></tt>. Default value: <tt class="docutils literal"><span class="pre">0.0.0.0:8000</span></tt> which will listen on port 8000 for all interfaces.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:owner</span></tt></td>
<td>A string or identifier for the owner for a configuration file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:path</span></tt></td>
<td>The path to the location in which the configuration file will be created.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:pid</span></tt></td>
<td>The file name for the process identifier (PID) file. Default value: `` `` (no file).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:preload_app</span></tt></td>
<td>Indicates whether application code should be loaded before worker processes are forked. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:server_hooks</span></tt></td>
<td>A hash with values that are rendered as Gunicorn server hook functions named after the hash item&#8217;s key name. Default value: <tt class="docutils literal"><span class="pre">{}</span></tt> (no server hooks).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:template</span></tt></td>
<td>The template to use when rendering a configuration file. Default value: <tt class="docutils literal"><span class="pre">gunicorn.py.erb</span></tt> (included as part of the <tt class="docutils literal"><span class="pre">gunicorn</span></tt> cookbook).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:worker_class</span></tt></td>
<td>The type of workers to use. Default value: <tt class="docutils literal"><span class="pre">sync</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:worker_keepalive</span></tt></td>
<td>The amount of time (in seconds) to wait for requests on a keep-alive connection. Default value: <tt class="docutils literal"><span class="pre">2</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:worker_max_requests</span></tt></td>
<td>The maximum number of requests a worker will process before restarting. Default value: <tt class="docutils literal"><span class="pre">0</span></tt> (which disables worker restarts).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:worker_processes</span></tt></td>
<td>The number of worker processes available to handle requests. Default value: <tt class="docutils literal"><span class="pre">4</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:worker_timeout</span></tt></td>
<td>The amount of time (in seconds) to wait before a worker is killed and restarted. Default value: <tt class="docutils literal"><span class="pre">60</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id153">
<h4>Examples<a class="headerlink" href="#id153" title="Permalink to this headline">¶</a></h4>
<p>To create a configuration file with default values:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gunicorn_config</span> <span class="s2">&quot;/etc/gunicorn/myapp.py&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To tweak some worker-related values:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gunicorn_config</span> <span class="s2">&quot;/etc/gunicorn/myapp.py&quot;</span> <span class="k">do</span>
  <span class="n">worker_processes</span> <span class="mi">8</span>
  <span class="n">backlog</span> <span class="mi">4096</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use the <tt class="docutils literal"><span class="pre">pre_fork</span></tt> server hook to sleep for one second before forking:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gunicorn_config</span> <span class="s2">&quot;/etc/gunicorn/myapp.py&quot;</span> <span class="k">do</span>
  <span class="n">server_hooks</span><span class="p">({</span><span class="ss">:pre_fork</span> <span class="o">=&gt;</span> <span class="s1">&#39;import time;time.sleep(1)&#39;</span><span class="p">})</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gunicorn-install-needs-review">
<h3>gunicorn_install &#8211; NEEDS REVIEW<a class="headerlink" href="#gunicorn-install-needs-review" title="Permalink to this headline">¶</a></h3>
<p>The gunicorn_install is used to install the latest version of Gunicorn using pip to a targeted virtual environment. This action overrides <tt class="docutils literal"><span class="pre">node[&quot;gunicorn&quot;][&quot;virtualenv&quot;]</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">gunicorn</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/gunicorn">http://community.opscode.com/cookbooks/gunicorn</a>).</p>
</div>
<div class="section" id="id154">
<h4>Actions<a class="headerlink" href="#id154" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Use to install a virtual environment.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id155">
<h4>Attributes<a class="headerlink" href="#id155" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">virtualenv</span></tt></td>
<td>The name of the virtual environment.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id156">
<h4>Examples<a class="headerlink" href="#id156" title="Permalink to this headline">¶</a></h4>
<p>To install Gunicorn to a specified virtual environment:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gunicorn_install</span> <span class="s2">&quot;name_of_virtual_environment&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="homebrew-needs-review">
<h3>homebrew &#8211; NEEDS REVIEW<a class="headerlink" href="#homebrew-needs-review" title="Permalink to this headline">¶</a></h3>
<p>The homebrew_tap is used to run Homebrew as the default package provider on Mac OS X. This lightweight provider replaces MacPorts.</p>
<p>Homebrew requires the <tt class="docutils literal"><span class="pre">/usr/local</span></tt> directory; the user that will run the cookbook must be the owner of that directory. See the Homebrew FAQ for more information: <a class="reference external" href="https://github.com/mxcl/homebrew/wiki/FAQ">https://github.com/mxcl/homebrew/wiki/FAQ</a>.</p>
<p>Be sure to add <tt class="docutils literal"><span class="pre">recipe[homebrew]</span></tt> to the run list for any node that be using Homebrew. This will ensure that it is available to Chef and that Homebrew is installed when it is necessary.</p>
<p>If any nodes require MacPorts, be careful about adding an explicit dependency for Homebrew to metadata, as this will cause the <tt class="docutils literal"><span class="pre">homebrew</span></tt> cookbook to be downloaded, its library loaded, and the default package provider on the local system to be changed to Homebrew.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">homebrew</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/homebrew">http://community.opscode.com/cookbooks/homebrew</a>).</p>
</div>
<div class="section" id="id157">
<h4>Actions<a class="headerlink" href="#id157" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Default. Use to install a package. If a version is specified, use to install the specified version of a package. This action is inherited from the Package resource resource.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:purge</span></tt></td>
<td>Use to purge a package. This action typically removes the configuration files as well as the package. This action is inherited from the Package resource resource. For Homebrew, this is effectively the same as the <tt class="docutils literal"><span class="pre">:remove</span></tt> action.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a package. This action is inherited from the Package resource resource.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:tap</span></tt></td>
<td>Use to enable a formula repository located on github.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:untap</span></tt></td>
<td>Use to disable a formula repository located on github.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:upgrade</span></tt></td>
<td>Use to upgrade a package to the latest version. This action is inherited from the Package resource resource. For Homebrew, there isn&#8217;t an upgrade, rather Homebrew performs the <tt class="docutils literal"><span class="pre">:install</span></tt> action every time, effectively upgrading a package when it is newer than the one installed previously.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id158">
<h4>Attributes<a class="headerlink" href="#id158" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">name</span></tt></td>
<td>The name of a formula repository located on github.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">tapped</span></tt></td>
<td>Indicates that a formula repository is tapped.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id159">
<h4>Providers<a class="headerlink" href="#id159" title="Permalink to this headline">¶</a></h4>
<p>Use the following provider when using the Package resource in a recipe when the homebrew_tap lightweight resource:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="16%" />
<col width="8%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Default?</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Homebrew</span></tt></td>
<td><tt class="docutils literal"><span class="pre">homebrew_package</span></tt></td>
<td>&nbsp;</td>
<td>This is the default provider for the Mac OS X platform when the homebrew_tap lightweight resource is used.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id160">
<h4>Examples<a class="headerlink" href="#id160" title="Permalink to this headline">¶</a></h4>
<p>If Homebrew is installed on a machine running Mac OS X, the following example will use Homebrew to install MySQL:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;mysql&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use the Homebrew provider:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;mysql&quot;</span> <span class="k">do</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Homebrew</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To tap a repository:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">homebrew_tap</span> <span class="s2">&quot;homebrew/dupes&quot;</span>
</pre></div>
</div>
<p>To untap a repository:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">homebrew_tap</span> <span class="s2">&quot;homebrew/dupes&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:untap</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mysql-database">
<h3>mysql_database<a class="headerlink" href="#mysql-database" title="Permalink to this headline">¶</a></h3>
<p>The mysql_database lightweight resource is used to use the Ruby library provided by the MySQL gem to interact with a MySQL database. The various actions available to this lightweight resource correspond to the types of queries that may be sent to the database.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">mysql</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/mysql">http://community.opscode.com/cookbooks/mysql</a>).</p>
</div>
<div class="section" id="id161">
<h4>Actions<a class="headerlink" href="#id161" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:flush_tables_with_read_lock</span></tt></td>
<td>Use to flush tables with a read lock. This action should be used only when performing replication.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:unflush_tables</span></tt></td>
<td>Use to unflush tables. This action should be used only when performing replication.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create_db</span></tt></td>
<td>Use to create a database.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:query</span></tt></td>
<td>Use to query a database.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id162">
<h4>Attributes<a class="headerlink" href="#id162" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">host</span></tt></td>
<td>Host of the database server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">username</span></tt></td>
<td>The username with which a connection is made.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">password</span></tt></td>
<td>The password for the specified username.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">database</span></tt></td>
<td>The name of the database to be created. This attribute can be used only with the <tt class="docutils literal"><span class="pre">create_db</span> <span class="pre">action</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id163">
<h4>Examples<a class="headerlink" href="#id163" title="Permalink to this headline">¶</a></h4>
<p>To create an application database</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mysql_database</span> <span class="s2">&quot;create my_app database&quot;</span> <span class="k">do</span>
  <span class="n">host</span> <span class="s2">&quot;localhost&quot;</span>
  <span class="n">username</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">password</span> <span class="s2">&quot;SuperSecret&quot;</span>
  <span class="n">database</span> <span class="s2">&quot;my_app_production&quot;</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:create_db</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To flush tables with read lock</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mysql_database</span> <span class="s2">&quot;locking tables for ebs snapshot&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:flush_tables_with_read_lock</span>
  <span class="n">host</span> <span class="s2">&quot;localhost&quot;</span>
  <span class="n">username</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">password</span> <span class="s2">&quot;SuperSecret&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To query a database</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mysql_database</span> <span class="s2">&quot;flush the privileges&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:query</span>
  <span class="n">host</span> <span class="s2">&quot;localhost&quot;</span>
  <span class="n">username</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">password</span> <span class="s2">&quot;SuperSecret&quot;</span>
  <span class="n">sql</span> <span class="s2">&quot;flush privileges&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To unlock tables</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">mysql_database</span> <span class="s2">&quot;unlocking tables after ebs snapshot&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:unflush_tables</span>
  <span class="n">host</span> <span class="s2">&quot;localhost&quot;</span>
  <span class="n">username</span> <span class="s2">&quot;root&quot;</span>
  <span class="n">password</span> <span class="s2">&quot;SuperSecret&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pacman-aur">
<h3>pacman_aur<a class="headerlink" href="#pacman-aur" title="Permalink to this headline">¶</a></h3>
<p>The pacman_aur lightweight resource is used to use the Arch Linux package manager (pacman). A custom package description file (<tt class="docutils literal"><span class="pre">PKGBUILD</span></tt>) can be used when creating packages.</p>
<p>For more information, see: <a class="reference external" href="https://wiki.archlinux.org/index.php/PKGBUILD">https://wiki.archlinux.org/index.php/PKGBUILD</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">pacman</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/pacman">http://community.opscode.com/cookbooks/pacman</a>).</p>
</div>
<div class="section" id="id164">
<h4>Actions<a class="headerlink" href="#id164" title="Permalink to this headline">¶</a></h4>
<p>The pacman_aur lightweight resource is used to use the Arch Linux package manager (pacman). A custom package description file (<tt class="docutils literal"><span class="pre">PKGBUILD</span></tt>) can be used when creating packages.</p>
<p>For more information, see: <a class="reference external" href="https://wiki.archlinux.org/index.php/PKGBUILD">https://wiki.archlinux.org/index.php/PKGBUILD</a>.</p>
</div>
<div class="section" id="id165">
<h4>Attributes<a class="headerlink" href="#id165" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:build</span></tt></td>
<td>Use to build a package using the information stored in a PKGBUILD script.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Use to install a package that has been built with the <tt class="docutils literal"><span class="pre">:build</span></tt> action.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id166">
<h4>Examples<a class="headerlink" href="#id166" title="Permalink to this headline">¶</a></h4>
<p>To use a simple AUR package</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">pacman_aur</span> <span class="s2">&quot;djbdns&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:build</span><span class="p">,</span> <span class="ss">:install</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use a custom package with PKGBUILD</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">pacman_aur</span> <span class="s2">&quot;netatalk&quot;</span> <span class="k">do</span>
  <span class="n">pkgbuild_src</span> <span class="s2">&quot;PKGBUILD&quot;</span>
  <span class="n">action</span> <span class="o">[</span><span class="ss">:build</span><span class="p">,</span><span class="ss">:install</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pacman-group">
<h3>pacman_group<a class="headerlink" href="#pacman-group" title="Permalink to this headline">¶</a></h3>
<p>The pacman_group lightweight resource is used to manage a pacman package group.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">pacman</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/pacman">http://community.opscode.com/cookbooks/pacman</a>).</p>
</div>
<div class="section" id="id167">
<h4>Actions<a class="headerlink" href="#id167" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Use to install a group.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a group.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id168">
<h4>Attributes<a class="headerlink" href="#id168" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">package_name</span></tt></td>
<td>The name of the package group.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>The name of the package group.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id169">
<h4>Examples<a class="headerlink" href="#id169" title="Permalink to this headline">¶</a></h4>
<p>To xxxxx:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">pacman_group</span> <span class="s2">&quot;base-devel&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="php-pear">
<h3>php_pear<a class="headerlink" href="#php-pear" title="Permalink to this headline">¶</a></h3>
<p>The php_pear lightweight resource is used to to integrate reusable PHP components into recipes. PEAR is a framework and distribution system for reusable PHP components. PECL is a repository for PHP Extensions. PECL contains C extensions for compiling into PHP. As C programs, PECL extensions run more efficiently than PEAR packages. Both PEAR and PECL use the same packaging and distribution system. As such this lightweight resource is clever enough to abstract away the small differences and can be used for managing both PEAR and PECL. This lightweight resource also creates the proper module .ini file for each PECL extension at the correct location for each supported platform.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">php</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/php">http://community.opscode.com/cookbooks/php</a>).</p>
</div>
<div class="section" id="id170">
<h4>Actions<a class="headerlink" href="#id170" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Use to install a PEAR package. If a version is provided, use to install that version.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:upgrade</span></tt></td>
<td>Use to upgrade a PEAR package. If a version is provided, use to upgrade to that version.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a PEAR package.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:purge</span></tt></td>
<td>Use to purge a PEAR package. This is identical in behavior to the <tt class="docutils literal"><span class="pre">:remove</span></tt> action.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id171">
<h4>Attributes<a class="headerlink" href="#id171" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">package_name</span></tt></td>
<td>The name of the PEAR package to install.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">version</span></tt></td>
<td>The version of the package to install or upgrade. If a version is not specified, the latest version is assumed.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">preferred_state</span></tt></td>
<td>By default, PEAR only installs stable packages. Packages can be installed in various non-stable states: <tt class="docutils literal"><span class="pre">devel</span></tt>, <tt class="docutils literal"><span class="pre">alpha</span></tt> or <tt class="docutils literal"><span class="pre">beta</span></tt>. Default value: <tt class="docutils literal"><span class="pre">stable</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">directives</span></tt></td>
<td>Extra extension directives (or settings) for a PECL. On most platforms, these directives are rendered into the extension&#8217;s .ini file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>Additional options that are added to the underlying PEAR package command.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id172">
<h4>Examples<a class="headerlink" href="#id172" title="Permalink to this headline">¶</a></h4>
<p>To install apc pecl with directives</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">php_pear</span> <span class="s2">&quot;apc&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">directives</span><span class="p">(</span><span class="ss">:shm_size</span> <span class="o">=&gt;</span> <span class="mi">128</span><span class="p">,</span> <span class="ss">:enable_cli</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install the beta version of Horde_Url from the Horde channel</p>
<div class="highlight-ruby"><div class="highlight"><pre> <span class="n">hc</span> <span class="o">=</span> <span class="n">php_pear_channel</span> <span class="s2">&quot;pear.horde.org&quot;</span> <span class="k">do</span>
   <span class="n">action</span> <span class="ss">:discover</span>
 <span class="k">end</span>
 <span class="n">php_pear</span> <span class="s2">&quot;Horde_Url&quot;</span> <span class="k">do</span>
   <span class="n">preferred_state</span> <span class="s2">&quot;beta&quot;</span>
   <span class="n">channel</span> <span class="n">hc</span><span class="o">.</span><span class="n">channel_name</span>
   <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install the mongodb pecl</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">php_pear</span> <span class="s2">&quot;mongo&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a specific version</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">php_pear</span> <span class="s2">&quot;XML_RPC&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="s2">&quot;1.5.4&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install the YAML pear from the symfony project</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">sc</span> <span class="o">=</span> <span class="n">php_pear_channel</span> <span class="s2">&quot;pear.symfony-project.com&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:discover</span>
<span class="k">end</span>
<span class="n">php_pear</span> <span class="s2">&quot;YAML&quot;</span> <span class="k">do</span>
  <span class="n">channel</span> <span class="n">sc</span><span class="o">.</span><span class="n">channel_name</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To upgrade a pear</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">php_pear</span> <span class="s2">&quot;XML_RPC&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:upgrade</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="php-pear-channel">
<h3>php_pear_channel<a class="headerlink" href="#php-pear-channel" title="Permalink to this headline">¶</a></h3>
<p>The php_pear_channel lightweight resource is used to use PEAR Channels as an alternate source for PEAR packages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">php</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/php">http://community.opscode.com/cookbooks/php</a>).</p>
</div>
<div class="section" id="id173">
<h4>Actions<a class="headerlink" href="#id173" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:discover</span></tt></td>
<td>Use to initialize a channel from its server.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:add</span></tt></td>
<td>Use to add a channel to the channel list. Typically, this is used only for private channels. Public channels should be added using the <tt class="docutils literal"><span class="pre">:discover</span></tt> action.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:update</span></tt></td>
<td>Use to update an existing channel.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a channel from the channel list.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id174">
<h4>Attributes<a class="headerlink" href="#id174" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">channel_name</span></tt></td>
<td>The name of a channel that a PEAR installation needs to know about (i.e. &#8220;channel discovery&#8221;).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">channel_xml</span></tt></td>
<td>The channel definition file for a channel.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id175">
<h4>Examples<a class="headerlink" href="#id175" title="Permalink to this headline">¶</a></h4>
<p>To discover the horde channel</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">php_pear_channel</span> <span class="s2">&quot;pear.horde.org&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:discover</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To download xml then add the symfony channel</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">remote_file</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span><span class="si">}</span><span class="s2">/symfony-channel.xml&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://pear.symfony-project.com/channel.xml&quot;</span>
  <span class="n">mode</span> <span class="mo">0644</span>
<span class="k">end</span>

<span class="n">php_pear_channel</span> <span class="s2">&quot;symfony&quot;</span> <span class="k">do</span>
  <span class="n">channel_xml</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span><span class="si">}</span><span class="s2">/symfony-channel.xml&quot;</span>
  <span class="n">action</span> <span class="ss">:add</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To update the main channels</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">php_pear_channel</span> <span class="s1">&#39;pear.php.net&#39;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:update</span>
<span class="k">end</span>
</pre></div>
</div>
<p>^^%%&amp;&amp;abovebelowabovebelow</p>
<p>To update the main channels</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">php_pear_channel</span> <span class="s1">&#39;pecl.php.net&#39;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:update</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="python-pip">
<h3>python_pip<a class="headerlink" href="#python-pip" title="Permalink to this headline">¶</a></h3>
<p>The python_pip lightweight resource is used to install packages using pip. The usage is similar to any normal package provider. python_pip is dependent on the <tt class="docutils literal"><span class="pre">python</span></tt> cookbook and must be included in a cookbook&#8217;s metadata file for it to be used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">python</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/python">http://community.opscode.com/cookbooks/python</a>).</p>
</div>
<div class="section" id="id176">
<h4>Actions<a class="headerlink" href="#id176" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Use to install a pip package. If a version is provided, use to install that version.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:upgrade</span></tt></td>
<td>Use to upgrade a pip package. If a version is provided, use to upgrade to that version.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a pip package.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:purge</span></tt></td>
<td>Use to purge a pip package. This is identical in behavior to the <tt class="docutils literal"><span class="pre">:remove</span></tt> action.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id177">
<h4>Attributes<a class="headerlink" href="#id177" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">package_name</span></tt></td>
<td>The name of pip package to instal.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">version</span></tt></td>
<td>The version of the pip package to install or upgrade. If a version is not specified, the latest version is assumed.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">virtualenv</span></tt></td>
<td>The virtual Python environment into which the pip package is installed.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>Additional options to the underlying pip package command.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id178">
<h4>Examples<a class="headerlink" href="#id178" title="Permalink to this headline">¶</a></h4>
<p>To install latest gunicorn into system path</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">python_pip</span> <span class="s2">&quot;gunicorn&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install a specific pip version</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">python_pip</span> <span class="s2">&quot;django&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="s2">&quot;1.1.4&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To target a virtualenv</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">python_pip</span> <span class="s2">&quot;gunicorn&quot;</span> <span class="k">do</span>
  <span class="n">virtualenv</span> <span class="s2">&quot;/home/ubunut/virtualenvs/myapp&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use this provider with the core package resource</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;django&quot;</span> <span class="k">do</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">PythonPip</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="python-virtualenv">
<h3>python_virtualenv<a class="headerlink" href="#python-virtualenv" title="Permalink to this headline">¶</a></h3>
<p>The python_virtualenv lightweight resource is used to create virtual Python environments.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">python</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/python">http://community.opscode.com/cookbooks/python</a>).</p>
</div>
<div class="section" id="id179">
<h4>Actions<a class="headerlink" href="#id179" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Use to create a virtual Python environment.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to delete a virtual Python environment.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id180">
<h4>Attributes<a class="headerlink" href="#id180" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to the location in which the virtual Python environment will be created. Default value: <tt class="docutils literal"><span class="pre">\</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">interpreter</span></tt></td>
<td>The Python interpreter to use. Default value: <tt class="docutils literal"><span class="pre">python2.6</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of the virtual Python environment.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>The string or ID that identifies the group owner of a file <strong>jamescott: THE group owner of the virtual |python| environment?</strong>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id181">
<h4>Examples<a class="headerlink" href="#id181" title="Permalink to this headline">¶</a></h4>
<p>To create a virtual Python 2.4 environment:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">python_virtualenv</span> <span class="s2">&quot;/home/ubuntu/virtualenvs/myapp&quot;</span> <span class="k">do</span>
  <span class="n">interpreter</span> <span class="s2">&quot;python2.4&quot;</span>
  <span class="n">owner</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">group</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To create a virtual Python 2.6 environment that is owned by an Ubuntu user:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">python_virtualenv</span> <span class="s2">&quot;/home/ubunut/virtualenvs/myapp&quot;</span> <span class="k">do</span>
  <span class="n">owner</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">group</span> <span class="s2">&quot;ubuntu&quot;</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="riak-cluster">
<h3>riak_cluster<a class="headerlink" href="#riak-cluster" title="Permalink to this headline">¶</a></h3>
<p>The riak_cluster lightweight resource is used to join a Riak node to a cluster. Other cluster members will be automatically discovered by searching on the <tt class="docutils literal"><span class="pre">riak.core.cluster_name</span></tt> attribute. This lightweight resource is used in the <tt class="docutils literal"><span class="pre">riak::autoconf</span></tt> recipe.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">riak</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/riak">http://community.opscode.com/cookbooks/riak</a>).</p>
</div>
<div class="section" id="id182">
<h4>Actions<a class="headerlink" href="#id182" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:join</span></tt></td>
<td>Use to join a local node to a cluster.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:wait_for_ringready</span></tt></td>
<td>Use to wait for cluster membership to converge (&#8220;all nodes in the cluster agree on the ring state&#8221;) before joining a local node to a cluster.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id183">
<h4>Attributes<a class="headerlink" href="#id183" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">cluster_name</span></tt></td>
<td>The name of the cluster.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">cluster_members</span></tt></td>
<td>A list of nodes that should be part of the cluster. Default value: discovered by Chef search functionality.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node_name</span></tt></td>
<td>The name of the local node (as identified by the <tt class="docutils literal"><span class="pre">riak.erlang.node_name</span></tt> attribute).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">timeout</span></tt></td>
<td>The amount of time (in seconds) to wait for ring convergence. Default value: <tt class="docutils literal"><span class="pre">30</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">riak_admin_path</span></tt></td>
<td>The location in which <tt class="docutils literal"><span class="pre">riak</span></tt> and <tt class="docutils literal"><span class="pre">riak-admin</span></tt> scripts are located. Default value: <tt class="docutils literal"><span class="pre">/usr/sbin</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id184">
<h4>Examples<a class="headerlink" href="#id184" title="Permalink to this headline">¶</a></h4>
<p>To add a node to a Riak cluster:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">riak_cluster</span> <span class="n">node</span><span class="o">[</span><span class="ss">:riak</span><span class="o">][</span><span class="ss">:core</span><span class="o">][</span><span class="ss">:cluster_name</span><span class="o">]</span> <span class="k">do</span>
  <span class="n">node_name</span> <span class="n">node</span><span class="o">[</span><span class="ss">:riak</span><span class="o">][</span><span class="ss">:erlang</span><span class="o">][</span><span class="ss">:node_name</span><span class="o">]</span>
  <span class="n">action</span> <span class="ss">:join</span>
  <span class="n">riak_admin_path</span> <span class="n">bin_path</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="samba-user">
<h3>samba_user<a class="headerlink" href="#samba-user" title="Permalink to this headline">¶</a></h3>
<p>The samba_user lightweight resource is used to manage password entries for Samba.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">samba</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/samba">http://community.opscode.com/cookbooks/samba</a>).</p>
</div>
<div class="section" id="id185">
<h4>Actions<a class="headerlink" href="#id185" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Use to create a user.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:enable</span></tt></td>
<td>Use to delete a user.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:delete</span></tt></td>
<td>Use to enable a user.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id186">
<h4>Attributes<a class="headerlink" href="#id186" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">password</span></tt></td>
<td>The password for a user. This is passed to the <tt class="docutils literal"><span class="pre">smbpasswd</span></tt> program in Samba.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id187">
<h4>Examples<a class="headerlink" href="#id187" title="Permalink to this headline">¶</a></h4>
<p>To create a user:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">samba_user</span> <span class="s2">&quot;jtimberman&quot;</span> <span class="k">do</span>
  <span class="n">password</span> <span class="s2">&quot;SuperSecret&quot;</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="transmission-torrent-file">
<h3>transmission_torrent_file<a class="headerlink" href="#transmission-torrent-file" title="Permalink to this headline">¶</a></h3>
<p>The transmission_torrent_file lightweight resource is used to download a file using the BitTorrent protocol. This lightweight resource is similar to the <tt class="docutils literal"><span class="pre">file</span></tt> and <tt class="docutils literal"><span class="pre">remote_file</span></tt> lightweight resources, but allows very fast downloads for files that are part of large BitTorrent swarms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">transmission</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/transmission">http://community.opscode.com/cookbooks/transmission</a>).</p>
</div>
<div class="section" id="id188">
<h4>Actions<a class="headerlink" href="#id188" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Use to download a file using the BitTorrent protocol.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id189">
<h4>Attributes<a class="headerlink" href="#id189" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path</span></tt></td>
<td>The path to a file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">torrent</span></tt></td>
<td>A URI or a local path that specifies a file in a BitTorrent swarm that will be joined.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">blocking</span></tt></td>
<td>Indicates whether a file should be downloaded in a single Chef run. If <tt class="docutils literal"><span class="pre">false</span></tt>, the download may take place across one (or more) Chef runs.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">continue_seeding</span></tt></td>
<td>Indicates whether a file should continue to be seeded to the BitTorrent swarm after download.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">owner</span></tt></td>
<td>The owner of a file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">group</span></tt></td>
<td>A string or ID that identifies the group owner of a file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rpc_host</span></tt></td>
<td>The address for the host to which a BitTorrent transmission connection is made. Default value: <tt class="docutils literal"><span class="pre">localhost</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rpc_port</span></tt></td>
<td>The port for the host to which a BitTorrent transmission connection is made. Default value: <tt class="docutils literal"><span class="pre">9091</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rpc_username</span></tt></td>
<td>The user name for the BitTorrent transmission account. Default value: <tt class="docutils literal"><span class="pre">transmission</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rpc_password</span></tt></td>
<td>The password for the BitTorrent transmission account. This is often <tt class="docutils literal"><span class="pre">node['transmission']['rpc_password']</span></tt>, which by default is a secure password generated for the node.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id190">
<h4>Examples<a class="headerlink" href="#id190" title="Permalink to this headline">¶</a></h4>
<p>To download an .iso:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">transmission_torrent_file</span> <span class="s2">&quot;/home/ubuntu/ubuntu.iso&quot;</span>  <span class="k">do</span>
  <span class="n">torrent</span> <span class="s2">&quot;http://releases.ubuntu.com/lucid/ubuntu-10.04.1-server-i386.iso.torrent&quot;</span>
  <span class="n">owner</span> <span class="s1">&#39;ubuntu&#39;</span>
  <span class="n">group</span> <span class="s1">&#39;ubuntu&#39;</span>
  <span class="n">rpc_username</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;transmission&#39;</span><span class="o">][</span><span class="s1">&#39;rpc_username&#39;</span><span class="o">]</span>
  <span class="n">rpc_password</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;transmission&#39;</span><span class="o">][</span><span class="s1">&#39;rpc_password&#39;</span><span class="o">]</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To download an .iso and then continue seeding:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">transmission_torrent_file</span> <span class="s2">&quot;/home/ubuntu/ubuntu.iso&quot;</span>  <span class="k">do</span>
  <span class="n">torrent</span> <span class="s2">&quot;http://releases.ubuntu.com/lucid/ubuntu-10.04.1-server-i386.iso.torrent&quot;</span>
  <span class="n">owner</span> <span class="s1">&#39;ubuntu&#39;</span>
  <span class="n">group</span> <span class="s1">&#39;ubuntu&#39;</span>
  <span class="n">continue_seeding</span> <span class="kp">true</span>
  <span class="n">rpc_username</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;transmission&#39;</span><span class="o">][</span><span class="s1">&#39;rpc_username&#39;</span><span class="o">]</span>
  <span class="n">rpc_password</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;transmission&#39;</span><span class="o">][</span><span class="s1">&#39;rpc_password&#39;</span><span class="o">]</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="windows-package">
<h3>windows_package<a class="headerlink" href="#windows-package" title="Permalink to this headline">¶</a></h3>
<p>The windows_package lightweight resource is used to manage Microsoft Windows application packages in an unattended, idempotent manner. The following application installers are currently supported: Microsoft Installer Package (MSI), InstallShield, Wise installers, Inno Setup, and Nullsoft Scriptable Install System (NSIS).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">windows</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/windows">http://community.opscode.com/cookbooks/windows</a>).</p>
</div>
<div class="section" id="id191">
<h4>Actions<a class="headerlink" href="#id191" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Use to install a package.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a package.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id192">
<h4>Attributes<a class="headerlink" href="#id192" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">package_name</span></tt></td>
<td>The display name of the application installation package. This is the same as the <tt class="docutils literal"><span class="pre">DisplayName</span></tt> registry value in the uninstallation data that is created during package installation. The easiest way to find the proper <tt class="docutils literal"><span class="pre">DisplayName</span></tt> value is to install a package on a machine and search for the uninstall information under one of the following registry keys: <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall</span></tt>, <tt class="docutils literal"><span class="pre">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Uninstall</span></tt>, or <tt class="docutils literal"><span class="pre">HKEY_LOCAL_MACHINE\Software\Wow6464Node\Microsoft\Windows\CurrentVersion\Uninstall</span></tt>. This value may also be identified by the uninstaller itself (in the <tt class="docutils literal"><span class="pre">Name</span></tt> column) and can be viewed while running the uninstaller.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>A URI or a local path that specifies the source of a Microsoft Windows installer.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">installer_type</span></tt></td>
<td>The type of windows installation package: <tt class="docutils literal"><span class="pre">:msi</span></tt>, <tt class="docutils literal"><span class="pre">:inno</span></tt>, <tt class="docutils literal"><span class="pre">:nsis</span></tt>, <tt class="docutils literal"><span class="pre">:wise</span></tt>, <tt class="docutils literal"><span class="pre">:installshield</span></tt>, or <tt class="docutils literal"><span class="pre">:custom</span></tt>. If this value is not specified, the provider will attempt to identify the installer type on its own and will use the best match. If this value cannot be properly specified, use the <tt class="docutils literal"><span class="pre">:custom</span></tt> value to pass a value to the <tt class="docutils literal"><span class="pre">installer_type</span></tt> attribute and then the <tt class="docutils literal"><span class="pre">options</span></tt> attribute to set the proper flags for a silent or quite installation.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>Additional options that are passed to the installation command.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id193">
<h4>Examples<a class="headerlink" href="#id193" title="Permalink to this headline">¶</a></h4>
<p>To install PuTTY:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;PuTTY version 0.60&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://the.earth.li/~sgtatham/putty/latest/x86/putty-0.60-installer.exe&quot;</span>
  <span class="n">installer_type</span> <span class="ss">:inno</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install 7-Zip:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;7-Zip 9.20 (x64 edition)&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://downloads.sourceforge.net/sevenzip/7z920-x64.msi&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To remove 7-Zip:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;7-Zip 9.20 (x64 edition)&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:remove</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install Notepad++ using a local installer:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;Notepad++&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;c:/installation_files/npp.5.9.2.Installer.exe&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install Firefox as custom installer and manually set the silent install flags:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;Mozilla Firefox 5.0 (x86 en-US)&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://3347-mozilla.voxcdn.com/pub/mozilla.org/firefox/releases/5.0/win32/en-US/Firefox%20Setup%205.0.exe&quot;</span>
  <span class="n">options</span> <span class="s2">&quot;-ms&quot;</span>
  <span class="n">installer_type</span> <span class="ss">:custom</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To install the VLC media player:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;VLC media player 1.1.10&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://superb-sea2.dl.sourceforge.net/project/vlc/1.1.10/win32/vlc-1.1.10-win32.exe&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To use the Google Chrome:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;Google Chrome&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;https://dl-ssl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7B806F36C0-</span>
<span class="s2">             CB54-4A84-A3F30CF8A86575E0%7D%26lang%3Den%26browser%3D3%26usagestats%3D0%26appname%3D</span>
<span class="s2">             Google%2520Chrome%26needsadmin%3Dfalse/edgedl/chrome/install/GoogleChromeStandaloneEnterprise.msi&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To remove Google Chrome:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_package</span> <span class="s2">&quot;Google Chrome&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:remove</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="windows-registry">
<h3>windows_registry<a class="headerlink" href="#windows-registry" title="Permalink to this headline">¶</a></h3>
<p>The windows_registry lightweight resource is used to create and modify registry keys in Microsoft Windows.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">windows</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/windows">http://community.opscode.com/cookbooks/windows</a>).</p>
</div>
<div class="section" id="id194">
<h4>Actions<a class="headerlink" href="#id194" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:create</span></tt></td>
<td>Use to create a registry key with the provided values.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:modify</span></tt></td>
<td>Use to modify an existing registry key with the provided values.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id195">
<h4>Attributes<a class="headerlink" href="#id195" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">key_name</span></tt></td>
<td>The registry key to create or modify.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">values</span></tt></td>
<td>A hash of values to be set under a registry key. The individual hash items will become  <tt class="docutils literal"><span class="pre">value_name</span> <span class="pre">=&gt;</span> <span class="pre">value_data</span></tt> items in the registry key.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id196">
<h4>Examples<a class="headerlink" href="#id196" title="Permalink to this headline">¶</a></h4>
<p>To enable Windows Remote Desktop and poke the firewall hole</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_registry</span> <span class="s1">&#39;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&#39;</span> <span class="k">do</span>
 <span class="n">values</span> <span class="s1">&#39;FdenyTSConnections&#39;</span> <span class="o">=&gt;</span> <span class="mi">0</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To make the local Microsoft Windows proxy match the proxy set for Chef:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">proxy</span> <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:http_proxy</span><span class="o">]</span><span class="p">)</span>
<span class="n">windows_registry</span> <span class="s1">&#39;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&#39;</span> <span class="k">do</span>
  <span class="n">values</span> <span class="s1">&#39;ProxyEnable&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ProxyServer&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">proxy</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">proxy</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;ProxyOverride&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&lt;local&gt;&#39;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="windows-zipfile">
<h3>windows_zipfile<a class="headerlink" href="#windows-zipfile" title="Permalink to this headline">¶</a></h3>
<p>Most versions of Microsoft Windows do not provide a native command-line utility that can be used to manage compressed files. The windows_zipfile lightweight resource is a Ruby implementation that allows Zip files to be managed in Microsoft Windows. Use the <tt class="docutils literal"><span class="pre">not_if</span></tt> and <tt class="docutils literal"><span class="pre">only_if</span></tt> meta parameters as attributes to guard the use of this resource for idempotence. If these parameters are not used, actions could be taken against every Zip file during every Chef run.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lightweight resource is part of the <tt class="docutils literal"><span class="pre">windows</span></tt> cookbook (<a class="reference external" href="http://community.opscode.com/cookbooks/windows">http://community.opscode.com/cookbooks/windows</a>).</p>
</div>
<div class="section" id="id197">
<h4>Actions<a class="headerlink" href="#id197" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:unzip</span></tt></td>
<td>Use to unzip a compressed file.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id198">
<h4>Attributes<a class="headerlink" href="#id198" title="Permalink to this headline">¶</a></h4>
<p>This lightweight resource provider has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">path_to_location</span></tt></td>
<td>The path to the location in which a file will be unzipped.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>A URI or a local path that specifies the source of a Zip file.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">overwrite</span></tt></td>
<td>Indicates that when a file exists, it will be overwritten. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id199">
<h4>Examples<a class="headerlink" href="#id199" title="Permalink to this headline">¶</a></h4>
<p>To unzip a remote Zip file locally:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_zipfile</span> <span class="s2">&quot;c:/bin&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;http://download.sysinternals.com/Files/SysinternalsSuite.zip&quot;</span>
  <span class="n">action</span> <span class="ss">:unzip</span>
  <span class="n">not_if</span> <span class="p">{</span><span class="o">::</span><span class="no">File</span><span class="o">.</span><span class="n">exists?</span><span class="p">(</span><span class="s2">&quot;c:/bin/PsExec.exe&quot;</span><span class="p">)}</span>
<span class="k">end</span>
</pre></div>
</div>
<p>To unzip a local Zip file:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">windows_zipfile</span> <span class="s2">&quot;c:/the_codez&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;c:/foo/baz/the_codez.zip&quot;</span>
  <span class="n">action</span> <span class="ss">:unzip</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">Resources and Providers Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Opscode, Inc..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>