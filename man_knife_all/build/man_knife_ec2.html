

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ec2 (plug-in) &mdash; Opscode: Knife Reference</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Opscode: Knife Reference" href="index.html" />
    <link rel="next" title="environment" href="man_knife_environment.html" />
    <link rel="prev" title="data bag" href="man_knife_data_bag.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="man_knife_environment.html" title="environment"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="man_knife_data_bag.html" title="data bag"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Opscode: Knife Reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/opscode_html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ec2 (plug-in)</a><ul>
<li><a class="reference internal" href="#instance-data">instance data</a></li>
<li><a class="reference internal" href="#server-create">server create</a></li>
<li><a class="reference internal" href="#server-delete">server delete</a></li>
<li><a class="reference internal" href="#server-list">server list</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="man_knife_data_bag.html"
                        title="previous chapter">data bag</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="man_knife_environment.html"
                        title="next chapter">environment</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/man_knife_ec2.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ec2-plug-in">
<h1>ec2 (plug-in)<a class="headerlink" href="#ec2-plug-in" title="Permalink to this headline">¶</a></h1>
<p>Amazon EC2 is a web service that provides resizable compute capacity in the cloud based and pre-configured operating system and virtual application software using Amazon Machine Images (AMI). The <tt class="docutils literal"><span class="pre">ec2</span></tt> sub-command is used to manage API-driven cloud servers that are hosted by Amazon EC2.</p>
<p>This plugin is available on github: <a class="reference external" href="https://github.com/opscode/knife-ec2">https://github.com/opscode/knife-ec2</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This plugin requires the <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">windows</span></tt> plugin to be present on the same machine: <a class="reference external" href="https://github.com/opscode/knife-windows">https://github.com/opscode/knife-windows</a>.</p>
</div>
<p>This sub-command has the following syntax:</p>
<div class="highlight-python"><pre>knife ec2 [ARGUMENT] (options)</pre>
</div>
<div class="section" id="instance-data">
<h2>instance data<a class="headerlink" href="#instance-data" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">instance</span> <span class="pre">data</span></tt> argument is used to generate instance metadata used with custom Opscode Amazon Machine Images (AMI). This process will read the validation certificate and Chef server URL from the Knife configuration file (~/.chef/knife.rb) and will output the data in JSON format.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Using this sub-command is an older way of launching Amazon EC2 instances for Chef and should be considered deprecated. Using the <tt class="docutils literal"><span class="pre">server</span> <span class="pre">create</span></tt> sub-command is preferred (and more flexible). Although this sub-command will remain, the Opscode custom Amazon Machine Images (AMI) are out of date.</p>
</div>
<p>This argument has the following syntax:</p>
<div class="highlight-python"><pre>knife ec2 instance data (options)</pre>
</div>
<p>This argument has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-A</span> <span class="pre">KEY</span></tt>, <tt class="docutils literal"><span class="pre">--aws-access-key-id</span> <span class="pre">KEY</span></tt></dt>
<dd>The access key identifier used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-e</span></tt>, <tt class="docutils literal"><span class="pre">--edit</span></tt></dt>
<dd>Indicates that instance data should be edited. <strong>jamescott: EDITED WHERE?</strong></dd>
<dt><tt class="docutils literal"><span class="pre">-K</span> <span class="pre">SECRET</span></tt>, <tt class="docutils literal"><span class="pre">--aws-secret-access-key</span> <span class="pre">SECRET</span></tt></dt>
<dd>The secret access key for the API endpoint used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-r</span> <span class="pre">RUN_LIST</span></tt>, <tt class="docutils literal"><span class="pre">--run-list</span> <span class="pre">RUN_LIST</span></tt></dt>
<dd>A comma-separated list of roles and/or recipes to be applied.</dd>
<dt><tt class="docutils literal"><span class="pre">--region</span> <span class="pre">REGION</span></tt></dt>
<dd>The name of the region from which instances of hosted applications are launched. Each region has a unique endpoint.</dd>
</dl>
</div>
<div class="section" id="server-create">
<h2>server create<a class="headerlink" href="#server-create" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">server</span> <span class="pre">create</span></tt> argument is used to create a new Amazon EC2 cloud instance. This will provision a new image in Amazon EC2, perform a Chef bootstrap (using the SSH protocol), and then install Chef on the target system so that it can be run as a chef-client and communicate with a Chef server.</p>
<p>This argument has the following syntax:</p>
<div class="highlight-python"><pre>knife ec2 server create (options)</pre>
</div>
<p>This argument has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-A</span> <span class="pre">KEY</span></tt>, <tt class="docutils literal"><span class="pre">--aws-access-key-id</span> <span class="pre">KEY</span></tt></dt>
<dd>The access key identifier used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-bootstrap-protocol</span> <span class="pre">PROTOCOL</span></tt></dt>
<dd>The protocol used to bootstrap on a machine that is running Windows Server: <tt class="docutils literal"><span class="pre">winrm</span></tt> or <tt class="docutils literal"><span class="pre">ssh</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">--bootstrap-version</span> <span class="pre">VERSION</span></tt></dt>
<dd>The version of Chef to install.</dd>
<dt><tt class="docutils literal"><span class="pre">-d</span> <span class="pre">DISTRO</span></tt>, <tt class="docutils literal"><span class="pre">--distro</span> <span class="pre">DISTRO</span></tt></dt>
<dd>Indicates that a bootstrap operation will use a template file. If this option is used the name of the template file (<tt class="docutils literal"><span class="pre">--template-file</span></tt>) must also be provided. The following distributions are supported: <tt class="docutils literal"><span class="pre">chef-full</span></tt> (the default bootstrap), <tt class="docutils literal"><span class="pre">centos5-gems</span></tt>, <tt class="docutils literal"><span class="pre">fedora13-gems</span></tt>, <tt class="docutils literal"><span class="pre">ubuntu10.04-gems</span></tt>, <tt class="docutils literal"><span class="pre">ubuntu10.04-apt</span></tt>, and <tt class="docutils literal"><span class="pre">ubuntu12.04-gems</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">--ebs-size</span> <span class="pre">SIZE</span></tt></dt>
<dd>The size of the Amazon Elastic Block Store volume, in GB. This option is only available for instances that are backed with Amazon Elastic Block Store.</dd>
<dt><tt class="docutils literal"><span class="pre">--ebs-no-delete-on-term</span></tt></dt>
<dd>Indicates that the Amazon Elastic Block Store volume will not be deleted upon instance termination. This option is only available for instances that are backed with Amazon Elastic Block Store.</dd>
<dt><tt class="docutils literal"><span class="pre">-ephemeral</span> <span class="pre">DEVICE</span></tt></dt>
<dd>A comma-separated list of device locations to be mapped to ephemeral devices.</dd>
<dt><tt class="docutils literal"><span class="pre">-f</span> <span class="pre">FLAVOR</span></tt>, <tt class="docutils literal"><span class="pre">--flavor</span> <span class="pre">FLAVOR</span></tt></dt>
<dd>The name of the flavor that identifies the hardware configuration of the server, including disk space, memory capacity, and CPU priority.</dd>
<dt><tt class="docutils literal"><span class="pre">-fqdn</span> <span class="pre">FQDN</span></tt></dt>
<dd>A pre-defined fully qualified domain name.</dd>
<dt><tt class="docutils literal"><span class="pre">-g</span> <span class="pre">X,Y,Z</span></tt>, <tt class="docutils literal"><span class="pre">--security-group-ids</span> <span class="pre">X,Y,Z</span></tt></dt>
<dd>A comma-separated list of security group identifiers. Required when using Amazon Virtual Private Cloud.</dd>
<dt><tt class="docutils literal"><span class="pre">-G</span> <span class="pre">X,Y,Z</span></tt>, <tt class="docutils literal"><span class="pre">--groups</span> <span class="pre">X,Y,Z</span></tt></dt>
<dd>A comma-separated list of security groups. Not supported when using Amazon Virtual Private Cloud.</dd>
<dt><tt class="docutils literal"><span class="pre">-hint</span> <span class="pre">HINT_NAME[=HINT_FILE]</span></tt></dt>
<dd>Indicates that an Ohai hint will be set on the target of the bootstrap. Use multiple <tt class="docutils literal"><span class="pre">--hint</span></tt> options to specify multiple hints.</dd>
<dt><tt class="docutils literal"><span class="pre">-i</span> <span class="pre">IDENTITY_FILE</span></tt>, <tt class="docutils literal"><span class="pre">--identity-file</span> <span class="pre">IDENTITY_FILE</span></tt></dt>
<dd>The SSH identity file used for authentication. Key-based authentication is recommended.</dd>
<dt><tt class="docutils literal"><span class="pre">-I</span> <span class="pre">IMAGE</span></tt>, <tt class="docutils literal"><span class="pre">--image</span> <span class="pre">IMAGE</span></tt></dt>
<dd>The name of the image that identifies the operating system (and version) that will be used to create the virtual machine.</dd>
<dt><tt class="docutils literal"><span class="pre">-K</span> <span class="pre">SECRET</span></tt>, <tt class="docutils literal"><span class="pre">--aws-secret-access-key</span> <span class="pre">SECRET</span></tt></dt>
<dd>The secret access key for the API endpoint used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-N</span> <span class="pre">NAME</span></tt>, <tt class="docutils literal"><span class="pre">--node-name</span> <span class="pre">NAME</span></tt></dt>
<dd>The name of the node on the Chef server.</dd>
<dt><tt class="docutils literal"><span class="pre">--[no-]host-key-verify</span></tt></dt>
<dd>Use <tt class="docutils literal"><span class="pre">--no-host-key-verify</span></tt> to disable host key verification. Host key verification is enabled by default.</dd>
<dt><tt class="docutils literal"><span class="pre">-p</span> <span class="pre">PORT</span></tt>, <tt class="docutils literal"><span class="pre">--ssh-port</span> <span class="pre">PORT</span></tt></dt>
<dd>The SSH port.</dd>
<dt><tt class="docutils literal"><span class="pre">-P</span> <span class="pre">PASSWORD</span></tt>, <tt class="docutils literal"><span class="pre">--ssh-password</span> <span class="pre">PASSWORD</span></tt></dt>
<dd>The SSH password. This can be used to pass the password directly on the command line. If this option is not specified (and a password is required) Knife will prompt for the password.</dd>
<dt><tt class="docutils literal"><span class="pre">--prerelease</span></tt></dt>
<dd>Indicates that pre-release Chef gems should be installed.</dd>
<dt><tt class="docutils literal"><span class="pre">-r</span> <span class="pre">RUN_LIST</span></tt>, <tt class="docutils literal"><span class="pre">--run-list</span> <span class="pre">RUN_LIST</span></tt></dt>
<dd>A comma-separated list of roles and/or recipes to be applied.</dd>
<dt><tt class="docutils literal"><span class="pre">--region</span> <span class="pre">REGION</span></tt></dt>
<dd>The name of the region from which instances of hosted applications are launched. Each region has a unique endpoint.</dd>
<dt><tt class="docutils literal"><span class="pre">-s</span> <span class="pre">SUBNET-ID</span></tt>, <tt class="docutils literal"><span class="pre">--subnet</span> <span class="pre">SUBNET-ID</span></tt></dt>
<dd>The Amazon Virtual Private Cloud instance in which a node will be created.</dd>
<dt><tt class="docutils literal"><span class="pre">-S</span> <span class="pre">KEY</span></tt>, <tt class="docutils literal"><span class="pre">--ssh-key</span> <span class="pre">KEY</span></tt></dt>
<dd>The SSH key for the Amazon EC2 environment.</dd>
<dt><tt class="docutils literal"><span class="pre">-server-connect-attribute</span> <span class="pre">ATTRIBUTE</span></tt></dt>
<dd>The attribute that is used when opening the SSH connection. This should be an Amazon EC2 server attribute.</dd>
<dt><tt class="docutils literal"><span class="pre">--T</span> <span class="pre">Tag=Value[,Tag=Value]</span></tt>, <tt class="docutils literal"><span class="pre">--tags</span> <span class="pre">Tag=Value[,Tag=Value]</span></tt></dt>
<dd>The tags for this server.</dd>
<dt><tt class="docutils literal"><span class="pre">--template-file</span> <span class="pre">TEMPLATE</span></tt></dt>
<dd>The path to the template file that will be used during a bootstrap operation.</dd>
<dt><tt class="docutils literal"><span class="pre">-u</span> <span class="pre">USER_DATA_FILE</span></tt>, <tt class="docutils literal"><span class="pre">--user-data</span> <span class="pre">USER_DATA_FILE</span></tt></dt>
<dd>The Amazon EC2 user data file used during instance provisioning.</dd>
<dt><tt class="docutils literal"><span class="pre">-w</span> <span class="pre">GATEWAY</span></tt>, <tt class="docutils literal"><span class="pre">--ssh-gateway</span> <span class="pre">GATEWAY</span></tt></dt>
<dd>The SSH tunnel or gateway that is used to run a bootstrap action on a machine that is not accessible from the workstation.</dd>
<dt><tt class="docutils literal"><span class="pre">-x</span> <span class="pre">USERNAME</span></tt>, <tt class="docutils literal"><span class="pre">--ssh-user</span> <span class="pre">USERNAME</span></tt></dt>
<dd>The SSH user name.</dd>
<dt><tt class="docutils literal"><span class="pre">-Z</span> <span class="pre">ZONE&quot;</span></tt>, <tt class="docutils literal"><span class="pre">--availability-zone</span> <span class="pre">ZONE</span></tt></dt>
<dd>The name of the Amazon EC2 availability zone. Each availability zone is unique within a region. Default: <tt class="docutils literal"><span class="pre">us-east-1b</span></tt>.</dd>
</dl>
<p>For example, to launch a new Amazon EC2 instance with the &#8220;webserver&#8221; role, enter:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>knife ec2 server create -r <span class="s2">&quot;role[webserver]&quot;</span> -I ami-2d4aa444 --flavor m1.small -G www,default -x ubuntu -N server01
</pre></div>
</div>
<p>To launch a new Amazon EC2 instance with multiple roles, enter:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>knife ec2 server create -r <span class="s2">&quot;role[base],role[webserver]&quot;</span> -I ami-2d4aa444 -G www,default -x ubuntu --node-name server01
</pre></div>
</div>
</div>
<div class="section" id="server-delete">
<h2>server delete<a class="headerlink" href="#server-delete" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">server</span> <span class="pre">delete</span></tt> argument is used to delete one or more nodes that are running in the Amazon EC2 cloud. To find a specific cloud instance, use the <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">ec2</span> <span class="pre">server</span> <span class="pre">list</span></tt> argument. Use the <tt class="docutils literal"><span class="pre">--purge</span></tt> option to delete all associated node and client objects from the Chef server or use the <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">node</span> <span class="pre">delete</span></tt> and <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">client</span> <span class="pre">delete</span></tt> sub-commands to delete specific node and client objects.</p>
<p>This argument has the following syntax:</p>
<div class="highlight-python"><pre>knife ec2 server delete SERVER [NODE_NAME...] (options)</pre>
</div>
<p>This argument has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-A</span> <span class="pre">KEY</span></tt>, <tt class="docutils literal"><span class="pre">--aws-access-key-id</span> <span class="pre">KEY</span></tt></dt>
<dd>The access key identifier used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-K</span> <span class="pre">SECRET</span></tt>, <tt class="docutils literal"><span class="pre">--aws-secret-access-key</span> <span class="pre">SECRET</span></tt></dt>
<dd>The secret access key for the API endpoint used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-N</span> <span class="pre">NODE_NAME</span></tt>, <tt class="docutils literal"><span class="pre">--node-name</span> <span class="pre">NODE_NAME</span></tt></dt>
<dd>The name of the node and client to delete, if different from the server name. This must be used with the <tt class="docutils literal"><span class="pre">--purge</span></tt> option.</dd>
<dt><tt class="docutils literal"><span class="pre">-p</span></tt>, <tt class="docutils literal"><span class="pre">--purge</span></tt></dt>
<dd>Indicates that all corresponding nodes and clients on the Chef server will be destroyed, in addition to the Amazon EC2 node itself. This action (by itself) assumes that the node and client have the same name as the server; if they do not have the same names, then the <tt class="docutils literal"><span class="pre">--node-name</span></tt> option must be used to specify the name of the node.</dd>
<dt><tt class="docutils literal"><span class="pre">--region</span> <span class="pre">REGION</span></tt></dt>
<dd>The name of the region from which instances of hosted applications are launched. Each region has a unique endpoint.</dd>
</dl>
<p>For example, to delete a node called &#8220;preprod&#8221; in an instance named &#8220;operations&#8221;, enter:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>knife ec2 server delete operations preprod
</pre></div>
</div>
</div>
<div class="section" id="server-list">
<h2>server list<a class="headerlink" href="#server-list" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">server</span> <span class="pre">list</span></tt> argument is used to find instances that are associated with a Amazon EC2 account. The results may show instances that are not currently managed by the Chef server.</p>
<p>This argument has the following syntax:</p>
<div class="highlight-python"><pre>knife ec2 server list</pre>
</div>
<p>This argument has the following options:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-A</span> <span class="pre">KEY</span></tt>, <tt class="docutils literal"><span class="pre">--aws-access-key-id</span> <span class="pre">KEY</span></tt></dt>
<dd>The access key identifier used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-K</span> <span class="pre">SECRET</span></tt>, <tt class="docutils literal"><span class="pre">--aws-secret-access-key</span> <span class="pre">SECRET</span></tt></dt>
<dd>The secret access key for the API endpoint used with Amazon EC2.</dd>
<dt><tt class="docutils literal"><span class="pre">-n</span></tt>, <tt class="docutils literal"><span class="pre">--no-name</span></tt></dt>
<dd>Indicates that tag names will not be displayed in the output.</dd>
<dt><tt class="docutils literal"><span class="pre">--region</span> <span class="pre">REGION</span></tt></dt>
<dd>The name of the region from which instances of hosted applications are launched. Each region has a unique endpoint.</dd>
<dt><tt class="docutils literal"><span class="pre">-t</span> <span class="pre">TAG1,</span> <span class="pre">TAG2</span></tt>, <tt class="docutils literal"><span class="pre">--tags</span> <span class="pre">TAG1,</span> <span class="pre">TAG2</span></tt></dt>
<dd>A list of tags that will be displayed in the output.</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="man_knife_environment.html" title="environment"
             >next</a></li>
        <li class="right" >
          <a href="man_knife_data_bag.html" title="data bag"
             >previous</a> |</li>
        <li><a href="index.html">Opscode: Knife Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Opscode, Inc.
    </div>
  </body>
</html>